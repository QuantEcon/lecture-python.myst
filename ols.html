
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>57. Linear Regression in Python &#8212; Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script>
        MathJax = {
          loader: {load: ['[tex]/boldsymbol']},
          tex: {
            packages: {'[+]': ['boldsymbol']},
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            processEscapes: true,
            macros: {
                "argmax" : "arg\\,max",
                "argmin" : "arg\\,min"
            }
          },
          svg: {
            fontCache: 'global',
            scale: 0.92,
            displayAlign: "center",
          },
        };
    </script>
    
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/quantecon-book-theme.b2c9c855ebbf206c0b4223812193cad1.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">


    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="_static/quantecon-book-theme.a5462485f8dd312884626d20cc9f547c.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-svg.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://python.quantecon.org/ols.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="58. Maximum Likelihood Estimation" href="mle.html" />
    <link rel="prev" title="56. Pandas for Panel Data" href="pandas_panel.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Linear Regression in Python"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Linear Regression in Python" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/ols.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="wrapper">

        <div class="main">

            <div class="page" id=ols>

                <div class="page__toc">

                    <div class="inner">

                        
                        <div class="page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   57.1. Overview
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prerequisites">
     57.1.1. Prerequisites
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-linear-regression">
   57.2. Simple Linear Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extending-the-linear-regression-model">
   57.3. Extending the Linear Regression Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#endogeneity">
   57.4. Endogeneity
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   57.5. Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   57.6. Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     57.6.1. Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-2">
     57.6.2. Exercise 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solutions">
   57.7. Solutions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     57.7.1. Exercise 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     57.7.2. Exercise 2
    </a>
   </li>
  </ul>
 </li>
</ul>

                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo" alt="logo"></a>
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="page__header">

                    <div class="page__header-copy">

                        <p class="page__header-heading"><a href="intro.html">Quantitative Economics with Python</a></p>

                        <p class="page__header-subheading">Linear Regression in Python</p>

                    </div>

                    <p class="page__header-authors">Thomas J. Sargent & John Stachurski</p>

                </div> <!-- .page__header -->



                
                <main class="page__content" role="main">
                    
                    <div>
                        
  <div id="qe-notebook-header" align="right" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" width="250px" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><div class="section" id="linear-regression-in-python">
<h1><a class="toc-backref" href="#id13"><span class="section-number">57. </span>Linear Regression in Python</a><a class="headerlink" href="#linear-regression-in-python" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#linear-regression-in-python" id="id13">Linear Regression in Python</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id14">Overview</a></p></li>
<li><p><a class="reference internal" href="#simple-linear-regression" id="id15">Simple Linear Regression</a></p></li>
<li><p><a class="reference internal" href="#extending-the-linear-regression-model" id="id16">Extending the Linear Regression Model</a></p></li>
<li><p><a class="reference internal" href="#endogeneity" id="id17">Endogeneity</a></p></li>
<li><p><a class="reference internal" href="#summary" id="id18">Summary</a></p></li>
<li><p><a class="reference internal" href="#exercises" id="id19">Exercises</a></p></li>
<li><p><a class="reference internal" href="#solutions" id="id20">Solutions</a></p></li>
</ul>
</li>
</ul>
</div>
<p>In addition to what’s in Anaconda, this lecture will need the following libraries:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install linearmodels
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting linearmodels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Downloading linearmodels-4.24-cp38-cp38-manylinux1_x86_64.whl (1.5 MB)
?25l
     |▎                               | 10 kB 35.0 MB/s eta 0:00:01
     |▌                               | 20 kB 24.3 MB/s eta 0:00:01
     |▊                               | 30 kB 11.6 MB/s eta 0:00:01
     |█                               | 40 kB 5.4 MB/s eta 0:00:01
     |█▏                              | 51 kB 6.5 MB/s eta 0:00:01
     |█▍                              | 61 kB 6.9 MB/s eta 0:00:01
     |█▋                              | 71 kB 7.2 MB/s eta 0:00:01
     |█▉                              | 81 kB 7.3 MB/s eta 0:00:01
     |██                              | 92 kB 7.2 MB/s eta 0:00:01
     |██▎                             | 102 kB 6.5 MB/s eta 0:00:01
     |██▌                             | 112 kB 6.5 MB/s eta 0:00:01
     |██▊                             | 122 kB 6.5 MB/s eta 0:00:01
     |███                             | 133 kB 6.5 MB/s eta 0:00:01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     |███▏                            | 143 kB 6.5 MB/s eta 0:00:01
     |███▍                            | 153 kB 6.5 MB/s eta 0:00:01
     |███▋                            | 163 kB 6.5 MB/s eta 0:00:01
     |███▉                            | 174 kB 6.5 MB/s eta 0:00:01
     |████                            | 184 kB 6.5 MB/s eta 0:00:01
     |████▎                           | 194 kB 6.5 MB/s eta 0:00:01
     |████▌                           | 204 kB 6.5 MB/s eta 0:00:01
     |████▊                           | 215 kB 6.5 MB/s eta 0:00:01
     |█████                           | 225 kB 6.5 MB/s eta 0:00:01
     |█████▏                          | 235 kB 6.5 MB/s eta 0:00:01
     |█████▍                          | 245 kB 6.5 MB/s eta 0:00:01
     |█████▋                          | 256 kB 6.5 MB/s eta 0:00:01
     |█████▉                          | 266 kB 6.5 MB/s eta 0:00:01
     |██████                          | 276 kB 6.5 MB/s eta 0:00:01
     |██████▎                         | 286 kB 6.5 MB/s eta 0:00:01
     |██████▌                         | 296 kB 6.5 MB/s eta 0:00:01
     |██████▊                         | 307 kB 6.5 MB/s eta 0:00:01
     |███████                         | 317 kB 6.5 MB/s eta 0:00:01
     |███████▏                        | 327 kB 6.5 MB/s eta 0:00:01
     |███████▍                        | 337 kB 6.5 MB/s eta 0:00:01
     |███████▋                        | 348 kB 6.5 MB/s eta 0:00:01
     |███████▉                        | 358 kB 6.5 MB/s eta 0:00:01
     |████████                        | 368 kB 6.5 MB/s eta 0:00:01
     |████████▎                       | 378 kB 6.5 MB/s eta 0:00:01
     |████████▌                       | 389 kB 6.5 MB/s eta 0:00:01
     |████████▊                       | 399 kB 6.5 MB/s eta 0:00:01
     |█████████                       | 409 kB 6.5 MB/s eta 0:00:01
     |█████████▏                      | 419 kB 6.5 MB/s eta 0:00:01
     |█████████▍                      | 430 kB 6.5 MB/s eta 0:00:01
     |█████████▋                      | 440 kB 6.5 MB/s eta 0:00:01
     |█████████▉                      | 450 kB 6.5 MB/s eta 0:00:01
     |██████████                      | 460 kB 6.5 MB/s eta 0:00:01
     |██████████▎                     | 471 kB 6.5 MB/s eta 0:00:01
     |██████████▌                     | 481 kB 6.5 MB/s eta 0:00:01
     |██████████▊                     | 491 kB 6.5 MB/s eta 0:00:01
     |███████████                     | 501 kB 6.5 MB/s eta 0:00:01
     |███████████▏                    | 512 kB 6.5 MB/s eta 0:00:01
     |███████████▍                    | 522 kB 6.5 MB/s eta 0:00:01
     |███████████▋                    | 532 kB 6.5 MB/s eta 0:00:01
     |███████████▉                    | 542 kB 6.5 MB/s eta 0:00:01
     |████████████                    | 552 kB 6.5 MB/s eta 0:00:01
     |████████████▎                   | 563 kB 6.5 MB/s eta 0:00:01
     |████████████▌                   | 573 kB 6.5 MB/s eta 0:00:01
     |████████████▊                   | 583 kB 6.5 MB/s eta 0:00:01
     |█████████████                   | 593 kB 6.5 MB/s eta 0:00:01
     |█████████████▏                  | 604 kB 6.5 MB/s eta 0:00:01
     |█████████████▍                  | 614 kB 6.5 MB/s eta 0:00:01
     |█████████████▋                  | 624 kB 6.5 MB/s eta 0:00:01
     |█████████████▉                  | 634 kB 6.5 MB/s eta 0:00:01
     |██████████████                  | 645 kB 6.5 MB/s eta 0:00:01
     |██████████████▎                 | 655 kB 6.5 MB/s eta 0:00:01
     |██████████████▌                 | 665 kB 6.5 MB/s eta 0:00:01
     |██████████████▊                 | 675 kB 6.5 MB/s eta 0:00:01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     |███████████████                 | 686 kB 6.5 MB/s eta 0:00:01
     |███████████████▏                | 696 kB 6.5 MB/s eta 0:00:01
     |███████████████▍                | 706 kB 6.5 MB/s eta 0:00:01
     |███████████████▋                | 716 kB 6.5 MB/s eta 0:00:01
     |███████████████▉                | 727 kB 6.5 MB/s eta 0:00:01
     |████████████████                | 737 kB 6.5 MB/s eta 0:00:01
     |████████████████▎               | 747 kB 6.5 MB/s eta 0:00:01
     |████████████████▌               | 757 kB 6.5 MB/s eta 0:00:01
     |████████████████▊               | 768 kB 6.5 MB/s eta 0:00:01
     |█████████████████               | 778 kB 6.5 MB/s eta 0:00:01
     |█████████████████▏              | 788 kB 6.5 MB/s eta 0:00:01
     |█████████████████▍              | 798 kB 6.5 MB/s eta 0:00:01
     |█████████████████▋              | 808 kB 6.5 MB/s eta 0:00:01
     |█████████████████▉              | 819 kB 6.5 MB/s eta 0:00:01
     |██████████████████              | 829 kB 6.5 MB/s eta 0:00:01
     |██████████████████▎             | 839 kB 6.5 MB/s eta 0:00:01
     |██████████████████▌             | 849 kB 6.5 MB/s eta 0:00:01
     |██████████████████▊             | 860 kB 6.5 MB/s eta 0:00:01
     |███████████████████             | 870 kB 6.5 MB/s eta 0:00:01
     |███████████████████▏            | 880 kB 6.5 MB/s eta 0:00:01
     |███████████████████▍            | 890 kB 6.5 MB/s eta 0:00:01
     |███████████████████▋            | 901 kB 6.5 MB/s eta 0:00:01
     |███████████████████▉            | 911 kB 6.5 MB/s eta 0:00:01
     |████████████████████            | 921 kB 6.5 MB/s eta 0:00:01
     |████████████████████▎           | 931 kB 6.5 MB/s eta 0:00:01
     |████████████████████▌           | 942 kB 6.5 MB/s eta 0:00:01
     |████████████████████▊           | 952 kB 6.5 MB/s eta 0:00:01
     |█████████████████████           | 962 kB 6.5 MB/s eta 0:00:01
     |█████████████████████▏          | 972 kB 6.5 MB/s eta 0:00:01
     |█████████████████████▍          | 983 kB 6.5 MB/s eta 0:00:01
     |█████████████████████▋          | 993 kB 6.5 MB/s eta 0:00:01
     |█████████████████████▉          | 1.0 MB 6.5 MB/s eta 0:00:01
     |██████████████████████          | 1.0 MB 6.5 MB/s eta 0:00:01
     |██████████████████████▎         | 1.0 MB 6.5 MB/s eta 0:00:01
     |██████████████████████▌         | 1.0 MB 6.5 MB/s eta 0:00:01
     |██████████████████████▊         | 1.0 MB 6.5 MB/s eta 0:00:01
     |███████████████████████         | 1.1 MB 6.5 MB/s eta 0:00:01
     |███████████████████████▏        | 1.1 MB 6.5 MB/s eta 0:00:01
     |███████████████████████▍        | 1.1 MB 6.5 MB/s eta 0:00:01
     |███████████████████████▋        | 1.1 MB 6.5 MB/s eta 0:00:01
     |███████████████████████▉        | 1.1 MB 6.5 MB/s eta 0:00:01
     |████████████████████████        | 1.1 MB 6.5 MB/s eta 0:00:01
     |████████████████████████▎       | 1.1 MB 6.5 MB/s eta 0:00:01
     |████████████████████████▌       | 1.1 MB 6.5 MB/s eta 0:00:01
     |████████████████████████▊       | 1.1 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████       | 1.1 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████▏      | 1.2 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████▍      | 1.2 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████▋      | 1.2 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████▉      | 1.2 MB 6.5 MB/s eta 0:00:01
     |██████████████████████████      | 1.2 MB 6.5 MB/s eta 0:00:01
     |██████████████████████████▎     | 1.2 MB 6.5 MB/s eta 0:00:01
     |██████████████████████████▌     | 1.2 MB 6.5 MB/s eta 0:00:01
     |██████████████████████████▊     | 1.2 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████     | 1.2 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████▏    | 1.2 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████▍    | 1.3 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████▋    | 1.3 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████▉    | 1.3 MB 6.5 MB/s eta 0:00:01
     |████████████████████████████    | 1.3 MB 6.5 MB/s eta 0:00:01
     |████████████████████████████▎   | 1.3 MB 6.5 MB/s eta 0:00:01
     |████████████████████████████▌   | 1.3 MB 6.5 MB/s eta 0:00:01
     |████████████████████████████▊   | 1.3 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████████   | 1.3 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████████▏  | 1.3 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████████▍  | 1.4 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████████▋  | 1.4 MB 6.5 MB/s eta 0:00:01
     |█████████████████████████████▉  | 1.4 MB 6.5 MB/s eta 0:00:01
     |██████████████████████████████  | 1.4 MB 6.5 MB/s eta 0:00:01
     |██████████████████████████████▎ | 1.4 MB 6.5 MB/s eta 0:00:01
     |██████████████████████████████▌ | 1.4 MB 6.5 MB/s eta 0:00:01
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     |██████████████████████████████▊ | 1.4 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████████ | 1.4 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████████▏| 1.4 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████████▍| 1.4 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████████▋| 1.5 MB 6.5 MB/s eta 0:00:01
     |███████████████████████████████▉| 1.5 MB 6.5 MB/s eta 0:00:01
     |████████████████████████████████| 1.5 MB 6.5 MB/s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>?25hRequirement already satisfied: pandas&gt;=0.24 in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from linearmodels) (1.1.3)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting property-cached&gt;=1.6.3
  Downloading property_cached-1.6.4-py2.py3-none-any.whl (7.8 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting mypy-extensions&gt;=0.4
  Downloading mypy_extensions-0.4.3-py2.py3-none-any.whl (4.5 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: patsy in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from linearmodels) (0.5.1)
Requirement already satisfied: numpy&gt;=1.16 in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from linearmodels) (1.19.2)
Requirement already satisfied: Cython&gt;=0.29.21 in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from linearmodels) (0.29.21)
Requirement already satisfied: scipy&gt;=1.2 in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from linearmodels) (1.5.2)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: statsmodels&gt;=0.11 in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from linearmodels) (0.12.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pyhdfe&gt;=0.1
  Downloading pyhdfe-0.1.0-py3-none-any.whl (18 kB)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from pandas&gt;=0.24-&gt;linearmodels) (2.8.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pytz&gt;=2017.2 in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from pandas&gt;=0.24-&gt;linearmodels) (2020.1)
Requirement already satisfied: six in /usr/share/miniconda3/envs/quantecon/lib/python3.8/site-packages (from patsy-&gt;linearmodels) (1.15.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing collected packages: property-cached, mypy-extensions, pyhdfe, linearmodels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Successfully installed linearmodels-4.24 mypy-extensions-0.4.3 property-cached-1.6.4 pyhdfe-0.1.0
</pre></div>
</div>
</div>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id14"><span class="section-number">57.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Linear regression is a standard tool for analyzing the relationship between two or more variables.</p>
<p>In this lecture, we’ll use the Python package <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> to estimate, interpret, and visualize linear regression models.</p>
<p>Along the way, we’ll discuss a variety of topics, including</p>
<ul class="simple">
<li><p>simple and multivariate linear regression</p></li>
<li><p>visualization</p></li>
<li><p>endogeneity and omitted variable bias</p></li>
<li><p>two-stage least squares</p></li>
</ul>
<p>As an example, we will replicate results from Acemoglu, Johnson and Robinson’s seminal paper <span id="id1">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span>.</p>
<ul class="simple">
<li><p>You can download a copy <a class="reference external" href="https://economics.mit.edu/files/4123">here</a>.</p></li>
</ul>
<p>In the paper, the authors emphasize the importance of institutions in economic development.</p>
<p>The main contribution is the use of settler mortality rates as a source of <em>exogenous</em> variation in institutional differences.</p>
<p>Such variation is needed to determine whether it is institutions that give rise to greater economic growth, rather than the other way around.</p>
<p>Let’s start with some imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1">#set default figure size</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.iolib.summary2</span> <span class="kn">import</span> <span class="n">summary_col</span>
<span class="kn">from</span> <span class="nn">linearmodels.iv</span> <span class="kn">import</span> <span class="n">IV2SLS</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="prerequisites">
<h3><span class="section-number">57.1.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>This lecture assumes you are familiar with basic econometrics.</p>
<p>For an introductory text covering these topics, see, for example,
<span id="id2">[<a class="reference internal" href="zreferences.html#id53">Woo15</a>]</span>.</p>
</div>
</div>
<div class="section" id="simple-linear-regression">
<h2><a class="toc-backref" href="#id15"><span class="section-number">57.2. </span>Simple Linear Regression</a><a class="headerlink" href="#simple-linear-regression" title="Permalink to this headline">¶</a></h2>
<p><span id="id3">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span> wish to determine whether or not differences in institutions can help to explain observed economic outcomes.</p>
<p>How do we measure <em>institutional differences</em> and <em>economic outcomes</em>?</p>
<p>In this paper,</p>
<ul class="simple">
<li><p>economic outcomes are proxied by log GDP per capita in 1995, adjusted for exchange rates.</p></li>
<li><p>institutional differences are proxied by an index of protection against expropriation on average over 1985-95, constructed by the <a class="reference external" href="https://www.prsgroup.com/">Political Risk Services Group</a>.</p></li>
</ul>
<p>These variables and other data used in the paper are available for download on Daron Acemoglu’s <a class="reference external" href="https://economics.mit.edu/faculty/acemoglu/data/ajr2001">webpage</a>.</p>
<p>We will use pandas’ <code class="docutils literal notranslate"><span class="pre">.read_stata()</span></code> function to read in data contained in the <code class="docutils literal notranslate"><span class="pre">.dta</span></code> files to dataframes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;https://github.com/QuantEcon/lecture-python/blob/master/source/_static/lecture_specific/ols/maketable1.dta?raw=true&#39;</span><span class="p">)</span>
<span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>shortnam</th>
      <th>euro1900</th>
      <th>excolony</th>
      <th>avexpr</th>
      <th>logpgp95</th>
      <th>cons1</th>
      <th>cons90</th>
      <th>democ00a</th>
      <th>cons00a</th>
      <th>extmort4</th>
      <th>logem4</th>
      <th>loghjypl</th>
      <th>baseco</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AFG</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>93.699997</td>
      <td>4.540098</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AGO</td>
      <td>8.000000</td>
      <td>1.0</td>
      <td>5.363636</td>
      <td>7.770645</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>280.000000</td>
      <td>5.634789</td>
      <td>-3.411248</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ARE</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>7.181818</td>
      <td>9.804219</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ARG</td>
      <td>60.000004</td>
      <td>1.0</td>
      <td>6.386364</td>
      <td>9.133459</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>68.900002</td>
      <td>4.232656</td>
      <td>-0.872274</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ARM</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>7.682482</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s use a scatterplot to see whether any obvious relationship exists
between GDP per capita and the protection against
expropriation index</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>

<span class="n">df1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;avexpr&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ols_7_0.png" src="_images/ols_7_0.png" />
</div>
</div>
<p>The plot shows a fairly strong positive relationship between
protection against expropriation and log GDP per capita.</p>
<p>Specifically, if higher protection against expropriation is a measure of
institutional quality, then better institutions appear to be positively
correlated with better economic outcomes (higher GDP per capita).</p>
<p>Given the plot, choosing a linear model to describe this relationship
seems like a reasonable assumption.</p>
<p>We can write our model as</p>
<div class="math notranslate nohighlight">
\[
{logpgp95}_i = \beta_0 + \beta_1 {avexpr}_i + u_i
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_0\)</span> is the intercept of the linear trend line on the
y-axis</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span> is the slope of the linear trend line, representing
the <em>marginal effect</em> of protection against risk on log GDP per
capita</p></li>
<li><p><span class="math notranslate nohighlight">\(u_i\)</span> is a random error term (deviations of observations from
the linear trend due to factors not included in the model)</p></li>
</ul>
<p>Visually, this linear model involves choosing a straight line that best
fits the data, as in the following plot (Figure 2 in <span id="id4">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dropping NA&#39;s is required to use numpy&#39;s polyfit</span>
<span class="n">df1_subset</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">])</span>

<span class="c1"># Use only &#39;base sample&#39; for plotting purposes</span>
<span class="n">df1_subset</span> <span class="o">=</span> <span class="n">df1_subset</span><span class="p">[</span><span class="n">df1_subset</span><span class="p">[</span><span class="s1">&#39;baseco&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df1_subset</span><span class="p">[</span><span class="s1">&#39;avexpr&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df1_subset</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">df1_subset</span><span class="p">[</span><span class="s1">&#39;shortnam&#39;</span><span class="p">]</span>

<span class="c1"># Replace markers with country labels</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># Fit a linear trend line</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">),</span>
         <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">)),</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">3.3</span><span class="p">,</span><span class="mf">10.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mf">10.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Average Expropriation Risk 1985-95&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Log GDP per capita, PPP, 1995&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Figure 2: OLS relationship between expropriation </span><span class="se">\</span>
<span class="s1">    risk and income&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ols_9_0.png" src="_images/ols_9_0.png" />
</div>
</div>
<p>The most common technique to estimate the parameters (<span class="math notranslate nohighlight">\(\beta\)</span>’s)
of the linear model is Ordinary Least Squares (OLS).</p>
<p>As the name implies, an OLS model is solved by finding the parameters
that minimize <em>the sum of squared residuals</em>, i.e.</p>
<div class="math notranslate nohighlight">
\[
\underset{\hat{\beta}}{\min} \sum^N_{i=1}{\hat{u}^2_i}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{u}_i\)</span> is the difference between the observation and
the predicted value of the dependent variable.</p>
<p>To estimate the constant term <span class="math notranslate nohighlight">\(\beta_0\)</span>, we need to add a column
of 1’s to our dataset (consider the equation if <span class="math notranslate nohighlight">\(\beta_0\)</span> was
replaced with <span class="math notranslate nohighlight">\(\beta_0 x_i\)</span> and <span class="math notranslate nohighlight">\(x_i = 1\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can construct our model in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> using the OLS function.</p>
<p>We will use <code class="docutils literal notranslate"><span class="pre">pandas</span></code> dataframes with <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, however standard arrays can also be used as arguments</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reg1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">],</span> <span class="n">exog</span><span class="o">=</span><span class="n">df1</span><span class="p">[[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">]],</span> \
    <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">reg1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>statsmodels.regression.linear_model.OLS
</pre></div>
</div>
</div>
</div>
<p>So far we have simply constructed our model.</p>
<p>We need to use <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> to obtain parameter estimates
<span class="math notranslate nohighlight">\(\hat{\beta}_0\)</span> and <span class="math notranslate nohighlight">\(\hat{\beta}_1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">reg1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">type</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>statsmodels.regression.linear_model.RegressionResultsWrapper
</pre></div>
</div>
</div>
</div>
<p>We now have the fitted regression model stored in <code class="docutils literal notranslate"><span class="pre">results</span></code>.</p>
<p>To view the OLS regression results, we can call the <code class="docutils literal notranslate"><span class="pre">.summary()</span></code>
method.</p>
<p>Note that an observation was mistakenly dropped from the results in the
original paper (see the note located in <a class="reference external" href="http://maketable2.do">maketable2.do</a> from Acemoglu’s webpage), and thus the
coefficients differ slightly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               logpgp95   R-squared:                       0.611
Model:                            OLS   Adj. R-squared:                  0.608
Method:                 Least Squares   F-statistic:                     171.4
Date:                Mon, 28 Jun 2021   Prob (F-statistic):           4.16e-24
Time:                        23:37:09   Log-Likelihood:                -119.71
No. Observations:                 111   AIC:                             243.4
Df Residuals:                     109   BIC:                             248.8
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          4.6261      0.301     15.391      0.000       4.030       5.222
avexpr         0.5319      0.041     13.093      0.000       0.451       0.612
==============================================================================
Omnibus:                        9.251   Durbin-Watson:                   1.689
Prob(Omnibus):                  0.010   Jarque-Bera (JB):                9.170
Skew:                          -0.680   Prob(JB):                       0.0102
Kurtosis:                       3.362   Cond. No.                         33.2
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>From our results, we see that</p>
<ul class="simple">
<li><p>The intercept <span class="math notranslate nohighlight">\(\hat{\beta}_0 = 4.63\)</span>.</p></li>
<li><p>The slope <span class="math notranslate nohighlight">\(\hat{\beta}_1 = 0.53\)</span>.</p></li>
<li><p>The positive <span class="math notranslate nohighlight">\(\hat{\beta}_1\)</span> parameter estimate implies that.
institutional quality has a positive effect on economic outcomes, as
we saw in the figure.</p></li>
<li><p>The p-value of 0.000 for <span class="math notranslate nohighlight">\(\hat{\beta}_1\)</span> implies that the
effect of institutions on GDP is statistically significant (using p &lt;
0.05 as a rejection rule).</p></li>
<li><p>The R-squared value of 0.611 indicates that around 61% of variation
in log GDP per capita is explained by protection against
expropriation.</p></li>
</ul>
<p>Using our parameter estimates, we can now write our estimated
relationship as</p>
<div class="math notranslate nohighlight">
\[
\widehat{logpgp95}_i = 4.63 + 0.53 \ {avexpr}_i
\]</div>
<p>This equation describes the line that best fits our data, as shown in
Figure 2.</p>
<p>We can use this equation to predict the level of log GDP per capita for
a value of the index of expropriation protection.</p>
<p>For example, for a country with an index value of 7.07 (the average for
the dataset), we find that their predicted level of log GDP per capita
in 1995 is 8.38.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_expr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df1_subset</span><span class="p">[</span><span class="s1">&#39;avexpr&#39;</span><span class="p">])</span>
<span class="n">mean_expr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.515625
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_logpdp95</span> <span class="o">=</span> <span class="mf">4.63</span> <span class="o">+</span> <span class="mf">0.53</span> <span class="o">*</span> <span class="mf">7.07</span>
<span class="n">predicted_logpdp95</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.3771
</pre></div>
</div>
</div>
</div>
<p>An easier (and more accurate) way to obtain this result is to use
<code class="docutils literal notranslate"><span class="pre">.predict()</span></code> and set <span class="math notranslate nohighlight">\(constant = 1\)</span> and
<span class="math notranslate nohighlight">\({avexpr}_i = mean\_expr\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">mean_expr</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([8.09156367])
</pre></div>
</div>
</div>
</div>
<p>We can obtain an array of predicted <span class="math notranslate nohighlight">\({logpgp95}_i\)</span> for every value
of <span class="math notranslate nohighlight">\({avexpr}_i\)</span> in our dataset by calling <code class="docutils literal notranslate"><span class="pre">.predict()</span></code> on our
results.</p>
<p>Plotting the predicted values against <span class="math notranslate nohighlight">\({avexpr}_i\)</span> shows that the
predicted values lie along the linear line that we fitted above.</p>
<p>The observed values of <span class="math notranslate nohighlight">\({logpgp95}_i\)</span> are also plotted for
comparison purposes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop missing observations from whole sample</span>

<span class="n">df1_plot</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">])</span>

<span class="c1"># Plot predicted values</span>

<span class="n">fix</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df1_plot</span><span class="p">[</span><span class="s1">&#39;avexpr&#39;</span><span class="p">],</span> <span class="n">results</span><span class="o">.</span><span class="n">predict</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;predicted&#39;</span><span class="p">)</span>

<span class="c1"># Plot observed values</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df1_plot</span><span class="p">[</span><span class="s1">&#39;avexpr&#39;</span><span class="p">],</span> <span class="n">df1_plot</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;OLS predicted values&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;avexpr&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ols_24_0.png" src="_images/ols_24_0.png" />
</div>
</div>
</div>
<div class="section" id="extending-the-linear-regression-model">
<h2><a class="toc-backref" href="#id16"><span class="section-number">57.3. </span>Extending the Linear Regression Model</a><a class="headerlink" href="#extending-the-linear-regression-model" title="Permalink to this headline">¶</a></h2>
<p>So far we have only accounted for institutions affecting economic
performance - almost certainly there are numerous other factors
affecting GDP that are not included in our model.</p>
<p>Leaving out variables that affect <span class="math notranslate nohighlight">\(logpgp95_i\)</span> will result in <strong>omitted variable bias</strong>, yielding biased and inconsistent parameter estimates.</p>
<p>We can extend our bivariate regression model to a <strong>multivariate regression model</strong> by adding in other factors that may affect <span class="math notranslate nohighlight">\(logpgp95_i\)</span>.</p>
<p><span id="id5">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span> consider other factors such as:</p>
<ul class="simple">
<li><p>the effect of climate on economic outcomes; latitude is used to proxy
this</p></li>
<li><p>differences that affect both economic performance and institutions,
eg. cultural, historical, etc.; controlled for with the use of
continent dummies</p></li>
</ul>
<p>Let’s estimate some of the extended models considered in the paper
(Table 2) using data from <code class="docutils literal notranslate"><span class="pre">maketable2.dta</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;https://github.com/QuantEcon/lecture-python/blob/master/source/_static/lecture_specific/ols/maketable2.dta?raw=true&#39;</span><span class="p">)</span>

<span class="c1"># Add constant term to dataset</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Create lists of variables to be used in each regression</span>
<span class="n">X1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">]</span>
<span class="n">X2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">,</span> <span class="s1">&#39;lat_abst&#39;</span><span class="p">]</span>
<span class="n">X3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">,</span> <span class="s1">&#39;lat_abst&#39;</span><span class="p">,</span> <span class="s1">&#39;asia&#39;</span><span class="p">,</span> <span class="s1">&#39;africa&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">]</span>

<span class="c1"># Estimate an OLS regression for each set of variables</span>
<span class="n">reg1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">],</span> <span class="n">df2</span><span class="p">[</span><span class="n">X1</span><span class="p">],</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">reg2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">],</span> <span class="n">df2</span><span class="p">[</span><span class="n">X2</span><span class="p">],</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">reg3</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">],</span> <span class="n">df2</span><span class="p">[</span><span class="n">X3</span><span class="p">],</span> <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have fitted our model, we will use <code class="docutils literal notranslate"><span class="pre">summary_col</span></code> to
display the results in a single table (model numbers correspond to those
in the paper)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">info_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;R-squared&#39;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">rsquared</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
           <span class="s1">&#39;No. observations&#39;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">nobs</span><span class="p">)</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>

<span class="n">results_table</span> <span class="o">=</span> <span class="n">summary_col</span><span class="p">(</span><span class="n">results</span><span class="o">=</span><span class="p">[</span><span class="n">reg1</span><span class="p">,</span><span class="n">reg2</span><span class="p">,</span><span class="n">reg3</span><span class="p">],</span>
                            <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%0.2f</span><span class="s1">&#39;</span><span class="p">,</span>
                            <span class="n">stars</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="n">model_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Model 1&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;Model 3&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;Model 4&#39;</span><span class="p">],</span>
                            <span class="n">info_dict</span><span class="o">=</span><span class="n">info_dict</span><span class="p">,</span>
                            <span class="n">regressor_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;avexpr&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;lat_abst&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;asia&#39;</span><span class="p">,</span>
                                             <span class="s1">&#39;africa&#39;</span><span class="p">])</span>

<span class="n">results_table</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="s1">&#39;Table 2 - OLS Regressions&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">results_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Table 2 - OLS Regressions
=========================================
                 Model 1 Model 3 Model 4 
-----------------------------------------
const            4.63*** 4.87*** 5.85*** 
                 (0.30)  (0.33)  (0.34)  
avexpr           0.53*** 0.46*** 0.39*** 
                 (0.04)  (0.06)  (0.05)  
lat_abst                 0.87*   0.33    
                         (0.49)  (0.45)  
asia                             -0.15   
                                 (0.15)  
africa                           -0.92***
                                 (0.17)  
other                            0.30    
                                 (0.37)  
R-squared        0.61    0.62    0.72    
R-squared Adj.   0.61    0.62    0.70    
R-squared        0.61    0.62    0.72    
No. observations 111     111     111     
=========================================
Standard errors in parentheses.
* p&lt;.1, ** p&lt;.05, ***p&lt;.01
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="endogeneity">
<h2><a class="toc-backref" href="#id17"><span class="section-number">57.4. </span>Endogeneity</a><a class="headerlink" href="#endogeneity" title="Permalink to this headline">¶</a></h2>
<p>As <span id="id6">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span> discuss, the OLS models likely suffer from
<strong>endogeneity</strong> issues, resulting in biased and inconsistent model
estimates.</p>
<p>Namely, there is likely a two-way relationship between institutions and
economic outcomes:</p>
<ul class="simple">
<li><p>richer countries may be able to afford or prefer better institutions</p></li>
<li><p>variables that affect income may also be correlated with
institutional differences</p></li>
<li><p>the construction of the index may be biased; analysts may be biased
towards seeing countries with higher income having better
institutions</p></li>
</ul>
<p>To deal with endogeneity, we can use <strong>two-stage least squares (2SLS)
regression</strong>, which is an extension of OLS regression.</p>
<p>This method requires replacing the endogenous variable
<span class="math notranslate nohighlight">\({avexpr}_i\)</span> with a variable that is:</p>
<ol class="simple">
<li><p>correlated with <span class="math notranslate nohighlight">\({avexpr}_i\)</span></p></li>
<li><p>not correlated with the error term (ie. it should not directly affect
the dependent variable, otherwise it would be correlated with
<span class="math notranslate nohighlight">\(u_i\)</span> due to omitted variable bias)</p></li>
</ol>
<p>The new set of regressors is called an <strong>instrument</strong>, which aims to
remove endogeneity in our proxy of institutional differences.</p>
<p>The main contribution of <span id="id7">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span> is the use of settler mortality
rates to instrument for institutional differences.</p>
<p>They hypothesize that higher mortality rates of colonizers led to the
establishment of institutions that were more extractive in nature (less
protection against expropriation), and these institutions still persist
today.</p>
<p>Using a scatterplot (Figure 3 in <span id="id8">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span>), we can see protection
against expropriation is negatively correlated with settler mortality
rates, coinciding with the authors’ hypothesis and satisfying the first
condition of a valid instrument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dropping NA&#39;s is required to use numpy&#39;s polyfit</span>
<span class="n">df1_subset2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;logem4&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df1_subset2</span><span class="p">[</span><span class="s1">&#39;logem4&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df1_subset2</span><span class="p">[</span><span class="s1">&#39;avexpr&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">df1_subset2</span><span class="p">[</span><span class="s1">&#39;shortnam&#39;</span><span class="p">]</span>

<span class="c1"># Replace markers with country labels</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="c1"># Fit a linear trend line</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">),</span>
         <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">)),</span>
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">1.8</span><span class="p">,</span><span class="mf">8.4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">3.3</span><span class="p">,</span><span class="mf">10.4</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Log of Settler Mortality&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Average Expropriation Risk 1985-95&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Figure 3: First-stage relationship between settler mortality </span><span class="se">\</span>
<span class="s1">    and expropriation risk&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ols_30_0.png" src="_images/ols_30_0.png" />
</div>
</div>
<p>The second condition may not be satisfied if settler mortality rates in the 17th to 19th centuries have a direct effect on current GDP (in addition to their indirect effect through institutions).</p>
<p>For example, settler mortality rates may be related to the current disease environment in a country, which could affect current economic performance.</p>
<p><span id="id9">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span> argue this is unlikely because:</p>
<ul class="simple">
<li><p>The majority of settler deaths were due to malaria and yellow fever
and had a limited effect on local people.</p></li>
<li><p>The disease burden on local people in Africa or India, for example,
did not appear to be higher than average, supported by relatively
high population densities in these areas before colonization.</p></li>
</ul>
<p>As we appear to have a valid instrument, we can use 2SLS regression to
obtain consistent and unbiased parameter estimates.</p>
<p><strong>First stage</strong></p>
<p>The first stage involves regressing the endogenous variable
(<span class="math notranslate nohighlight">\({avexpr}_i\)</span>) on the instrument.</p>
<p>The instrument is the set of all exogenous variables in our model (and
not just the variable we have replaced).</p>
<p>Using model 1 as an example, our instrument is simply a constant and
settler mortality rates <span class="math notranslate nohighlight">\({logem4}_i\)</span>.</p>
<p>Therefore, we will estimate the first-stage regression as</p>
<div class="math notranslate nohighlight">
\[
{avexpr}_i = \delta_0 + \delta_1 {logem4}_i + v_i
\]</div>
<p>The data we need to estimate this equation is located in
<code class="docutils literal notranslate"><span class="pre">maketable4.dta</span></code> (only complete data, indicated by <code class="docutils literal notranslate"><span class="pre">baseco</span> <span class="pre">=</span> <span class="pre">1</span></code>, is
used for estimation)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import and select the data</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;https://github.com/QuantEcon/lecture-python/blob/master/source/_static/lecture_specific/ols/maketable4.dta?raw=true&#39;</span><span class="p">)</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">df4</span><span class="p">[</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;baseco&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Add a constant variable</span>
<span class="n">df4</span><span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Fit the first stage regression and print summary</span>
<span class="n">results_fs</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;avexpr&#39;</span><span class="p">],</span>
                    <span class="n">df4</span><span class="p">[[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;logem4&#39;</span><span class="p">]],</span>
                    <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_fs</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 avexpr   R-squared:                       0.270
Model:                            OLS   Adj. R-squared:                  0.258
Method:                 Least Squares   F-statistic:                     22.95
Date:                Mon, 28 Jun 2021   Prob (F-statistic):           1.08e-05
Time:                        23:37:11   Log-Likelihood:                -104.83
No. Observations:                  64   AIC:                             213.7
Df Residuals:                      62   BIC:                             218.0
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          9.3414      0.611     15.296      0.000       8.121      10.562
logem4        -0.6068      0.127     -4.790      0.000      -0.860      -0.354
==============================================================================
Omnibus:                        0.035   Durbin-Watson:                   2.003
Prob(Omnibus):                  0.983   Jarque-Bera (JB):                0.172
Skew:                           0.045   Prob(JB):                        0.918
Kurtosis:                       2.763   Cond. No.                         19.4
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p><strong>Second stage</strong></p>
<p>We need to retrieve the predicted values of <span class="math notranslate nohighlight">\({avexpr}_i\)</span> using
<code class="docutils literal notranslate"><span class="pre">.predict()</span></code>.</p>
<p>We then replace the endogenous variable <span class="math notranslate nohighlight">\({avexpr}_i\)</span> with the
predicted values <span class="math notranslate nohighlight">\(\widehat{avexpr}_i\)</span> in the original linear model.</p>
<p>Our second stage regression is thus</p>
<div class="math notranslate nohighlight">
\[
{logpgp95}_i = \beta_0 + \beta_1 \widehat{avexpr}_i + u_i
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;predicted_avexpr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_fs</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>

<span class="n">results_ss</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">],</span>
                    <span class="n">df4</span><span class="p">[[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted_avexpr&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_ss</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               logpgp95   R-squared:                       0.477
Model:                            OLS   Adj. R-squared:                  0.469
Method:                 Least Squares   F-statistic:                     56.60
Date:                Mon, 28 Jun 2021   Prob (F-statistic):           2.66e-10
Time:                        23:37:11   Log-Likelihood:                -72.268
No. Observations:                  64   AIC:                             148.5
Df Residuals:                      62   BIC:                             152.9
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
====================================================================================
                       coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------------
const                1.9097      0.823      2.320      0.024       0.264       3.555
predicted_avexpr     0.9443      0.126      7.523      0.000       0.693       1.195
==============================================================================
Omnibus:                       10.547   Durbin-Watson:                   2.137
Prob(Omnibus):                  0.005   Jarque-Bera (JB):               11.010
Skew:                          -0.790   Prob(JB):                      0.00407
Kurtosis:                       4.277   Cond. No.                         58.1
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>The second-stage regression results give us an unbiased and consistent
estimate of the effect of institutions on economic outcomes.</p>
<p>The result suggests a stronger positive relationship than what the OLS
results indicated.</p>
<p>Note that while our parameter estimates are correct, our standard errors
are not and for this reason, computing 2SLS ‘manually’ (in stages with
OLS) is not recommended.</p>
<p>We can correctly estimate a 2SLS regression in one step using the
<a class="reference external" href="https://github.com/bashtage/linearmodels">linearmodels</a> package, an extension of <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></p>
<p>Note that when using <code class="docutils literal notranslate"><span class="pre">IV2SLS</span></code>, the exogenous and instrument variables
are split up in the function arguments (whereas before the instrument
included exogenous variables)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iv</span> <span class="o">=</span> <span class="n">IV2SLS</span><span class="p">(</span><span class="n">dependent</span><span class="o">=</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">],</span>
            <span class="n">exog</span><span class="o">=</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">],</span>
            <span class="n">endog</span><span class="o">=</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;avexpr&#39;</span><span class="p">],</span>
            <span class="n">instruments</span><span class="o">=</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;logem4&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;unadjusted&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">iv</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                          IV-2SLS Estimation Summary                          
==============================================================================
Dep. Variable:               logpgp95   R-squared:                      0.1870
Estimator:                    IV-2SLS   Adj. R-squared:                 0.1739
No. Observations:                  64   F-statistic:                    37.568
Date:                Mon, Jun 28 2021   P-value (F-stat)                0.0000
Time:                        23:37:11   Distribution:                  chi2(1)
Cov. Estimator:            unadjusted                                         
                                                                              
                             Parameter Estimates                              
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          1.9097     1.0106     1.8897     0.0588     -0.0710      3.8903
avexpr         0.9443     0.1541     6.1293     0.0000      0.6423      1.2462
==============================================================================

Endogenous: avexpr
Instruments: logem4
Unadjusted Covariance (Homoskedastic)
Debiased: False
</pre></div>
</div>
</div>
</div>
<p>Given that we now have consistent and unbiased estimates, we can infer
from the model we have estimated that institutional differences
(stemming from institutions set up during colonization) can help
to explain differences in income levels across countries today.</p>
<p><span id="id10">[<a class="reference internal" href="zreferences.html#id54">AJR01</a>]</span> use a marginal effect of 0.94 to calculate that the
difference in the index between Chile and Nigeria (ie. institutional
quality) implies up to a 7-fold difference in income, emphasizing the
significance of institutions in economic development.</p>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id18"><span class="section-number">57.5. </span>Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>We have demonstrated basic OLS and 2SLS regression in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> and <code class="docutils literal notranslate"><span class="pre">linearmodels</span></code>.</p>
<p>If you are familiar with R, you may want to use the <a class="reference external" href="http://www.statsmodels.org/dev/example_formulas.html">formula interface</a> to <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, or consider using <a class="reference external" href="https://rpy2.github.io/">r2py</a> to call R from within Python.</p>
</div>
<div class="section" id="exercises">
<h2><a class="toc-backref" href="#id19"><span class="section-number">57.6. </span>Exercises</a><a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-1">
<h3><span class="section-number">57.6.1. </span>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<p>In the lecture, we think the original model suffers from endogeneity
bias due to the likely effect income has on institutional development.</p>
<p>Although endogeneity is often best identified by thinking about the data
and model, we can formally test for endogeneity using the <strong>Hausman
test</strong>.</p>
<p>We want to test for correlation between the endogenous variable,
<span class="math notranslate nohighlight">\(avexpr_i\)</span>, and the errors, <span class="math notranslate nohighlight">\(u_i\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
 H_0 : Cov(avexpr_i, u_i) = 0  \quad (no\ endogeneity) \\
 H_1 : Cov(avexpr_i, u_i) \neq 0 \quad (endogeneity)
 \end{aligned}
\end{split}\]</div>
<p>This test is running in two stages.</p>
<p>First, we regress <span class="math notranslate nohighlight">\(avexpr_i\)</span> on the instrument, <span class="math notranslate nohighlight">\(logem4_i\)</span></p>
<div class="math notranslate nohighlight">
\[
avexpr_i = \pi_0 + \pi_1 logem4_i + \upsilon_i
\]</div>
<p>Second, we retrieve the residuals <span class="math notranslate nohighlight">\(\hat{\upsilon}_i\)</span> and include
them in the original equation</p>
<div class="math notranslate nohighlight">
\[
logpgp95_i = \beta_0 + \beta_1 avexpr_i + \alpha \hat{\upsilon}_i + u_i
\]</div>
<p>If <span class="math notranslate nohighlight">\(\alpha\)</span> is statistically significant (with a p-value &lt; 0.05),
then we reject the null hypothesis and conclude that <span class="math notranslate nohighlight">\(avexpr_i\)</span> is
endogenous.</p>
<p>Using the above information, estimate a Hausman test and interpret your
results.</p>
</div>
<div class="section" id="exercise-2">
<h3><span class="section-number">57.6.2. </span>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h3>
<p>The OLS parameter <span class="math notranslate nohighlight">\(\beta\)</span> can also be estimated using matrix
algebra and <code class="docutils literal notranslate"><span class="pre">numpy</span></code> (you may need to review the
<a class="reference external" href="https://python-programming.quantecon.org/numpy.html">numpy</a> lecture to
complete this exercise).</p>
<p>The linear equation we want to estimate is (written in matrix form)</p>
<div class="math notranslate nohighlight">
\[
y = X\beta + u
\]</div>
<p>To solve for the unknown parameter <span class="math notranslate nohighlight">\(\beta\)</span>, we want to minimize
the sum of squared residuals</p>
<div class="math notranslate nohighlight">
\[
\underset{\hat{\beta}}{\min} \hat{u}'\hat{u}
\]</div>
<p>Rearranging the first equation and substituting into the second
equation, we can write</p>
<div class="math notranslate nohighlight">
\[
\underset{\hat{\beta}}{\min} \ (Y - X\hat{\beta})' (Y - X\hat{\beta})
\]</div>
<p>Solving this optimization problem gives the solution for the
<span class="math notranslate nohighlight">\(\hat{\beta}\)</span> coefficients</p>
<div class="math notranslate nohighlight">
\[
\hat{\beta} = (X'X)^{-1}X'y
\]</div>
<p>Using the above information, compute <span class="math notranslate nohighlight">\(\hat{\beta}\)</span> from model 1
using <code class="docutils literal notranslate"><span class="pre">numpy</span></code> - your results should be the same as those in the
<code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> output from earlier in the lecture.</p>
</div>
</div>
<div class="section" id="solutions">
<h2><a class="toc-backref" href="#id20"><span class="section-number">57.7. </span>Solutions</a><a class="headerlink" href="#solutions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id11">
<h3><span class="section-number">57.7.1. </span>Exercise 1<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load in data</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;https://github.com/QuantEcon/lecture-python/blob/master/source/_static/lecture_specific/ols/maketable4.dta?raw=true&#39;</span><span class="p">)</span>

<span class="c1"># Add a constant term</span>
<span class="n">df4</span><span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Estimate the first stage regression</span>
<span class="n">reg1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;avexpr&#39;</span><span class="p">],</span>
              <span class="n">exog</span><span class="o">=</span><span class="n">df4</span><span class="p">[[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;logem4&#39;</span><span class="p">]],</span>
              <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Retrieve the residuals</span>
<span class="n">df4</span><span class="p">[</span><span class="s1">&#39;resid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg1</span><span class="o">.</span><span class="n">resid</span>

<span class="c1"># Estimate the second stage residuals</span>
<span class="n">reg2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">endog</span><span class="o">=</span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">],</span>
              <span class="n">exog</span><span class="o">=</span><span class="n">df4</span><span class="p">[[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">,</span> <span class="s1">&#39;resid&#39;</span><span class="p">]],</span>
              <span class="n">missing</span><span class="o">=</span><span class="s1">&#39;drop&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">reg2</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               logpgp95   R-squared:                       0.689
Model:                            OLS   Adj. R-squared:                  0.679
Method:                 Least Squares   F-statistic:                     74.05
Date:                Mon, 28 Jun 2021   Prob (F-statistic):           1.07e-17
Time:                        23:37:12   Log-Likelihood:                -62.031
No. Observations:                  70   AIC:                             130.1
Df Residuals:                      67   BIC:                             136.8
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const          2.4782      0.547      4.530      0.000       1.386       3.570
avexpr         0.8564      0.082     10.406      0.000       0.692       1.021
resid         -0.4951      0.099     -5.017      0.000      -0.692      -0.298
==============================================================================
Omnibus:                       17.597   Durbin-Watson:                   2.086
Prob(Omnibus):                  0.000   Jarque-Bera (JB):               23.194
Skew:                          -1.054   Prob(JB):                     9.19e-06
Kurtosis:                       4.873   Cond. No.                         53.8
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>The output shows that the coefficient on the residuals is statistically
significant, indicating <span class="math notranslate nohighlight">\(avexpr_i\)</span> is endogenous.</p>
</div>
<div class="section" id="id12">
<h3><span class="section-number">57.7.2. </span>Exercise 2<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load in data</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;https://github.com/QuantEcon/lecture-python/blob/master/source/_static/lecture_specific/ols/maketable1.dta?raw=true&#39;</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">])</span>

<span class="c1"># Add a constant term</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;const&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Define the X and y variables</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;logpgp95&#39;</span><span class="p">])</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">df1</span><span class="p">[[</span><span class="s1">&#39;const&#39;</span><span class="p">,</span> <span class="s1">&#39;avexpr&#39;</span><span class="p">]])</span>

<span class="c1"># Compute β_hat</span>
<span class="n">β_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Print out the results from the 2 x 1 vector β_hat</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;β_0 = </span><span class="si">{</span><span class="n">β_hat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;β_1 = </span><span class="si">{</span><span class="n">β_hat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>β_0 = 4.6
β_1 = 0.53
</pre></div>
</div>
</div>
</div>
<p>It is also possible to use <code class="docutils literal notranslate"><span class="pre">np.linalg.inv(X.T</span> <span class="pre">&#64;</span> <span class="pre">X)</span> <span class="pre">&#64;</span> <span class="pre">X.T</span> <span class="pre">&#64;</span> <span class="pre">y</span></code> to solve
for <span class="math notranslate nohighlight">\(\beta\)</span>, however <code class="docutils literal notranslate"><span class="pre">.solve()</span></code> is preferred as it involves fewer
computations.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            
            <div class="sidebar bd-sidebar inactive" id="site-navigation">

                <div class="sidebar__header">


                    Contents

                </div>

                <nav class="sidebar__nav" id="sidebar-nav" aria-label="Main navigation">
                    <p class="caption">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="geom_series.html">
   1. Geometric Series for Elementary Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   2. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   3. Modeling COVID 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   4. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complex_and_trig.html">
   5. Complex Numbers and Trigonometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   6. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="heavy_tails.html">
   7. Heavy-Tailed Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   8. Multivariate Normal Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="time_series_with_matrices.html">
   9. Univariate Time Series with Matrix Algebra
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="scalar_dynam.html">
   10. Dynamics in One Dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_processes.html">
   11. AR1 Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   12. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   13. Inventory Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   14. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   15. Application: The Samuelson Multiplier-Accelerator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   16. Kesten Processes and Firm Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   17. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   18. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="short_path.html">
   19. Shortest Paths
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   20. Cass-Koopmans Planning Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   21. Cass-Koopmans Competitive Equilibrium
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Search
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   22. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   23. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   24. Job Search III: Fitted Value Function Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_correlated.html">
   25. Job Search IV: Correlated Wage Offers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   26. Job Search V: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   27. Job Search VI: On-the-Job Search
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Consumption, Savings and Growth
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_problem.html">
   28. Cake Eating I: Introduction to Optimal Saving
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_numerical.html">
   29. Cake Eating II: Numerical Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   30. Optimal Growth I: The Stochastic Optimal Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth_fast.html">
   31. Optimal Growth II: Accelerating the Code with Numba
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   32. Optimal Growth III: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   33. Optimal Growth IV: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   34. The Income Fluctuation Problem I: Basic Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   35. The Income Fluctuation Problem II: Stochastic Returns on Assets
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Information
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   36. Job Search VII: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   37. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   38. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   39. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   40. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   41. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   42. LQ Control: Foundations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   43. The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   44. Permanent Income II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   45. Production Smoothing via Inventories
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="schelling.html">
   46. Schelling’s Segregation Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   47. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   48. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   49. Stability in Linear Rational Expectations Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   50. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   51. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   52. The Aiyagari Model
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   53. Asset Pricing: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   54. Competitive equilibria with Arrow securities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   55. Heterogeneous Beliefs and Bubbles
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Data and Empirics
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   56. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   57. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   58. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   59. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   60. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   61. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="toolbar">

            <div class="toolbar__inner">

                <ul class="toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                    <!-- <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
                            <i data-feather="search"></i>
                        </form>
                    </li> -->
                </ul>

                <ul class="toolbar__links">
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/ols.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/tree/master/lectures/ols.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="_pdf/quantecon-python.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://mybinder.org/v2/gh/QuantEcon/lecture-python.notebooks/master?urlpath=tree/ols.ipynb">BinderHub</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/ols.ipynb" data-branch=master>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://mybinder.org/v2/gh/QuantEcon/lecture-python.notebooks/master?urlpath=tree/ols.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "ols";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/ols.ipynb";
                const branch = "master"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-54984338-10', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>