
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>37. Samuelson Multiplier-Accelerator &#8212; Intermediate Quantitative Economics with Python</title>
    
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js" integrity="sha384-bq5PNg/ZcfW7KMvFSmhjqCQJ/VFnec+6sZkctn/4ZLeubkn7U58Le4zFFSn3dhUu" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js" integrity="sha384-qEqAs1VsN9WH2myXDbiP2wGGIttL9bMRZBKCl54ZnzpDlVqbYANP9vMaoT/wvQcf" crossorigin="anonymous"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=22b71a9b445b7b2b6a277c0a48ea72bf6e7c90d9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=4c010e0d" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=65b86b9423025043228643fcfb616ce846cb91c1"></script>
    <script src="_static/scripts/jquery.js?v=5d32c60e"></script>
    <script src="_static/scripts/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'samuelson';</script>
    <link rel="canonical" href="https://python.quantecon.org/samuelson.html" />
    <link rel="icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="38. Kesten Processes and Firm Dynamics" href="kesten_processes.html" />
    <link rel="prev" title="36. Linear State Space Models" href="linear_models.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Samuelson Multiplier-Accelerator"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Samuelson Multiplier-Accelerator" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/samuelson.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Intermediate Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=samuelson>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">37.1. Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#samuelsons-model">37.1.1. Samuelson’s model</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#details">37.2. Details</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-version-of-the-model">37.2.1. Stochastic version of the model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-analysis-of-the-model">37.2.2. Mathematical analysis of the model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#things-this-lecture-does">37.2.3. Things this lecture does</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">37.3. Implementation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-to-describe-implications-of-characteristic-polynomial">37.3.1. Function to describe implications of characteristic polynomial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-for-plotting-paths">37.3.2. Function for plotting paths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manual-or-by-hand-root-calculations">37.3.3. Manual or “by hand” root calculations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-engineering-parameters-to-generate-damped-cycles">37.3.4. Reverse-engineering parameters to generate damped cycles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#root-finding-using-numpy">37.3.5. Root finding using numpy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-engineered-complex-roots-example">37.3.6. Reverse-engineered complex roots: Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digression-using-sympy-to-find-roots">37.3.7. Digression: Using Sympy to find roots</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic-shocks">37.4. Stochastic shocks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#government-spending">37.5. Government spending</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wrapping-everything-into-a-class">37.6. Wrapping everything into a class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-of-samuelson-class">37.6.1. Illustration of Samuelson class</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-graph">37.6.2. Using the graph</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-linearstatespace-class">37.7. Using the LinearStateSpace class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#other-methods-in-the-linearstatespace-class">37.7.1. Other methods in the <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> class</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inheriting-methods-from-linearstatespace">37.7.2. Inheriting methods from <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#illustrations">37.7.3. Illustrations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pure-multiplier-model">37.8. Pure multiplier model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">37.9. Summary</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/v1/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Intermediate Quantitative Economics with Python</a></p>

                    </div>

                    <!-- Authors section -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>

                    <!-- Last modified / Changelog dropdown -->
                        <button class="qe-page__header-changed" id="changelog-toggle" aria-expanded="false">
                            Last changed: Nov 25, 2025
                            <span class="changelog-icon">▼</span>
                        </button>

                    <!-- Changelog dropdown content -->
                    <div class="qe-page__header-changelog" id="changelog-content" aria-hidden="true">
                        <h4>Changelog (<a href="https://github.com/QuantEcon/lecture-python.myst/commits/main/lectures/samuelson.md">full history</a>)</h4>
                        <ul class="changelog-list">
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/089e35ca2" class="changelog-hash">089e35ca2</a>
                                
                                <span class="changelog-author">Matt McKay</span>
                                <span class="changelog-time">1 month ago</span>
                                <span class="changelog-message">Fix: Add trailing slash to quantecon-py URLs and upgrade quantecon-book-theme==0.13.2 (jupyterbook link fix) (#743)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/a1cd90c5e" class="changelog-hash">a1cd90c5e</a>
                                
                                <span class="changelog-author">Matt McKay</span>
                                <span class="changelog-time">1 month ago</span>
                                <span class="changelog-message">STYLE: Fix emphasis vs definitions style guide compliance (Issue #721) (#723)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/b9da40caf" class="changelog-hash">b9da40caf</a>
                                
                                <span class="changelog-author">Bishmay Barik</span>
                                <span class="changelog-time">3 months ago</span>
                                <span class="changelog-message">[samuelson] Fixing the lecture (#561)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/a73ba0f7d" class="changelog-hash">a73ba0f7d</a>
                                
                                <span class="changelog-author">Copilot</span>
                                <span class="changelog-time">4 months ago</span>
                                <span class="changelog-message">[style] Remove local figsize adjustments from all lecture files (#574)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/2ea031790" class="changelog-hash">2ea031790</a>
                                
                                <span class="changelog-author">Copilot</span>
                                <span class="changelog-time">4 months ago</span>
                                <span class="changelog-message">Upgrade all HTTP links to HTTPS across lecture series (#523)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/f4d7a8d77" class="changelog-hash">f4d7a8d77</a>
                                
                                <span class="changelog-author">Matt McKay</span>
                                <span class="changelog-time">1 year ago</span>
                                <span class="changelog-message">FIX: pass quantecon logo through to download notebooks (#432)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/dd9fd0199" class="changelog-hash">dd9fd0199</a>
                                
                                <span class="changelog-author">Smit Lunagariya</span>
                                <span class="changelog-time">1 year ago</span>
                                <span class="changelog-message">MAINT: Fix small typos (#362)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/80ef919b9" class="changelog-hash">80ef919b9</a>
                                
                                <span class="changelog-author">mmcky</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">ENH: Improve compatibility with Google Colab (#236)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/4d5d1f007" class="changelog-hash">4d5d1f007</a>
                                
                                <span class="changelog-author">mmcky</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">String should be on one line (#235)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/8ee128e86" class="changelog-hash">8ee128e86</a>
                                
                                <span class="changelog-author">thomassargent30</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">Tom's March 4 edits of two lectures</span>
                            </li>
                            
                        </ul>
                    </div>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="samuelson-multiplier-accelerator">
<h1><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">37. </span>Samuelson Multiplier-Accelerator</a><a class="headerlink" href="#samuelson-multiplier-accelerator" title="Link to this heading">#</a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#samuelson-multiplier-accelerator" id="id7">Samuelson Multiplier-Accelerator</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id8">Overview</a></p></li>
<li><p><a class="reference internal" href="#details" id="id9">Details</a></p></li>
<li><p><a class="reference internal" href="#implementation" id="id10">Implementation</a></p></li>
<li><p><a class="reference internal" href="#stochastic-shocks" id="id11">Stochastic shocks</a></p></li>
<li><p><a class="reference internal" href="#government-spending" id="id12">Government spending</a></p></li>
<li><p><a class="reference internal" href="#wrapping-everything-into-a-class" id="id13">Wrapping everything into a class</a></p></li>
<li><p><a class="reference internal" href="#using-the-linearstatespace-class" id="id14">Using the LinearStateSpace class</a></p></li>
<li><p><a class="reference internal" href="#pure-multiplier-model" id="id15">Pure multiplier model</a></p></li>
<li><p><a class="reference internal" href="#summary" id="id16">Summary</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>In addition to what’s in Anaconda, this lecture will need the following libraries:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>quantecon
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: quantecon in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (0.10.1)
Requirement already satisfied: numba&gt;=0.49.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (0.62.1)
Requirement already satisfied: numpy&gt;=1.17.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (2.3.5)
Requirement already satisfied: requests in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (2.32.5)
Requirement already satisfied: scipy&gt;=1.5.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (1.16.3)
Requirement already satisfied: sympy in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (1.14.0)
Requirement already satisfied: llvmlite&lt;0.46,&gt;=0.45.0dev0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from numba&gt;=0.49.0-&gt;quantecon) (0.45.1)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from requests-&gt;quantecon) (3.4.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from requests-&gt;quantecon) (3.11)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from requests-&gt;quantecon) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from requests-&gt;quantecon) (2025.11.12)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from sympy-&gt;quantecon) (1.3.0)
</pre></div>
</div>
</div>
</details>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">37.1. </span>Overview</a><a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This lecture creates non-stochastic and stochastic versions of Paul Samuelson’s celebrated multiplier accelerator model <span id="id1">[<a class="reference internal" href="zreferences.html#id101" title="Paul A. Samuelson. Interactions between the multiplier analysis and the principle of acceleration. Review of Economic Studies, 21(2):75–78, 1939.">Samuelson, 1939</a>]</span>.</p>
<p>In doing so, we extend the example of the Solow model class in <a class="reference external" href="https://python-programming.quantecon.org/python_oop.html">our second OOP lecture</a>.</p>
<p>Our objectives are to</p>
<ul class="simple">
<li><p>provide a more detailed example of OOP and classes</p></li>
<li><p>review a famous model</p></li>
<li><p>review linear difference equations, both deterministic and stochastic</p></li>
</ul>
<p>Let’s start with some standard imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll also use the following for various tasks described below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">quantecon</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearStateSpace</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cmath</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">init_printing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cmath</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>
</pre></div>
</div>
</div>
</div>
<section id="samuelsons-model">
<h3><span class="section-number">37.1.1. </span>Samuelson’s model<a class="headerlink" href="#samuelsons-model" title="Link to this heading">#</a></h3>
<p>Samuelson used a <em>second-order linear difference equation</em> to
represent a model of national output based on three components:</p>
<ul class="simple">
<li><p>a <em>national output identity</em> asserting that national output or national income is the
sum of consumption plus investment plus government purchases.</p></li>
<li><p>a Keynesian <em>consumption function</em> asserting that consumption at
time <span class="math notranslate nohighlight">\(t\)</span> is equal to a constant times national output at time <span class="math notranslate nohighlight">\(t-1\)</span>.</p></li>
<li><p>an investment <em>accelerator</em> asserting that investment at time
<span class="math notranslate nohighlight">\(t\)</span> equals a constant called the <em>accelerator coefficient</em>
times the difference in output between period <span class="math notranslate nohighlight">\(t-1\)</span> and
<span class="math notranslate nohighlight">\(t-2\)</span>.</p></li>
</ul>
<p>Consumption plus investment plus government purchases
constitute <em>aggregate demand,</em> which automatically calls forth an
equal amount of <em>aggregate supply</em>.</p>
<p>(To read about linear difference equations see <a class="reference external" href="https://en.wikipedia.org/wiki/Linear_difference_equation">here</a> or chapter IX of <span id="id2">[<a class="reference internal" href="zreferences.html#id224" title="Thomas J Sargent. Macroeconomic Theory. Academic Press, New York, 2nd edition, 1987.">Sargent, 1987</a>]</span>.)</p>
<p>Samuelson used the model to analyze how particular values of the
marginal propensity to consume and the accelerator coefficient might
give rise to transient <strong>business cycles</strong> in national output.</p>
<p>Possible dynamic properties include</p>
<ul class="simple">
<li><p>smooth convergence to a constant level of output</p></li>
<li><p>damped business cycles that eventually converge to a constant level
of output</p></li>
<li><p>persistent business cycles that neither dampen nor explode</p></li>
</ul>
<p>Later we present an extension that
adds a random shock to the right side of the national income
identity representing random fluctuations in aggregate demand.</p>
<p>This modification makes national output become governed by a second-order
<strong>stochastic linear difference equation</strong> that, with appropriate parameter values,
gives rise to recurrent irregular business cycles.</p>
<p>(To read about stochastic linear difference equations see chapter XI of
<span id="id3">[<a class="reference internal" href="zreferences.html#id224" title="Thomas J Sargent. Macroeconomic Theory. Academic Press, New York, 2nd edition, 1987.">Sargent, 1987</a>]</span>.)</p>
</section>
</section>
<section id="details">
<h2><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">37.2. </span>Details</a><a class="headerlink" href="#details" title="Link to this heading">#</a></h2>
<p>Let’s assume that</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\{G_t\}\)</span> is a sequence of levels of government expenditures –
we’ll start by setting <span class="math notranslate nohighlight">\(G_t = G\)</span> for all <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\{C_t\}\)</span> is a sequence of levels of aggregate consumption
expenditures, a key endogenous variable in the model.</p></li>
<li><p><span class="math notranslate nohighlight">\(\{I_t\}\)</span> is a sequence of rates of investment, another key
endogenous variable.</p></li>
<li><p><span class="math notranslate nohighlight">\(\{Y_t\}\)</span> is a sequence of levels of national income, yet
another endogenous variable.</p></li>
</ul>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the marginal propensity to consume in the Keynesian
consumption function <span class="math notranslate nohighlight">\(C_t = \alpha Y_{t-1} + \gamma\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> is the “accelerator coefficient” in the “investment
accelerator” <span class="math notranslate nohighlight">\(I_t = \beta (Y_{t-1} - Y_{t-2})\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\{\epsilon_{t}\}\)</span> is an IID sequence standard normal random variables.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma \geq 0\)</span> is a “volatility”
parameter — setting <span class="math notranslate nohighlight">\(\sigma = 0\)</span> recovers the non-stochastic case
that we’ll start with.</p></li>
</ul>
<p>The model combines the consumption function</p>
<div class="math notranslate nohighlight" id="equation-consumption">
<span class="eqno">(37.1)<a class="headerlink" href="#equation-consumption" title="Link to this equation">#</a></span>\[C_t = \alpha Y_{t-1} + \gamma\]</div>
<p>with the investment accelerator</p>
<div class="math notranslate nohighlight" id="equation-accelerator">
<span class="eqno">(37.2)<a class="headerlink" href="#equation-accelerator" title="Link to this equation">#</a></span>\[I_t = \beta (Y_{t-1} - Y_{t-2})\]</div>
<p>and the national income identity</p>
<div class="math notranslate nohighlight" id="equation-income-identity">
<span class="eqno">(37.3)<a class="headerlink" href="#equation-income-identity" title="Link to this equation">#</a></span>\[Y_t = C_t + I_t + G_t\]</div>
<ul class="simple">
<li><p>The parameter <span class="math notranslate nohighlight">\(\alpha\)</span> is peoples’ <strong>marginal propensity to consume</strong>
out of income - equation <a class="reference internal" href="#equation-consumption">(37.1)</a> asserts that people consume a fraction of
<span class="math notranslate nohighlight">\(\alpha \in (0,1)\)</span> of each additional dollar of income.</p></li>
<li><p>The parameter <span class="math notranslate nohighlight">\(\beta &gt; 0\)</span> is the investment accelerator coefficient - equation
<a class="reference internal" href="#equation-accelerator">(37.2)</a> asserts that people invest in physical capital when
income is increasing and disinvest when it is decreasing.</p></li>
</ul>
<p>Equations <a class="reference internal" href="#equation-consumption">(37.1)</a>, <a class="reference internal" href="#equation-accelerator">(37.2)</a>, and <a class="reference internal" href="#equation-income-identity">(37.3)</a>
imply the following second-order linear difference equation for national income:</p>
<div class="math notranslate nohighlight">
\[
Y_t = (\alpha+\beta) Y_{t-1} - \beta Y_{t-2} + (\gamma + G_t)
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-second-order">
<span class="eqno">(37.4)<a class="headerlink" href="#equation-second-order" title="Link to this equation">#</a></span>\[Y_t = \rho_1 Y_{t-1} + \rho_2 Y_{t-2} + (\gamma + G_t)\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_1 = (\alpha+\beta)\)</span> and <span class="math notranslate nohighlight">\(\rho_2 = -\beta\)</span>.</p>
<p>To complete the model, we require two <em>initial conditions</em>.</p>
<p>If the model is to generate time series for <span class="math notranslate nohighlight">\(t=0, \ldots, T\)</span>, we
require initial values</p>
<div class="math notranslate nohighlight">
\[
Y_{-1} = \bar Y_{-1}, \quad  Y_{-2} = \bar Y_{-2}
\]</div>
<p>We’ll ordinarily set the parameters <span class="math notranslate nohighlight">\((\alpha,\beta)\)</span> so that starting from
an arbitrary pair of initial conditions
<span class="math notranslate nohighlight">\((\bar Y_{-1}, \bar Y_{-2})\)</span>, national income <span class="math notranslate nohighlight">\(Y_t\)</span> converges to
a constant value as <span class="math notranslate nohighlight">\(t\)</span> becomes large.</p>
<p>We are interested in studying</p>
<ul class="simple">
<li><p>the transient fluctuations in <span class="math notranslate nohighlight">\(Y_t\)</span> as it converges to its
<strong>steady state</strong> level</p></li>
<li><p>the <em>rate</em> at which it converges to a steady state level</p></li>
</ul>
<p>The deterministic version of the model described so far — meaning that
no random shocks hit aggregate demand — has only transient fluctuations.</p>
<p>We can convert the model to one that has persistent irregular
fluctuations by adding a random shock to aggregate demand.</p>
<section id="stochastic-version-of-the-model">
<h3><span class="section-number">37.2.1. </span>Stochastic version of the model<a class="headerlink" href="#stochastic-version-of-the-model" title="Link to this heading">#</a></h3>
<p>We create a <em>random</em> or <em>stochastic</em> version of the model by adding
a random process of <em>shocks</em> or <em>disturbances</em>
<span class="math notranslate nohighlight">\(\{\sigma \epsilon_t \}\)</span> to the right side of equation <a class="reference internal" href="#equation-second-order">(37.4)</a>,
leading to the <em>second-order scalar linear stochastic difference equation</em>:</p>
<div class="math notranslate nohighlight" id="equation-second-stochastic">
<span class="eqno">(37.5)<a class="headerlink" href="#equation-second-stochastic" title="Link to this equation">#</a></span>\[Y_t = (\alpha+\beta) Y_{t-1} - \beta Y_{t-2} + (\gamma + G_t) + \sigma \epsilon_t\]</div>
</section>
<section id="mathematical-analysis-of-the-model">
<h3><span class="section-number">37.2.2. </span>Mathematical analysis of the model<a class="headerlink" href="#mathematical-analysis-of-the-model" title="Link to this heading">#</a></h3>
<p>To get started, let’s set <span class="math notranslate nohighlight">\(G_t \equiv 0\)</span>, <span class="math notranslate nohighlight">\(\sigma = 0\)</span>, and
<span class="math notranslate nohighlight">\(\gamma = 0\)</span>.</p>
<p>Then we can write equation <a class="reference internal" href="#equation-second-stochastic">(37.5)</a> as</p>
<div class="math notranslate nohighlight">
\[
Y_t = \rho_1 Y_{t-1} + \rho_2 Y_{t-2}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-second-stochastic2">
<span class="eqno">(37.6)<a class="headerlink" href="#equation-second-stochastic2" title="Link to this equation">#</a></span>\[Y_{t+2} - \rho_1 Y_{t+1} - \rho_2 Y_t  = 0\]</div>
<p>To discover the properties of the solution of <a class="reference internal" href="#equation-second-stochastic2">(37.6)</a>,
it is useful first to form the <strong>characteristic polynomial</strong>
for <a class="reference internal" href="#equation-second-stochastic2">(37.6)</a>:</p>
<div class="math notranslate nohighlight" id="equation-polynomial">
<span class="eqno">(37.7)<a class="headerlink" href="#equation-polynomial" title="Link to this equation">#</a></span>\[z^2 - \rho_1 z  - \rho_2\]</div>
<p>where <span class="math notranslate nohighlight">\(z\)</span> is possibly a complex number.</p>
<p>We want to find the two <strong>zeros</strong> (a.k.a. <strong>roots</strong>) – namely
<span class="math notranslate nohighlight">\(\lambda_1, \lambda_2\)</span> – of the characteristic polynomial.</p>
<p>These are two special values of <span class="math notranslate nohighlight">\(z\)</span>, say <span class="math notranslate nohighlight">\(z= \lambda_1\)</span> and
<span class="math notranslate nohighlight">\(z= \lambda_2\)</span>, such that if we set <span class="math notranslate nohighlight">\(z\)</span> equal to one of
these values in expression <a class="reference internal" href="#equation-polynomial">(37.7)</a>,
the characteristic polynomial <a class="reference internal" href="#equation-polynomial">(37.7)</a> equals zero:</p>
<div class="math notranslate nohighlight" id="equation-polynomial-sol">
<span class="eqno">(37.8)<a class="headerlink" href="#equation-polynomial-sol" title="Link to this equation">#</a></span>\[z^2 - \rho_1 z  - \rho_2  = (z- \lambda_1 ) (z -\lambda_2) = 0\]</div>
<p>Equation <a class="reference internal" href="#equation-polynomial-sol">(37.8)</a> is said to <em>factor</em> the characteristic polynomial.</p>
<p>When the roots are complex, they will occur as a complex conjugate pair.</p>
<p>When the roots are complex, it is convenient to represent them in the
polar form</p>
<div class="math notranslate nohighlight">
\[
\lambda_1 =  r e^{i \omega}, \  \lambda_2 = r e^{-i \omega}
\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the <em>amplitude</em> of the complex number and
<span class="math notranslate nohighlight">\(\omega\)</span> is its <em>angle</em> or <em>phase</em>.</p>
<p>These can also be represented as</p>
<div class="math notranslate nohighlight">
\[
\lambda_1 = r (cos (\omega) + i \sin (\omega))
\]</div>
<div class="math notranslate nohighlight">
\[
\lambda_2 = r (cos (\omega) - i \sin(\omega))
\]</div>
<p>(To read about the polar form, see
<a class="reference external" href="https://www.khanacademy.org/math/precalculus/x9e81a4f98389efdf:complex/x9e81a4f98389efdf:complex-mul-div-polar/a/complex-number-polar-form-review">here</a>)</p>
<p>Given <em>initial conditions</em> <span class="math notranslate nohighlight">\(Y_{-1}, Y_{-2}\)</span>, we want to generate
a <em>solution</em> of the difference equation <a class="reference internal" href="#equation-second-stochastic2">(37.6)</a>.</p>
<p>It can be represented as</p>
<div class="math notranslate nohighlight">
\[
Y_t = \lambda_1^t c_1 + \lambda_2^t c_2
\]</div>
<p>where <span class="math notranslate nohighlight">\(c_1\)</span> and <span class="math notranslate nohighlight">\(c_2\)</span> are constants that depend on the two
initial conditions and on <span class="math notranslate nohighlight">\(\rho_1, \rho_2\)</span>.</p>
<p>When the roots are complex, it is useful to pursue the following calculations.</p>
<p>Notice that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
  Y_t &amp; =   c_1 (r e^{i \omega})^t + c_2 (r e^{-i \omega})^t  \\
   &amp; = c_1 r^t e^{i\omega t} + c_2 r^t e^{-i \omega t} \\
   &amp; =  c_1 r^t [\cos(\omega t) + i \sin(\omega t) ] + c_2 r^t [\cos(\omega t) - i \sin(\omega t) ] \\
   &amp; = (c_1 + c_2) r^t \cos(\omega t) + i (c_1 - c_2) r^t \sin(\omega t)
 \end{aligned}
\end{split}\]</div>
<p>The only way that <span class="math notranslate nohighlight">\(Y_t\)</span> can be a  real number for each <span class="math notranslate nohighlight">\(t\)</span> is if <span class="math notranslate nohighlight">\(c_1 + c_2\)</span> is a real number and <span class="math notranslate nohighlight">\(c_1 - c_2\)</span> is an imaginary number.</p>
<p>This happens only when <span class="math notranslate nohighlight">\(c_1\)</span> and <span class="math notranslate nohighlight">\(c_2\)</span> are complex conjugates, in which case they can be written in the polar forms</p>
<div class="math notranslate nohighlight">
\[
c_1 = v e^{i \theta},  \  \ c_2 = v e^{- i \theta}
\]</div>
<p>So we can write</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
  Y_t &amp; = &amp; v e^{i \theta} r^t e^{i \omega t} + v e ^{- i \theta} r^t e^{-i \omega t} \\
      &amp; = &amp; v r^t [ e^{i(\omega t + \theta)} + e^{-i (\omega t +\theta)}]  \\
      &amp; = &amp; 2 v r^t  \cos (\omega t + \theta)
 \end{aligned}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span> are constants that must be chosen to satisfy initial conditions for <span class="math notranslate nohighlight">\(Y_{-1}, Y_{-2}\)</span>.</p>
<p>This formula shows that when the roots are complex, <span class="math notranslate nohighlight">\(Y_t\)</span> displays
oscillations with <em>period</em> <span class="math notranslate nohighlight">\(\check p =
\frac{2 \pi}{\omega}\)</span> and <em>damping factor</em> <span class="math notranslate nohighlight">\(r\)</span>.</p>
<p>We say that <span class="math notranslate nohighlight">\(\check p\)</span> is the <em>period</em> because in that amount of time the cosine wave <span class="math notranslate nohighlight">\(\cos(\omega t + \theta)\)</span> goes through exactly one complete cycles.</p>
<p>(Draw a cosine function to convince yourself of this please)</p>
<p><em>Remark:</em> Following <span id="id4">[<a class="reference internal" href="zreferences.html#id101" title="Paul A. Samuelson. Interactions between the multiplier analysis and the principle of acceleration. Review of Economic Studies, 21(2):75–78, 1939.">Samuelson, 1939</a>]</span>, we want to choose the parameters
<span class="math notranslate nohighlight">\(\alpha, \beta\)</span> of the model so that the absolute values (of the possibly
complex) roots <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2\)</span> of the characteristic
polynomial are both strictly less than one:</p>
<div class="math notranslate nohighlight">
\[
| \lambda_j | &lt; 1 \quad \quad \text{for } j = 1, 2
\]</div>
<p><em>Remark:</em> When both roots  <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2\)</span> of the characteristic polynomial have
absolute values strictly less than one, the absolute value of the larger
one governs the rate of convergence to the steady state of the non
stochastic version of the model.</p>
</section>
<section id="things-this-lecture-does">
<h3><span class="section-number">37.2.3. </span>Things this lecture does<a class="headerlink" href="#things-this-lecture-does" title="Link to this heading">#</a></h3>
<p>We write a function to generate simulations of a <span class="math notranslate nohighlight">\(\{Y_t\}\)</span> sequence as a function of time.</p>
<p>The function requires that we put in initial conditions for <span class="math notranslate nohighlight">\(Y_{-1}, Y_{-2}\)</span>.</p>
<p>The function checks that <span class="math notranslate nohighlight">\(\alpha, \beta\)</span> are set so that <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2\)</span> are less than
unity in absolute value (also called “modulus”).</p>
<p>The function also tells us whether the roots are complex, and, if they are complex, returns both their real and complex parts.</p>
<p>If the roots are both real, the function returns their values.</p>
<p>We use our function written to simulate paths that are stochastic (when <span class="math notranslate nohighlight">\(\sigma &gt;0\)</span>).</p>
<p>We have written the function in a way that allows us to input <span class="math notranslate nohighlight">\(\{G_t\}\)</span> paths of a few simple forms, e.g.,</p>
<ul class="simple">
<li><p>one time jumps in <span class="math notranslate nohighlight">\(G\)</span> at some time</p></li>
<li><p>a permanent jump in <span class="math notranslate nohighlight">\(G\)</span> that occurs at some time</p></li>
</ul>
<p>We proceed to use the Samuelson multiplier-accelerator model as a laboratory to make a simple OOP example.</p>
<p>The “state” that determines next period’s <span class="math notranslate nohighlight">\(Y_{t+1}\)</span> is now not just the current value <span class="math notranslate nohighlight">\(Y_t\)</span> but also the once lagged value <span class="math notranslate nohighlight">\(Y_{t-1}\)</span>.</p>
<p>This involves a little more bookkeeping than is required in the Solow model class definition.</p>
<p>We use the Samuelson multiplier-accelerator model as a vehicle for teaching how we can gradually add more features to the class.</p>
<p>We want to have a method in the class that automatically generates a simulation, either non-stochastic (<span class="math notranslate nohighlight">\(\sigma=0\)</span>) or stochastic (<span class="math notranslate nohighlight">\(\sigma &gt; 0\)</span>).</p>
<p>We also show how to map the Samuelson model into a simple instance of the <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> class described <a class="reference external" href="https://python.quantecon.org/linear_models.html">here</a>.</p>
<p>We can use a <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> instance to do various things that we did above with our homemade function and class.</p>
<p>Among other things, we show by example that the eigenvalues of the matrix <span class="math notranslate nohighlight">\(A\)</span> that we use to form the instance of the <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> class for the Samuelson model equal the roots of the characteristic polynomial <a class="reference internal" href="#equation-polynomial">(37.7)</a> for the Samuelson multiplier accelerator model.</p>
<p>Here is the formula for the matrix <span class="math notranslate nohighlight">\(A\)</span> in the linear state space system in the case that government expenditures are a constant <span class="math notranslate nohighlight">\(G\)</span>:</p>
<div class="math notranslate nohighlight">
\[
A = \begin{bmatrix} 1 &amp; 0 &amp; 0 \cr
                      \gamma + G &amp; \rho_1 &amp; \rho_2 \cr
                      0 &amp; 1 &amp; 0 \end{bmatrix}
\]</div>
</section>
</section>
<section id="implementation">
<h2><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">37.3. </span>Implementation</a><a class="headerlink" href="#implementation" title="Link to this heading">#</a></h2>
<p>We’ll start by drawing an informative graph from page 189 of <span id="id5">[<a class="reference internal" href="zreferences.html#id224" title="Thomas J Sargent. Macroeconomic Theory. Academic Press, New York, 2nd edition, 1987.">Sargent, 1987</a>]</span></p>
<div class="cell tag_hide-input tag_output_scroll docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">param_plot</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function creates the graph on page 189 of</span>
<span class="sd">    Sargent Macroeconomic Theory, second edition, 1987.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

    <span class="c1"># Set axis</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span>
    <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="n">xmin</span><span class="p">,</span> <span class="o">-</span><span class="n">ymin</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>

    <span class="c1"># Set axis labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\rho_2$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\rho_1$&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="c1"># Draw (t1, t2) points</span>
    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">ρ1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">ρ1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

    <span class="c1"># Turn normal axes off</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Add arrows to represent axes</span>
    <span class="n">axes_arrows</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;arrowstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;|-|&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;lw&quot;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">}</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">axes_arrows</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymin</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">axes_arrows</span><span class="p">)</span>

    <span class="c1"># Annotate the plot with equations</span>
    <span class="n">plot_arrowsl</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;arrowstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;-|&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;connectionstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;arc3, rad=-0.2&quot;</span><span class="p">}</span>
    <span class="n">plot_arrowsr</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;arrowstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;-|&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;connectionstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;arc3, rad=0.2&quot;</span><span class="p">}</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;$\rho_1 + \rho_2 &lt; 1$&quot;</span><span class="p">,</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsr</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;$\rho_1 + \rho_2 = 1$&quot;</span><span class="p">,</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
        <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsr</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;$\rho_2 &lt; 1 + \rho_1$&quot;</span><span class="p">,</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsl</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;$\rho_2 = 1 + \rho_1$&quot;</span><span class="p">,</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
        <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsl</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;$\rho_2 = -1$&quot;</span><span class="p">,</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3</span><span class="p">),</span>
        <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsl</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;${\rho_1}^2 + 4\rho_2 = 0$&quot;</span><span class="p">,</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35</span><span class="p">),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">),</span>
        <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsr</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;${\rho_1}^2 + 4\rho_2 &lt; 0$&quot;</span><span class="p">,</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">1.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">),</span>
        <span class="n">arrowprops</span><span class="o">=</span><span class="n">plot_arrowsr</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;12&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Label categories of solutions</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Explosive</span><span class="se">\n</span><span class="s2"> growth&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Explosive</span><span class="se">\n</span><span class="s2"> oscillations&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="s2">&quot;Explosive oscillations&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.09</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;Damped oscillations&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="c1"># Add small marker to y-axis</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.005</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">0.495</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">0.505</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.12</span><span class="p">,</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>


<span class="n">param_plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/355894d8e252977dbae734205018e303e90e1b3ea7ded334ee064e09c58e8c44.png" src="_images/355894d8e252977dbae734205018e303e90e1b3ea7ded334ee064e09c58e8c44.png" />
</div>
</div>
<p>The graph portrays regions in which the <span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span>
root pairs implied by the <span class="math notranslate nohighlight">\((\rho_1 = (\alpha+\beta), \rho_2 = - \beta)\)</span>
difference equation parameter pairs in the Samuelson model are such that:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span> are complex with modulus less than
<span class="math notranslate nohighlight">\(1\)</span> - in this case, the <span class="math notranslate nohighlight">\(\{Y_t\}\)</span> sequence displays damped
oscillations.</p></li>
<li><p><span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span> are both real, but one is strictly
greater than <span class="math notranslate nohighlight">\(1\)</span> - this leads to explosive growth.</p></li>
<li><p><span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span> are both real, but one is strictly
less than <span class="math notranslate nohighlight">\(-1\)</span> - this leads to explosive oscillations.</p></li>
<li><p><span class="math notranslate nohighlight">\((\lambda_1, \lambda_2)\)</span> are both real and both are less than
<span class="math notranslate nohighlight">\(1\)</span> in absolute value - in this case, there is smooth
convergence to the steady state without damped cycles.</p></li>
</ul>
<p>Later we’ll present the graph with a red mark showing the particular
point implied by the setting of <span class="math notranslate nohighlight">\((\alpha,\beta)\)</span>.</p>
<section id="function-to-describe-implications-of-characteristic-polynomial">
<h3><span class="section-number">37.3.1. </span>Function to describe implications of characteristic polynomial<a class="headerlink" href="#function-to-describe-implications-of-characteristic-polynomial" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">categorize_solution</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes values of ρ1 and ρ2 and uses them</span>
<span class="sd">    to classify the type of solution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">discriminant</span> <span class="o">=</span> <span class="n">ρ1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ρ2</span>
    <span class="k">if</span> <span class="n">ρ2</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ρ1</span> <span class="ow">or</span> <span class="n">ρ2</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Explosive oscillations&quot;</span>
    <span class="k">elif</span> <span class="n">ρ1</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Explosive growth&quot;</span>
    <span class="k">elif</span> <span class="n">discriminant</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Damped oscillations&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Steady state convergence&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">analyze_roots</span><span class="p">(</span><span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unified function to calculate roots and analyze their properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
    <span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>
    
    <span class="c1"># Compute characteristic polynomial roots</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ2</span><span class="p">])</span>
    
    <span class="c1"># Classify solution type</span>
    <span class="n">solution_type</span> <span class="o">=</span> <span class="n">categorize_solution</span><span class="p">(</span><span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">)</span>
    
    <span class="c1"># Determine root properties</span>
    <span class="n">is_complex</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">)</span>
    <span class="n">is_stable</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ρ1 = </span><span class="si">{</span><span class="n">ρ1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, ρ2 = </span><span class="si">{</span><span class="n">ρ2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Roots: </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">root</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">roots</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root type: </span><span class="si">{</span><span class="s1">&#39;Complex&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_complex</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Real&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stability: </span><span class="si">{</span><span class="s1">&#39;Stable&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_stable</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Unstable&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution type: </span><span class="si">{</span><span class="n">solution_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;roots&#39;</span><span class="p">:</span> <span class="n">roots</span><span class="p">,</span>
        <span class="s1">&#39;rho1&#39;</span><span class="p">:</span> <span class="n">ρ1</span><span class="p">,</span>
        <span class="s1">&#39;rho2&#39;</span><span class="p">:</span> <span class="n">ρ2</span><span class="p">,</span>
        <span class="s1">&#39;is_complex&#39;</span><span class="p">:</span> <span class="n">is_complex</span><span class="p">,</span>
        <span class="s1">&#39;is_stable&#39;</span><span class="p">:</span> <span class="n">is_stable</span><span class="p">,</span>
        <span class="s1">&#39;solution_type&#39;</span><span class="p">:</span> <span class="n">solution_type</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>We also write a unified simulation function that can handle both
non-stochastic and stochastic versions of the model.</p>
<p>It allows for government spending paths of a few simple forms which
we specify via a dictionary <code class="docutils literal notranslate"><span class="pre">g_params</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">simulate_samuelson</span><span class="p">(</span>
    <span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">g_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Unified simulation function for Samuelson model.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    g_params: dict with keys &#39;g&#39;, &#39;g_t&#39;, &#39;duration&#39; for government spending</span>
<span class="sd">    seed: random seed for reproducible results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">analysis</span> <span class="o">=</span> <span class="n">analyze_roots</span><span class="p">(</span><span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;rho1&#39;</span><span class="p">],</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;rho2&#39;</span><span class="p">]</span>
    
    <span class="c1"># Initialize time series</span>
    <span class="n">y_t</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">]</span>
    
    <span class="c1"># Generate shocks if stochastic</span>
    <span class="k">if</span> <span class="n">σ</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">ϵ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    
    <span class="c1"># Simulate forward</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>

        <span class="c1"># Determine government spending</span>
        <span class="n">g</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">g_params</span><span class="p">:</span>
            <span class="n">g_val</span><span class="p">,</span> <span class="n">g_t_val</span> <span class="o">=</span> <span class="n">g_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">g_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;g_t&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">g_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;duration&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">duration</span> <span class="o">==</span> <span class="s1">&#39;permanent&#39;</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="n">g_t_val</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">g_val</span>
            <span class="k">elif</span> <span class="n">duration</span> <span class="o">==</span> <span class="s1">&#39;one-off&#39;</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">==</span> <span class="n">g_t_val</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">g_val</span>
            <span class="k">elif</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">g_val</span>
        
        <span class="c1"># Calculate next value</span>
        <span class="n">y_next</span> <span class="o">=</span> <span class="n">ρ1</span> <span class="o">*</span> <span class="n">y_t</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">*</span> <span class="n">y_t</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">γ</span> <span class="o">+</span> <span class="n">g</span>
        <span class="k">if</span> <span class="n">σ</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y_next</span> <span class="o">+=</span> <span class="n">σ</span> <span class="o">*</span> <span class="n">ϵ</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        
        <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_next</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">y_t</span><span class="p">,</span> <span class="n">analysis</span>
</pre></div>
</div>
</div>
</div>
<p>We will use this function to run simulations of the model.</p>
<p>But before doing that, let’s test the analysis function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <span class="n">analyze_roots</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ρ1 = 1.70, ρ2 = -0.40
Roots: [&#39;1.42&#39;, &#39;0.28&#39;]
Root type: Real
Stability: Unstable
Solution type: Explosive growth
</pre></div>
</div>
</div>
</div>
</section>
<section id="function-for-plotting-paths">
<h3><span class="section-number">37.3.2. </span>Function for plotting paths<a class="headerlink" href="#function-for-plotting-paths" title="Link to this heading">#</a></h3>
<p>A useful function for our work below is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_y</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Function plots path of Y_t&quot;&quot;&quot;</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$t$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$Y_t$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="manual-or-by-hand-root-calculations">
<h3><span class="section-number">37.3.3. </span>Manual or “by hand” root calculations<a class="headerlink" href="#manual-or-by-hand-root-calculations" title="Link to this heading">#</a></h3>
<p>The following function calculates roots of the characteristic polynomial
using high school algebra.</p>
<p>(We’ll calculate the roots in other ways later using <code class="docutils literal notranslate"><span class="pre">analyze_roots</span></code>.)</p>
<p>The function also plots a <span class="math notranslate nohighlight">\(Y_t\)</span> starting from initial conditions
that we set</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">y_nonstochastic</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">0.92</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function calculates the roots of the characteristic polynomial</span>
<span class="sd">    by hand and returns a path of y_t starting from initial conditions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
    <span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ρ_1 is </span><span class="si">{</span><span class="n">ρ1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ρ_2 is </span><span class="si">{</span><span class="n">ρ2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">discriminant</span> <span class="o">=</span> <span class="n">ρ1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ρ2</span>

    <span class="k">if</span> <span class="n">discriminant</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Single real root: &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">discriminant</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Two real roots: &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">ρ1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">discriminant</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Two complex roots: &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">real</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}{</span><span class="n">r</span><span class="o">.</span><span class="n">imag</span><span class="si">:</span><span class="s2">+.2f</span><span class="si">}</span><span class="s2">j&quot;</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Absolute values of roots are less than one&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Absolute values of roots are not less than one&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">transition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ρ1</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ρ2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">γ</span>

    <span class="n">y_t</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">y_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transition</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">y_t</span>


<span class="n">plot_y</span><span class="p">(</span><span class="n">y_nonstochastic</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ρ_1 is 1.42
ρ_2 is -0.50
Two real roots: 
-0.65 -0.77
Absolute values of roots are less than one
</pre></div>
</div>
<img alt="_images/94d3cb72d4d679994d2ecf2692d7b7c64d1eab5f14e2f9f6a0efb48f565ebba6.png" src="_images/94d3cb72d4d679994d2ecf2692d7b7c64d1eab5f14e2f9f6a0efb48f565ebba6.png" />
</div>
</div>
</section>
<section id="reverse-engineering-parameters-to-generate-damped-cycles">
<h3><span class="section-number">37.3.4. </span>Reverse-engineering parameters to generate damped cycles<a class="headerlink" href="#reverse-engineering-parameters-to-generate-damped-cycles" title="Link to this heading">#</a></h3>
<p>The next cell writes code that takes as inputs the modulus <span class="math notranslate nohighlight">\(r\)</span> and
phase <span class="math notranslate nohighlight">\(\phi\)</span> of a conjugate pair of complex numbers in polar form</p>
<div class="math notranslate nohighlight">
\[
\lambda_1 = r \exp(i \phi), \quad \lambda_2 = r \exp(- i \phi)
\]</div>
<ul class="simple">
<li><p>The code assumes that these two complex numbers are the roots of the
characteristic polynomial</p></li>
<li><p>It then reverse-engineers <span class="math notranslate nohighlight">\((\alpha,\beta)\)</span> and <span class="math notranslate nohighlight">\((\rho_1, \rho_2)\)</span>,
pairs that would generate those roots</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes modulus r and angle ϕ of complex number r exp(j ϕ)</span>
<span class="sd">    and creates ρ1 and ρ2 of characteristic polynomial for which</span>
<span class="sd">    r exp(j ϕ) and r exp(- j ϕ) are complex roots.</span>

<span class="sd">    Returns the multiplier coefficient $\alpha$</span>
<span class="sd">    and the accelerator coefficient $\beta$</span>
<span class="sd">    that verifies those roots.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create complex conjugate pair from polar coordinates</span>
    <span class="n">g1</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">)</span>
    <span class="n">g2</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">-</span><span class="n">ϕ</span><span class="p">)</span>

    <span class="c1"># Calculate corresponding ρ1, ρ2 parameters</span>
    <span class="n">ρ1</span> <span class="o">=</span> <span class="n">g1</span> <span class="o">+</span> <span class="n">g2</span>
    <span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">g1</span> <span class="o">*</span> <span class="n">g2</span>

    <span class="c1"># Derive α and β coefficients from ρ parameters</span>
    <span class="n">β</span> <span class="o">=</span> <span class="o">-</span><span class="n">ρ2</span>
    <span class="n">α</span> <span class="o">=</span> <span class="n">ρ1</span> <span class="o">-</span> <span class="n">β</span>
    <span class="k">return</span> <span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s use the function in an example.</p>
<p>Here are the example parameters</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="c1"># Cycle period in time units</span>
<span class="n">period</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">period</span>

<span class="c1"># Apply the reverse-engineering function</span>
<span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;α, β = </span><span class="si">{</span><span class="n">α</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">β</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ρ1, ρ2 = </span><span class="si">{</span><span class="n">ρ1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ρ2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>α, β = 0.63+0.00j, 0.90-0.00j
ρ1, ρ2 = 1.54+0.00j, -0.90+0.00j
</pre></div>
</div>
</div>
</div>
<p>The real parts of the roots are</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ρ1 = </span><span class="si">{</span><span class="n">ρ1</span><span class="o">.</span><span class="n">real</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, ρ2 = </span><span class="si">{</span><span class="n">ρ2</span><span class="o">.</span><span class="n">real</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ρ1 = 1.54, ρ2 = -0.90
</pre></div>
</div>
</div>
</div>
</section>
<section id="root-finding-using-numpy">
<h3><span class="section-number">37.3.5. </span>Root finding using numpy<a class="headerlink" href="#root-finding-using-numpy" title="Link to this heading">#</a></h3>
<p>Here we’ll use numpy to compute the roots of the characteristic
polynomial</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ1</span><span class="p">,</span> <span class="o">-</span><span class="n">ρ2</span><span class="p">])</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">cmath</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;r, ϕ = </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ϕ</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p1, p2 = (</span><span class="si">{</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">), (</span><span class="si">{</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;α, β = </span><span class="si">{</span><span class="n">α</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">β</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ρ1, ρ2 = </span><span class="si">{</span><span class="n">ρ1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ρ2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>r, ϕ = 0.95, 0.63
p1, p2 = (0.95, 0.63), (0.95, -0.63)
α, β = 0.63+0.00j, 0.90-0.00j
ρ1, ρ2 = 1.54+0.00j, -0.90+0.00j
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">y_nonstochastic</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function enlists numpy to calculate the roots of the characteristic</span>
<span class="sd">    polynomial.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">y_series</span><span class="p">,</span> <span class="n">analysis</span> <span class="o">=</span> <span class="n">simulate_samuelson</span><span class="p">(</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">γ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution type: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;solution_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Roots are </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;roots&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root type: </span><span class="si">{</span><span class="s1">&#39;Complex&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;is_complex&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Real&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stability: </span><span class="si">{</span><span class="s1">&#39;Stable&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;is_stable&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Unstable&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">y_series</span>


<span class="n">plot_y</span><span class="p">(</span><span class="n">y_nonstochastic</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solution type: Damped oscillations
Roots are [0.85+0.27838822j 0.85-0.27838822j]
Root type: Complex
Stability: Stable
</pre></div>
</div>
<img alt="_images/fe858c2f5a001ada4238c4ac3730b3d8a8e0523621d23cf3d4c2a4d9affb2615.png" src="_images/fe858c2f5a001ada4238c4ac3730b3d8a8e0523621d23cf3d4c2a4d9affb2615.png" />
</div>
</div>
</section>
<section id="reverse-engineered-complex-roots-example">
<h3><span class="section-number">37.3.6. </span>Reverse-engineered complex roots: Example<a class="headerlink" href="#reverse-engineered-complex-roots-example" title="Link to this heading">#</a></h3>
<p>The next cell studies the implications of reverse-engineered complex
roots.</p>
<p>We’ll generate an <em>undamped</em> cycle of period 10</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Generates undamped, nonexplosive cycles</span>

<span class="n">period</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Length of cycle in units of time</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">period</span>

<span class="c1"># Apply the reverse-engineering function f</span>
<span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">)</span>

<span class="c1"># Extract real parts for numerical computation</span>
<span class="n">α</span> <span class="o">=</span> <span class="n">α</span><span class="o">.</span><span class="n">real</span>
<span class="n">β</span> <span class="o">=</span> <span class="n">β</span><span class="o">.</span><span class="n">real</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;α, β = </span><span class="si">{</span><span class="n">α</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">β</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ytemp</span> <span class="o">=</span> <span class="n">y_nonstochastic</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="n">β</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plot_y</span><span class="p">(</span><span class="n">ytemp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>α, β = 0.62, 1.00
Solution type: Damped oscillations
Roots are [0.80901699+0.58778525j 0.80901699-0.58778525j]
Root type: Complex
Stability: Stable
</pre></div>
</div>
<img alt="_images/263aa8279a9fd5bdb0a04071d7a35a9f886139694790813045ce74ae6dd516b3.png" src="_images/263aa8279a9fd5bdb0a04071d7a35a9f886139694790813045ce74ae6dd516b3.png" />
</div>
</div>
</section>
<section id="digression-using-sympy-to-find-roots">
<h3><span class="section-number">37.3.7. </span>Digression: Using Sympy to find roots<a class="headerlink" href="#digression-using-sympy-to-find-roots" title="Link to this heading">#</a></h3>
<p>We can also use sympy to compute analytic formulas for the roots</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_printing</span><span class="p">()</span>

<span class="n">r1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;ρ_1&quot;</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;ρ_2&quot;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>

<span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">z</span> <span class="o">-</span> <span class="n">r2</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/438c7b743d3bfbef1c947e4e012886f8cff48c462a5496413b74698f0b1171a2.png" src="_images/438c7b743d3bfbef1c947e4e012886f8cff48c462a5496413b74698f0b1171a2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">α</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;α&quot;</span><span class="p">)</span>
<span class="n">β</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;β&quot;</span><span class="p">)</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
<span class="n">r2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>

<span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">z</span> <span class="o">-</span> <span class="n">r2</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b7e66f51e6ab8ffd16fce6492f02baa7d13ac8a08e12024f67fc4bf36c61634a.png" src="_images/b7e66f51e6ab8ffd16fce6492f02baa7d13ac8a08e12024f67fc4bf36c61634a.png" />
</div>
</div>
</section>
</section>
<section id="stochastic-shocks">
<h2><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">37.4. </span>Stochastic shocks</a><a class="headerlink" href="#stochastic-shocks" title="Link to this heading">#</a></h2>
<p>Now we’ll construct some code to simulate the stochastic version of the
model that emerges when we add a random shock process to aggregate
demand</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">y_stochastic</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function takes parameters of a stochastic version of</span>
<span class="sd">    the model, analyzes the roots of the characteristic</span>
<span class="sd">    polynomial and generates a simulation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">y_series</span><span class="p">,</span> <span class="n">analysis</span> <span class="o">=</span> <span class="n">simulate_samuelson</span><span class="p">(</span><span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">γ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution type: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;solution_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Roots are </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">root</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;roots&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root type: </span><span class="si">{</span><span class="s1">&#39;Complex&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;is_complex&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Real&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stability: </span><span class="si">{</span><span class="s1">&#39;Stable&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;is_stable&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Unstable&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">y_series</span>


<span class="n">plot_y</span><span class="p">(</span><span class="n">y_stochastic</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solution type: Steady state convergence
Roots are [&#39;0.72&#39;, &#39;0.28&#39;]
Root type: Real
Stability: Stable
</pre></div>
</div>
<img alt="_images/5cb61733d935d498913662be868f9c1d2c59734ea6e0e80b3232c7767ac4f19f.png" src="_images/5cb61733d935d498913662be868f9c1d2c59734ea6e0e80b3232c7767ac4f19f.png" />
</div>
</div>
<p>Let’s do a simulation in which there are shocks and the characteristic
polynomial has complex roots</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="mf">0.97</span>

<span class="n">period</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Length of cycle in units of time</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">period</span>

<span class="c1"># Apply the reverse-engineering function f</span>
<span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">)</span>

<span class="c1"># Extract real parts for numerical computation</span>
<span class="n">α</span> <span class="o">=</span> <span class="n">α</span><span class="o">.</span><span class="n">real</span>
<span class="n">β</span> <span class="o">=</span> <span class="n">β</span><span class="o">.</span><span class="n">real</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;α, β = </span><span class="si">{</span><span class="n">α</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">β</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plot_y</span><span class="p">(</span><span class="n">y_stochastic</span><span class="p">(</span><span class="n">y_0</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="n">β</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>α, β = 0.63, 0.94
Solution type: Damped oscillations
Roots are [&#39;0.78+0.57j&#39;, &#39;0.78-0.57j&#39;]
Root type: Complex
Stability: Stable
</pre></div>
</div>
<img alt="_images/d07d39018eb3fb0c78a67c125934c01c8bb98de03f177655b4c8ff46c1b2b1e5.png" src="_images/d07d39018eb3fb0c78a67c125934c01c8bb98de03f177655b4c8ff46c1b2b1e5.png" />
</div>
</div>
</section>
<section id="government-spending">
<h2><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">37.5. </span>Government spending</a><a class="headerlink" href="#government-spending" title="Link to this heading">#</a></h2>
<p>This function computes a response to either a permanent or one-off increase
in government expenditures</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">y_stochastic_g</span><span class="p">(</span>
    <span class="n">y_0</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">g_t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s2">&quot;permanent&quot;</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This program computes a response to a permanent increase</span>
<span class="sd">    in government expenditures that occurs at time 20</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">g_params</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">{</span><span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="n">g</span><span class="p">,</span> <span class="s1">&#39;g_t&#39;</span><span class="p">:</span> <span class="n">g_t</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="n">duration</span><span class="p">}</span> <span class="k">if</span> <span class="n">g</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">y_series</span><span class="p">,</span> <span class="n">analysis</span> <span class="o">=</span> <span class="n">simulate_samuelson</span><span class="p">(</span>
        <span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">γ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">σ</span><span class="p">,</span> <span class="n">g_params</span><span class="p">,</span> <span class="mi">42</span>
    <span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution type: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;solution_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Roots: </span><span class="si">{</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;roots&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root type: </span><span class="si">{</span><span class="s1">&#39;Complex&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;is_complex&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Real&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stability: </span><span class="si">{</span><span class="s1">&#39;Stable&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;is_stable&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Unstable&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">y_series</span>
</pre></div>
</div>
</div>
</div>
<p>A permanent government spending shock can be simulated as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_y</span><span class="p">(</span><span class="n">y_stochastic_g</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">g_t</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s2">&quot;permanent&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solution type: Steady state convergence
Roots: [0.7236068 0.2763932]
Root type: Real
Stability: Stable
</pre></div>
</div>
<img alt="_images/e251ced37612d8524b161bb0a62768674454d04eb53518ffc2a2ffb1c23895fa.png" src="_images/e251ced37612d8524b161bb0a62768674454d04eb53518ffc2a2ffb1c23895fa.png" />
</div>
</div>
<p>We can also see the response to a one time jump in government expenditures</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_y</span><span class="p">(</span><span class="n">y_stochastic_g</span><span class="p">(</span><span class="n">g</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">g_t</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s2">&quot;one-off&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Solution type: Steady state convergence
Roots: [0.7236068 0.2763932]
Root type: Real
Stability: Stable
</pre></div>
</div>
<img alt="_images/6927c6298faac847ac6e97d59a6dff1c3f8c4422c05f556a640199847fd4330d.png" src="_images/6927c6298faac847ac6e97d59a6dff1c3f8c4422c05f556a640199847fd4330d.png" />
</div>
</div>
</section>
<section id="wrapping-everything-into-a-class">
<h2><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">37.6. </span>Wrapping everything into a class</a><a class="headerlink" href="#wrapping-everything-into-a-class" title="Link to this heading">#</a></h2>
<p>Up to now, we have written functions to do the work.</p>
<p>Now we’ll roll up our sleeves and write a Python class called <code class="docutils literal notranslate"><span class="pre">Samuelson</span></code>
for the Samuelson model</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Samuelson</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class represents the Samuelson model, otherwise known as the</span>
<span class="sd">    multiplier-accelerator model. </span>
<span class="sd">    The model combines the Keynesian multiplier</span>
<span class="sd">    with the accelerator theory of investment.</span>

<span class="sd">    The path of output is governed by a linear </span>
<span class="sd">    second-order difference equation</span>

<span class="sd">    .. math::</span>

<span class="sd">        Y_t = \alpha (1 + \beta) Y_{t-1} - \alpha \beta Y_{t-2}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_0 : scalar</span>
<span class="sd">        Initial condition for Y_0</span>
<span class="sd">    y_1 : scalar</span>
<span class="sd">        Initial condition for Y_1</span>
<span class="sd">    α : scalar</span>
<span class="sd">        Marginal propensity to consume</span>
<span class="sd">    β : scalar</span>
<span class="sd">        Accelerator coefficient</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of iterations</span>
<span class="sd">    σ : scalar</span>
<span class="sd">        Volatility parameter. It must be greater than or equal to 0. Set</span>
<span class="sd">        equal to 0 for a non-stochastic model.</span>
<span class="sd">    g : scalar</span>
<span class="sd">        Government spending shock</span>
<span class="sd">    g_t : int</span>
<span class="sd">        Time at which government spending shock occurs. Must be specified</span>
<span class="sd">        when duration != None.</span>
<span class="sd">    duration : {None, &#39;permanent&#39;, &#39;one-off&#39;}</span>
<span class="sd">        Specifies type of government spending shock. If none, government</span>
<span class="sd">        spending equal to g for all t.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">α</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">g_t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">y_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span> <span class="o">=</span> <span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">g_t</span><span class="p">,</span> <span class="n">duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">=</span> <span class="n">γ</span><span class="p">,</span> <span class="n">σ</span>
        
        <span class="c1"># Use unified analysis function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analysis</span> <span class="o">=</span> <span class="n">analyze_roots</span><span class="p">(</span><span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;rho1&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;rho2&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">roots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;roots&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">root_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Complex conjugate&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;is_complex&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;Real&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">root_less_than_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;is_stable&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solution_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;solution_type&#39;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">g_params</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="s1">&#39;g_t&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_t</span><span class="p">,</span> <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">}</span> 
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">y_series</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">simulate_samuelson</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span><span class="p">,</span> <span class="n">g_params</span><span class="p">,</span> <span class="n">seed</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">y_series</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summary</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">root_type</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Roots: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root_less_than_one</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Absolute value of roots is less than one&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Absolute value of roots is not less than one&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stochastic series with σ = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">σ</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Non-stochastic series&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Government spending equal to &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
                <span class="o">+</span> <span class="s2">&quot; government spending shock at t = &quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g_t</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_series</span><span class="p">(</span><span class="n">seed</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;iteration&quot;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$Y_t$&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Display model parameters on the plot</span>
        <span class="n">paramstr</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;$α=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$ </span><span class="se">\n</span><span class="s2"> $β=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$ </span><span class="se">\n</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">gamma=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$ </span><span class="se">\n</span><span class="s2"> $</span><span class="se">\\</span><span class="s2">sigma=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">σ</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$ </span><span class="se">\n</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">rho_1=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$ </span><span class="se">\n</span><span class="s2"> $</span><span class="se">\\</span><span class="s2">rho_2=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$&quot;</span>
        <span class="p">)</span>
        <span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.87</span><span class="p">,</span>
            <span class="mf">0.05</span><span class="p">,</span>
            <span class="n">paramstr</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">,</span>
            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">param_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="n">fig</span> <span class="o">=</span> <span class="n">param_plot</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="c1"># Display eigenvalues in the legend</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">root</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="nb">complex</span><span class="p">):</span>

                <span class="c1"># Handle sign formatting for complex number display</span>
                <span class="n">operator</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
                <span class="n">root_real</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
                <span class="n">root_imag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>
                <span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">rf</span><span class="s2">&quot;$\lambda_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">root_real</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">operator</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">root_imag</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">i$&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;$\lambda_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">roots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">$&quot;</span>

            <span class="c1"># Add invisible point for legend entry</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span>
            <span class="p">)</span>

        <span class="c1"># Mark current parameter values on the stability diagram</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$(\rho_1, \rho_2)$&quot;</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</div>
<section id="illustration-of-samuelson-class">
<h3><span class="section-number">37.6.1. </span>Illustration of Samuelson class<a class="headerlink" href="#illustration-of-samuelson-class" title="Link to this heading">#</a></h3>
<p>Now we’ll put our Samuelson class to work on an example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sam</span> <span class="o">=</span> <span class="n">Samuelson</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">g_t</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s2">&quot;permanent&quot;</span><span class="p">)</span>
<span class="n">sam</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Summary
--------------------------------------------------
Root type: Complex conjugate
Solution type: Damped oscillations
Roots: [0.65+0.27838822j 0.65-0.27838822j]
Absolute value of roots is less than one
Stochastic series with σ = 2
Government spending equal to 10
Permanent government spending shock at t = 20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sam</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4949718c0b7785f631cc3e1c6e404c30661044df7b1daf090485169349dbebe7.png" src="_images/4949718c0b7785f631cc3e1c6e404c30661044df7b1daf090485169349dbebe7.png" />
</div>
</div>
</section>
<section id="using-the-graph">
<h3><span class="section-number">37.6.2. </span>Using the graph<a class="headerlink" href="#using-the-graph" title="Link to this heading">#</a></h3>
<p>We’ll use our graph to show where the roots lie and how their location
is consistent with the behavior of the path just graphed.</p>
<p>The red <span class="math notranslate nohighlight">\(+\)</span> sign shows the location of the roots</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sam</span><span class="o">.</span><span class="n">param_plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3a7c0205aba6c48ab45a0dff80bae24fd4cbc3c0265f9e87693e10b6956cbd1e.png" src="_images/3a7c0205aba6c48ab45a0dff80bae24fd4cbc3c0265f9e87693e10b6956cbd1e.png" />
</div>
</div>
</section>
</section>
<section id="using-the-linearstatespace-class">
<h2><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">37.7. </span>Using the LinearStateSpace class</a><a class="headerlink" href="#using-the-linearstatespace-class" title="Link to this heading">#</a></h2>
<p>It turns out that we can use the <a class="reference external" href="https://quantecon.org/quantecon-py/">QuantEcon.py</a>
<a class="reference external" href="https://github.com/QuantEcon/QuantEcon.py/blob/master/quantecon/lss.py">LinearStateSpace</a> class to do
much of the work that we have done from scratch above.</p>
<p>Here is how we map the Samuelson model into an instance of a
<code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> class</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">α</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">β</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
<span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>
<span class="n">γ</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">σ</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">g</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span><span class="p">,</span> <span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

<span class="n">G</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span><span class="p">,</span> <span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">],</span>  <span class="c1"># Y_{t+1}</span>
    <span class="p">[</span><span class="n">γ</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>        <span class="c1"># C_{t+1}</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="o">-</span><span class="n">β</span><span class="p">],</span>       <span class="c1"># I_{t+1}</span>
<span class="p">]</span>

<span class="n">μ_0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">σ</span>  <span class="c1"># Shock variance</span>

<span class="n">sam_t</span> <span class="o">=</span> <span class="n">LinearStateSpace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="n">μ_0</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sam_t</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">ts_length</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Output ($Y_t$)&quot;</span><span class="p">,</span> <span class="s2">&quot;Consumption ($C_t$)&quot;</span><span class="p">,</span> <span class="s2">&quot;Investment ($I_t$)&quot;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;purple&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;iteration&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4b7525240e1cf687b9341fa80eb74a0b6bb2f3b10f4fdc362f6b1d4aa1cffd56.png" src="_images/4b7525240e1cf687b9341fa80eb74a0b6bb2f3b10f4fdc362f6b1d4aa1cffd56.png" />
</div>
</div>
<section id="other-methods-in-the-linearstatespace-class">
<h3><span class="section-number">37.7.1. </span>Other methods in the <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> class<a class="headerlink" href="#other-methods-in-the-linearstatespace-class" title="Link to this heading">#</a></h3>
<p>Let’s plot <em>impulse response functions</em> for the instance of the
Samuelson model using a method in the <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> class</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imres</span> <span class="o">=</span> <span class="n">sam_t</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">()</span>
<span class="n">imres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">imres</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">imres</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">imres</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y1</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ea9bf316aa89b057256f89b38b32587d67e45221ed65e2dc0f63cd0bbb1d366d.png" src="_images/ea9bf316aa89b057256f89b38b32587d67e45221ed65e2dc0f63cd0bbb1d366d.png" />
</div>
</div>
<p>Now let’s compute the zeros of the characteristic polynomial by simply
calculating the eigenvalues of <span class="math notranslate nohighlight">\(A\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.85+0.42j 0.85-0.42j 1.  +0.j  ]
</pre></div>
</div>
</div>
</div>
</section>
<section id="inheriting-methods-from-linearstatespace">
<h3><span class="section-number">37.7.2. </span>Inheriting methods from <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code><a class="headerlink" href="#inheriting-methods-from-linearstatespace" title="Link to this heading">#</a></h3>
<p>We could also create a subclass of <code class="docutils literal notranslate"><span class="pre">LinearStateSpace</span></code> (inheriting all its
methods and attributes) to add more functions to use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SamuelsonLSS</span><span class="p">(</span><span class="n">LinearStateSpace</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This subclass creates a Samuelson multiplier-accelerator model</span>
<span class="sd">    as a linear state space system.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y_1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">σ</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span> <span class="o">=</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">=</span> <span class="n">γ</span><span class="p">,</span> <span class="n">σ</span>

        <span class="c1"># Set initial state vector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_μ</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_0</span><span class="p">,</span> <span class="n">y_1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span> <span class="o">=</span> <span class="n">α</span> <span class="o">+</span> <span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span> <span class="o">=</span> <span class="o">-</span><span class="n">β</span>

        <span class="c1"># Construct state transition matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

        <span class="c1"># Construct observation matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">γ</span> <span class="o">+</span> <span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ2</span><span class="p">],</span>  <span class="c1"># Y_{t+1}</span>
            <span class="p">[</span><span class="n">γ</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>                  <span class="c1"># C_{t+1}</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="o">-</span><span class="n">β</span><span class="p">],</span>                 <span class="c1"># I_{t+1}</span>
        <span class="p">]</span>  

        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">σ</span>  <span class="c1"># Shock variance</span>

        <span class="c1"># Initialize the LinearStateSpace instance</span>
        <span class="n">LinearStateSpace</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_μ</span>
        <span class="p">)</span>

    <span class="c1"># Create unicode aliases for mu_0 and Sigma_0 in the parent class</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">μ_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span>
    
    <span class="nd">@μ_0</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">μ_0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu_0</span> <span class="o">=</span> <span class="n">value</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Σ_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_0</span>
    
    <span class="nd">@Σ_0</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Σ_0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_0</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stationary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

        <span class="c1"># Store original distribution parameters</span>
        <span class="n">temp_μ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">μ_0</span>
        <span class="n">temp_Σ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Σ_0</span>

        <span class="c1"># Use stationary distribution for simulation</span>
        <span class="k">if</span> <span class="n">stationary</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">μ_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">μ_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Σ_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Σ_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Σ_yx</span>
                <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationary_distributions</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">μ_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">μ_x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Σ_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Σ_x</span>

            <span class="c1"># Handle case where stationary distribution doesn&#39;t exist</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stationary distribution does not exist&quot;</span><span class="p">)</span>

        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">ts_length</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Output ($Y_t$)&quot;</span><span class="p">,</span> 
                  <span class="s2">&quot;Consumption ($C_t$)&quot;</span><span class="p">,</span> 
                  <span class="s2">&quot;Investment ($I_t$)&quot;</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;purple&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

        <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;iteration&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1"># Restore original distribution parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">μ_0</span> <span class="o">=</span> <span class="n">temp_μ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Σ_0</span> <span class="o">=</span> <span class="n">temp_Σ</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_irf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

        <span class="c1"># Reshape impulse responses for plotting</span>
        <span class="n">yimf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$Y_t$&quot;</span><span class="p">,</span> <span class="s2">&quot;$C_t$&quot;</span><span class="p">,</span> <span class="s2">&quot;$I_t$&quot;</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;purple&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">yimf</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Impulse response functions&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;iteration&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">multipliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">impulse_response</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="illustrations">
<h3><span class="section-number">37.7.3. </span>Illustrations<a class="headerlink" href="#illustrations" title="Link to this heading">#</a></h3>
<p>Let’s show how we can use the <code class="docutils literal notranslate"><span class="pre">SamuelsonLSS</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span> <span class="o">=</span> <span class="n">SamuelsonLSS</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span><span class="o">.</span><span class="n">plot_simulation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">stationary</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c615a858aca16ba328d732a8286c0ea3c4be13e3c996e482fa0043e5e7b301cf.png" src="_images/c615a858aca16ba328d732a8286c0ea3c4be13e3c996e482fa0043e5e7b301cf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span><span class="o">.</span><span class="n">plot_simulation</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">stationary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/72bf94bb3e0ce0456eda1dcf10115254ede50a029ad9ac90b6bc86a6511922ab.png" src="_images/72bf94bb3e0ce0456eda1dcf10115254ede50a029ad9ac90b6bc86a6511922ab.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span><span class="o">.</span><span class="n">plot_irf</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c9a328206a2d32bca465a8a0113a37284bf64a6e99044d1c8449da800fdb4301.png" src="_images/c9a328206a2d32bca465a8a0113a37284bf64a6e99044d1c8449da800fdb4301.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samlss</span><span class="o">.</span><span class="n">multipliers</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([7.414389, 6.835896, 0.578493])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="pure-multiplier-model">
<h2><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">37.8. </span>Pure multiplier model</a><a class="headerlink" href="#pure-multiplier-model" title="Link to this heading">#</a></h2>
<p>Let’s shut down the accelerator by setting <span class="math notranslate nohighlight">\(b=0\)</span> to get a pure
multiplier model</p>
<ul class="simple">
<li><p>the absence of cycles gives an idea about why Samuelson included the
accelerator</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span> <span class="o">=</span> <span class="n">SamuelsonLSS</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span><span class="o">.</span><span class="n">plot_simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9a9c6d775cdaa24d1ce2b2ab4ec406c43117a909bd8037f75d9aee121157106e.png" src="_images/9a9c6d775cdaa24d1ce2b2ab4ec406c43117a909bd8037f75d9aee121157106e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span> <span class="o">=</span> <span class="n">SamuelsonLSS</span><span class="p">(</span><span class="n">α</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span><span class="o">.</span><span class="n">plot_simulation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/95f3bca7795275f2c28000dedb13bc2b74ff0d6ce584e2605886aeb19bbb2dd3.png" src="_images/95f3bca7795275f2c28000dedb13bc2b74ff0d6ce584e2605886aeb19bbb2dd3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pure_multiplier</span><span class="o">.</span><span class="n">plot_irf</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7fa23bf814ddabaa6f15255075409bb16c575b03ba570e36184943a3ae06d8b2.png" src="_images/7fa23bf814ddabaa6f15255075409bb16c575b03ba570e36184943a3ae06d8b2.png" />
</div>
</div>
</section>
<section id="summary">
<h2><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">37.9. </span>Summary</a><a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>In this lecture, we wrote functions and classes to represent non-stochastic and
stochastic versions of the Samuelson (1939) multiplier-accelerator model, described
in <span id="id6">[<a class="reference internal" href="zreferences.html#id101" title="Paul A. Samuelson. Interactions between the multiplier analysis and the principle of acceleration. Review of Economic Studies, 21(2):75–78, 1939.">Samuelson, 1939</a>]</span>.</p>
<p>We saw that different parameter values led to different output paths, which
could either be stationary, explosive, or oscillating.</p>
<p>We also were able to represent the model using the <a class="reference external" href="https://quantecon.org/quantecon-py/">QuantEcon.py</a>
<a class="reference external" href="https://github.com/QuantEcon/QuantEcon.py/blob/master/quantecon/lss.py">LinearStateSpace</a> class.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   1. Modeling COVID 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   2. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   3. QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   4. Circulant Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   5. Singular Value Decomposition (SVD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   6. VARs and DMDs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   7. Using Newton’s Method to Solve Economic Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementary Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   8. Elementary Probability with Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_examples.html">
   9. Some Probability Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   10. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   11. Two Meanings of Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   12. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   13. Multivariate Normal Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   14. Fault Tree Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   15. Introduction to Artificial Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   16. Randomized Response Surveys
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   17. Expected Utilities of Random Responses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bayes Law
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   18. Non-Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   19. Posterior Distributions for  AR(1) Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   20. Forecasting  an AR(1) Process
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics and Information
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="divergence_measures.html">
   21. Statistical Divergence Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   22. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process_2.html">
   23. Heterogeneous Beliefs and Financial Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_var.html">
   24. Likelihood Processes For VAR Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   25. Mean of a Likelihood Ratio Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   26. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman_2.html">
   27. A Bayesian Formulation of Friedman and Wald’s Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   28. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   29. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   30. Incorrect Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   31. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   32. Optimal Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   33. Von Neumann Growth Model (and a Generalization)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   34. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   35. Inventory Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   36. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   37. Samuelson Multiplier-Accelerator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   38. Kesten Processes and Firm Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   39. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   40. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   41. Another Look at the Kalman Filter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Search
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   42. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   43. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_sep_markov.html">
   44. Job Search III: Search with Separation and Markov Wages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   45. Job Search IV: Fitted Value Function Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_persist_trans.html">
   46. Job Search V: Persistent and Transitory Wage Shocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   47. Job Search VI: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   48. Job Search VII: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   49. Job Search VIII: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   50. Job Search IX: Search with Q-Learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Optimal Savings
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="os.html">
   51. Optimal Savings I: Cake Eating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_numerical.html">
   52. Optimal Savings II: Numerical Cake Eating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_stochastic.html">
   53. Optimal Savings III: Stochastic Returns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_time_iter.html">
   54. Optimal Savings IV: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_egm.html">
   55. Optimal Savings V: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_egm_jax.html">
   56. Optimal Savings VI: EGM with JAX
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Household Problems
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_discrete.html">
   57. The Income Fluctuation Problem I: Discretization and VFI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_opi.html">
   58. The Income Fluctuation Problem II: Optimistic Policy Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_egm.html">
   59. The Income Fluctuation Problem III: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_egm_transient_shocks.html">
   60. The Income Fluctuation Problem IV: Transient Income Shocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   61. The Income Fluctuation Problem V: Stochastic Returns on Assets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   62. LQ Control: Foundations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   63. Lagrangian for LQ Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   64. Eliminating Cross Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   65. The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   66. Permanent Income II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   67. Production Smoothing via Inventories
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Optimal Growth
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   68. Cass-Koopmans Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   69. Cass-Koopmans Competitive Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal.html">
   70. Cass-Koopmans Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal_2.html">
   71. Two-Country Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak2.html">
   72. Transitions in an Overlapping Generations Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   73. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="endogenous_lake.html">
   74. Lake Model with an Endogenous Job Finding Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   75. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   76. Stability in Linear Rational Expectations Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   77. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   78. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   79. The Aiyagari Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak_aiyagari.html">
   80. A Long-Lived, Heterogeneous Agent, Overlapping Generations Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   81. Asset Pricing: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   82. Competitive Equilibria with Arrow Securities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   83. Heterogeneous Beliefs and Bubbles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morris_learn.html">
   84. Speculative Behavior with Bayesian Learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data and Empirics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   85. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   86. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   87. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Auctions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   88. First-Price and Second-Price Auctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   89. Multiple Good Allocation Mechanisms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   90. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   91. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   92. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/samuelson.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/blob/main/lectures/samuelson.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/samuelson.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/samuelson.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/samuelson.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "samuelson";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/samuelson.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>