

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>48. Cass-Koopmans Competitive Equilibrium &#8212; Intermediate Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=d6d86bce9979111653c4c495e33499e1796e172a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cass_koopmans_2';</script>
    <link rel="canonical" href="https://python.quantecon.org/cass_koopmans_2.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="49. Cass-Koopmans Model with Distorting Taxes" href="cass_fiscal.html" />
    <link rel="prev" title="47. Cass-Koopmans Model" href="cass_koopmans_1.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Cass-Koopmans Competitive Equilibrium"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Cass-Koopmans Competitive Equilibrium" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/cass_koopmans_2.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Intermediate Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=cass_koopmans_2>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">48.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#review-of-cass-koopmans-model">48.2. Review of Cass-Koopmans Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#planning-problem">48.2.1. Planning Problem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#competitive-equilibrium">48.3. Competitive Equilibrium</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#market-structure">48.4. Market Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prices">48.4.1. Prices</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#firm-problem">48.5. Firm Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zero-profit-conditions">48.5.1. Zero Profit Conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#household-problem">48.6. Household Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definitions">48.6.1. Definitions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-a-competitive-equilibrium">48.7. Computing a Competitive Equilibrium</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#guess-for-price-system">48.7.1. Guess for Price System</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-procedure">48.7.2. Verification Procedure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#households-lagrangian">48.7.3. Household’s Lagrangian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#representative-firms-problem">48.7.4. Representative Firm’s Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#varying-curvature">48.7.4.1. Varying Curvature</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#yield-curves-and-hicks-arrow-prices">48.8. Yield Curves and Hicks-Arrow Prices</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Intermediate Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Cass-Koopmans Competitive Equilibrium</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="cass-koopmans-competitive-equilibrium">
<h1><a class="toc-backref" href="#id3"><span class="section-number">48. </span>Cass-Koopmans Competitive Equilibrium</a><a class="headerlink" href="#cass-koopmans-competitive-equilibrium" title="Permalink to this heading">#</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#cass-koopmans-competitive-equilibrium" id="id3">Cass-Koopmans Competitive Equilibrium</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id4">Overview</a></p></li>
<li><p><a class="reference internal" href="#review-of-cass-koopmans-model" id="id5">Review of Cass-Koopmans Model</a></p></li>
<li><p><a class="reference internal" href="#competitive-equilibrium" id="id6">Competitive Equilibrium</a></p></li>
<li><p><a class="reference internal" href="#market-structure" id="id7">Market Structure</a></p></li>
<li><p><a class="reference internal" href="#firm-problem" id="id8">Firm Problem</a></p></li>
<li><p><a class="reference internal" href="#household-problem" id="id9">Household Problem</a></p></li>
<li><p><a class="reference internal" href="#computing-a-competitive-equilibrium" id="id10">Computing a Competitive Equilibrium</a></p></li>
<li><p><a class="reference internal" href="#yield-curves-and-hicks-arrow-prices" id="id11">Yield Curves and Hicks-Arrow Prices</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id4"><span class="section-number">48.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>This lecture continues our analysis in this  lecture
<a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a> about the  model that Tjalling Koopmans <span id="id1">[<a class="reference internal" href="zreferences.html#id95" title="Tjalling C. Koopmans. On the concept of optimal economic growth. In Tjalling C. Koopmans, editor, The Economic Approach to Development Planning, pages 225-287. Chicago, 1965.">Koopmans, 1965</a>]</span>
and David Cass <span id="id2">[<a class="reference internal" href="zreferences.html#id96" title="David Cass. Optimum growth in an aggregative model of capital accumulation. Review of Economic Studies, 32(3):233-240, 1965.">Cass, 1965</a>]</span> used to study optimal capital accumulation.</p>
<p>This lecture illustrates what is, in fact, a
more general connection between a <strong>planned economy</strong> and an economy
organized as a competitive equilibrium or a <strong>market economy</strong>.</p>
<p>The earlier  lecture <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a> studied a planning problem and used ideas including</p>
<ul class="simple">
<li><p>A Lagrangian formulation of the  planning problem that leads to a system of difference equations.</p></li>
<li><p>A <strong>shooting algorithm</strong> for solving difference equations subject
to initial and terminal conditions.</p></li>
<li><p>A <strong>turnpike</strong> property that describes optimal paths for
long-but-finite horizon economies.</p></li>
</ul>
<p>The present lecture uses  additional  ideas including</p>
<ul class="simple">
<li><p>Hicks-Arrow prices, named after John R. Hicks and Kenneth Arrow.</p></li>
<li><p>A connection between some Lagrange multipliers from the planning
problem and the Hicks-Arrow prices.</p></li>
<li><p>A <strong>Big</strong> <span class="math notranslate nohighlight">\(K\)</span> <strong>, little</strong> <span class="math notranslate nohighlight">\(k\)</span> trick widely used in
macroeconomic dynamics.</p>
<ul>
<li><p>We shall encounter this trick in <a class="reference external" href="https://python.quantecon.org/rational_expectations.html">this lecture</a>
and also in <a class="reference external" href="https://python-advanced.quantecon.org/dyn_stack.html">this lecture</a>.</p></li>
</ul>
</li>
<li><p>A non-stochastic version of a theory of the <strong>term structure of
interest rates</strong>.</p></li>
<li><p>An intimate connection between  two
ways to organize an economy, namely:</p>
<ul>
<li><p><strong>socialism</strong> in which a central planner commands the
allocation of resources, and</p></li>
<li><p><strong>competitive markets</strong> in
which competitive equilibrium <strong>prices</strong> induce individual
consumers and producers to choose a socially optimal allocation
as  unintended consequences of their selfish
decisions</p></li>
</ul>
</li>
</ul>
<p>Let’s start with some standard imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1">#set default figure size</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">float64</span>
<span class="kn">from</span> <span class="nn">numba.experimental</span> <span class="kn">import</span> <span class="n">jitclass</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="review-of-cass-koopmans-model">
<h2><a class="toc-backref" href="#id5"><span class="section-number">48.2. </span>Review of Cass-Koopmans Model</a><a class="headerlink" href="#review-of-cass-koopmans-model" title="Permalink to this heading">#</a></h2>
<p>The physical setting is identical with that in <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a>.</p>
<p>Time is discrete and takes values <span class="math notranslate nohighlight">\(t = 0, 1 , \ldots, T\)</span>.</p>
<p>Output of a single good can either be consumed or invested in physical capital.</p>
<p>The capital good is durable but partially depreciates each period at a constant rate.</p>
<p>We let <span class="math notranslate nohighlight">\(C_t\)</span> be a nondurable consumption good at time t.</p>
<p>Let <span class="math notranslate nohighlight">\(K_t\)</span> be the stock of physical capital at time t.</p>
<p>Let <span class="math notranslate nohighlight">\(\vec{C}\)</span> = <span class="math notranslate nohighlight">\(\{C_0,\dots, C_T\}\)</span> and
<span class="math notranslate nohighlight">\(\vec{K}\)</span> = <span class="math notranslate nohighlight">\(\{K_0,\dots,K_{T+1}\}\)</span>.</p>
<p>A representative household is endowed with one unit of labor at each
<span class="math notranslate nohighlight">\(t\)</span> and likes the consumption good at each <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>The representative household inelastically supplies a single unit of
labor <span class="math notranslate nohighlight">\(N_t\)</span> at each <span class="math notranslate nohighlight">\(t\)</span>, so that
<span class="math notranslate nohighlight">\(N_t =1 \text{ for all } t \in \{0, 1, \ldots, T\}\)</span>.</p>
<p>The representative household has preferences over consumption bundles
ordered by the utility functional:</p>
<div class="math notranslate nohighlight">
\[
U(\vec{C}) = \sum_{t=0}^{T} \beta^t \frac{C_t^{1-\gamma}}{1-\gamma}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta \in (0,1)\)</span> is a discount factor and <span class="math notranslate nohighlight">\(\gamma &gt;0\)</span>
governs the curvature of the one-period utility function.</p>
<p>We assume that <span class="math notranslate nohighlight">\(K_0 &gt; 0\)</span>.</p>
<p>There is an economy-wide production function</p>
<div class="math notranslate nohighlight">
\[
F(K_t,N_t) = A K_t^{\alpha}N_t^{1-\alpha}
\]</div>
<p>with <span class="math notranslate nohighlight">\(0 &lt; \alpha&lt;1\)</span>, <span class="math notranslate nohighlight">\(A &gt; 0\)</span>.</p>
<p>A feasible allocation <span class="math notranslate nohighlight">\(\vec{C}, \vec{K}\)</span> satisfies</p>
<div class="math notranslate nohighlight">
\[
C_t + K_{t+1} \leq F(K_t,N_t) + (1-\delta) K_t \quad \text{for all } t \in \{0, 1, \ldots, T\}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta \in (0,1)\)</span> is a depreciation rate of capital.</p>
<section id="planning-problem">
<h3><span class="section-number">48.2.1. </span>Planning Problem<a class="headerlink" href="#planning-problem" title="Permalink to this heading">#</a></h3>
<p>In this lecture <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a>, we studied a problem in which a planner chooses an allocation <span class="math notranslate nohighlight">\(\{\vec{C},\vec{K}\}\)</span> to
maximize <a class="reference internal" href="cass_koopmans_1.html#equation-utility-functional">(47.2)</a> subject to <a class="reference internal" href="cass_koopmans_1.html#equation-allocation">(47.5)</a>.</p>
<p>The allocation that solves the planning problem reappears in a competitive equilibrium, as we shall see below.</p>
</section>
</section>
<section id="competitive-equilibrium">
<h2><a class="toc-backref" href="#id6"><span class="section-number">48.3. </span>Competitive Equilibrium</a><a class="headerlink" href="#competitive-equilibrium" title="Permalink to this heading">#</a></h2>
<p>We now study a decentralized version of the  economy.</p>
<p>It shares  the same
technology and preference structure as the planned economy studied in this lecture <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a>.</p>
<p>But now there is no planner.</p>
<p>There are (unit masses of) price-taking consumers and firms.</p>
<p>Market prices are set to reconcile distinct decisions that are made
separately by a representative consumer and a representative firm.</p>
<p>There is a representative consumer who has the same preferences over
consumption plans as did a consumer in the planned economy.</p>
<p>Instead of being told what to consume and save by a planner, a
consumer (also known as a <em>household</em>) chooses for itself subject to a budget constraint.</p>
<ul class="simple">
<li><p>At each time <span class="math notranslate nohighlight">\(t\)</span>, the consumer receives wages and rentals
of capital from a firm – these comprise its <strong>income</strong> at
time <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p>The consumer decides how much income to allocate to consumption or
to savings.</p></li>
<li><p>The household can save either by acquiring additional physical
capital (it trades one for one with time <span class="math notranslate nohighlight">\(t\)</span> consumption)
or by acquiring claims on consumption at dates other
than <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
<li><p>The household owns  physical capital and labor
and rents them to the firm.</p></li>
<li><p>The household consumes, supplies labor, and invests in physical
capital.</p></li>
<li><p>A profit-maximizing representative firm operates the production
technology.</p></li>
<li><p>The firm rents labor and capital each period from the
representative household and sells its output each period to the
household.</p></li>
<li><p>The representative household and the representative firm are both
<strong>price takers</strong> who believe that prices are not affected by their choices</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Again, we can think of there being  unit measures of identical representative consumers and
identical representative firms.</p>
</div>
</section>
<section id="market-structure">
<h2><a class="toc-backref" href="#id7"><span class="section-number">48.4. </span>Market Structure</a><a class="headerlink" href="#market-structure" title="Permalink to this heading">#</a></h2>
<p>The representative household and the representative firm are both price takers.</p>
<p>The household owns both factors of production, namely, labor and physical capital.</p>
<p>Each period, the firm rents both factors from the household.</p>
<p>There is a <strong>single</strong> grand competitive market in which a
household  trades date <span class="math notranslate nohighlight">\(0\)</span> goods for goods at
all other dates <span class="math notranslate nohighlight">\(t=1, 2, \ldots, T\)</span>.</p>
<section id="prices">
<h3><span class="section-number">48.4.1. </span>Prices<a class="headerlink" href="#prices" title="Permalink to this heading">#</a></h3>
<p>There are  sequences of prices
<span class="math notranslate nohighlight">\(\{w_t,\eta_t\}_{t=0}^T= \{\vec{w}, \vec{\eta} \}\)</span>
where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w_t\)</span> is a wage, i.e., a rental rate, for labor at time <span class="math notranslate nohighlight">\(t\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\eta_t\)</span> is a rental rate for capital at time <span class="math notranslate nohighlight">\(t\)</span></p></li>
</ul>
<p>In addition there is a vector <span class="math notranslate nohighlight">\(\{q_t^0\}\)</span> of  intertemporal prices where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(q^0_t\)</span> is the price at time <span class="math notranslate nohighlight">\(0\)</span> of one unit of the  good at date <span class="math notranslate nohighlight">\(t\)</span>.</p></li>
</ul>
<p>We call <span class="math notranslate nohighlight">\(\{q^0_t\}_{t=0}^T\)</span>  a vector of <strong>Hicks-Arrow prices</strong>,
named after the 1972 economics Nobel prize winners.</p>
<p>Because  is a <strong>relative price</strong>. the unit of account  in terms of which the prices <span class="math notranslate nohighlight">\(q^0_t\)</span> are stated is; we are free to re-normalize them by multiplying  all of them by a positive scalar, say <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span>.</p>
<p>Units of <span class="math notranslate nohighlight">\(q_t^0\)</span> could be set so that they are</p>
<div class="math notranslate nohighlight">
\[
\frac{\text{number of time 0 goods}}{\text{number of time t goods}}
\]</div>
<p>In this case, we would be taking the time <span class="math notranslate nohighlight">\(0\)</span> consumption good to be the <strong>numeraire</strong>.</p>
</section>
</section>
<section id="firm-problem">
<h2><a class="toc-backref" href="#id8"><span class="section-number">48.5. </span>Firm Problem</a><a class="headerlink" href="#firm-problem" title="Permalink to this heading">#</a></h2>
<p>At time <span class="math notranslate nohighlight">\(t\)</span> a representative firm hires labor
<span class="math notranslate nohighlight">\(\tilde n_t\)</span> and capital <span class="math notranslate nohighlight">\(\tilde k_t\)</span>.</p>
<p>The firm’s profits at time <span class="math notranslate nohighlight">\(t\)</span> are</p>
<div class="math notranslate nohighlight">
\[
F(\tilde k_t, \tilde n_t)-w_t \tilde n_t -\eta_t \tilde k_t
\]</div>
<p>where <span class="math notranslate nohighlight">\(w_t\)</span> is a wage rate at <span class="math notranslate nohighlight">\(t\)</span>
and <span class="math notranslate nohighlight">\(\eta_t\)</span> is the rental rate on capital at <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>As in the planned economy model</p>
<div class="math notranslate nohighlight">
\[
F(\tilde k_t, \tilde n_t) = A \tilde k_t^\alpha \tilde n_t^{1-\alpha}
\]</div>
<section id="zero-profit-conditions">
<h3><span class="section-number">48.5.1. </span>Zero Profit Conditions<a class="headerlink" href="#zero-profit-conditions" title="Permalink to this heading">#</a></h3>
<p>Zero-profits conditions for capital and labor are</p>
<div class="math notranslate nohighlight">
\[
F_k(\tilde k_t, \tilde n_t) =\eta_t
\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-zero-profits">
<span class="eqno">(48.1)<a class="headerlink" href="#equation-zero-profits" title="Permalink to this equation">#</a></span>\[F_n(\tilde k_t, \tilde n_t) =w_t\]</div>
<p>These conditions emerge from a no-arbitrage requirement.</p>
<p>To describe this no-arbitrage profits  reasoning, we begin by applying a theorem of
Euler about linearly homogenous functions.</p>
<p>The theorem applies to the Cobb-Douglas production function because
we it  displays constant returns to scale:</p>
<div class="math notranslate nohighlight">
\[
\alpha F(\tilde k_t, \tilde n_t) =  F(\alpha  \tilde k_t, \alpha \tilde n_t)
\]</div>
<p>for <span class="math notranslate nohighlight">\(\alpha \in (0,1)\)</span>.</p>
<p>Taking  partial derivatives
<span class="math notranslate nohighlight">\(\frac{\partial  }{\partial \alpha}\)</span> on both sides of the
above equation gives</p>
<div class="math notranslate nohighlight">
\[
F(\tilde k_t,\tilde n_t) =  \frac{\partial F}{\partial \tilde k_t}
\tilde k_t + \frac{\partial F}{\partial \tilde  n_t} \tilde n_t
\]</div>
<p>Rewrite the firm’s profits as</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial F}{\partial \tilde k_t} \tilde k_t +
\frac{\partial F}{\partial \tilde  n_t} \tilde n_t-w_t \tilde n_t -\eta_t k_t
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
\left(\frac{\partial F}{\partial \tilde k_t}-\eta_t\right) \tilde k_t +
\left(\frac{\partial F}{\partial \tilde  n_t}-w_t\right) \tilde n_t
\]</div>
<p>Because <span class="math notranslate nohighlight">\(F\)</span> is homogeneous of degree <span class="math notranslate nohighlight">\(1\)</span>, it follows
that <span class="math notranslate nohighlight">\(\frac{\partial F}{\partial \tilde k_t}\)</span> and
<span class="math notranslate nohighlight">\(\frac{\partial F}{\partial \tilde n_t}\)</span> are homogeneous of
degree <span class="math notranslate nohighlight">\(0\)</span> and therefore fixed with respect to
<span class="math notranslate nohighlight">\(\tilde k_t\)</span> and <span class="math notranslate nohighlight">\(\tilde n_t\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\frac{\partial F}{\partial \tilde k_t}&gt; \eta_t\)</span>, then the
firm makes positive profits on each additional unit of
<span class="math notranslate nohighlight">\(\tilde k_t\)</span>, so it would want to make <span class="math notranslate nohighlight">\(\tilde k_t\)</span>
arbitrarily large.</p>
<p>But setting <span class="math notranslate nohighlight">\(\tilde k_t = + \infty\)</span> is not physically feasible,
so  <strong>equilibrium</strong> prices must take  values that present
the firm with no such arbitrage opportunity.</p>
<p>A similar argument applies if
<span class="math notranslate nohighlight">\(\frac{\partial F}{\partial \tilde n_t}&gt; w_t\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\frac{\partial \tilde k_t}{\partial \tilde k_t}&lt; \eta_t\)</span>,
the firm would want to set  <span class="math notranslate nohighlight">\(\tilde k_t\)</span> to zero, which is not feasible.</p>
<p>It is convenient to define
<span class="math notranslate nohighlight">\(\vec{w} =\{w_0, \dots,w_T\}\)</span> and <span class="math notranslate nohighlight">\(\vec{\eta}= \{\eta_0, \dots, \eta_T\}\)</span>.</p>
</section>
</section>
<section id="household-problem">
<h2><a class="toc-backref" href="#id9"><span class="section-number">48.6. </span>Household Problem</a><a class="headerlink" href="#household-problem" title="Permalink to this heading">#</a></h2>
<p>A representative household lives at <span class="math notranslate nohighlight">\(t=0,1,\dots, T\)</span>.</p>
<p>At <span class="math notranslate nohighlight">\(t\)</span>, the household rents <span class="math notranslate nohighlight">\(1\)</span> unit of labor
and <span class="math notranslate nohighlight">\(k_t\)</span> units of capital to a firm and receives income</p>
<div class="math notranslate nohighlight">
\[
w_t 1+ \eta_t k_t
\]</div>
<p>At <span class="math notranslate nohighlight">\(t\)</span> the household allocates its income to the following
purchases between the following two categories:</p>
<ul class="simple">
<li><p>consumption <span class="math notranslate nohighlight">\(c_t\)</span></p></li>
<li><p>net investment <span class="math notranslate nohighlight">\(k_{t+1} -(1-\delta)k_t\)</span></p></li>
</ul>
<p>Here <span class="math notranslate nohighlight">\(\left(k_{t+1} -(1-\delta)k_t\right)\)</span> is the household’s
net investment in physical capital and <span class="math notranslate nohighlight">\(\delta \in (0,1)\)</span> is
again a depreciation rate of capital.</p>
<p>In period <span class="math notranslate nohighlight">\(t\)</span>, the consumer is free to purchase more goods to be consumed and
invested in physical capital than its income from supplying capital
and labor to the firm, provided that in some other periods its income
exceeds its purchases.</p>
<p>A consumer’s net excess demand for time <span class="math notranslate nohighlight">\(t\)</span> consumption goods
is the gap</p>
<div class="math notranslate nohighlight">
\[
e_t \equiv \left(c_t + (k_{t+1} -(1-\delta)k_t)\right)-(w_t 1 + \eta_t k_t)
\]</div>
<p>Let <span class="math notranslate nohighlight">\(\vec{c} = \{c_0,\dots,c_T\}\)</span> and let <span class="math notranslate nohighlight">\(\vec{k} = \{k_1,\dots,k_{T+1}\}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(k_0\)</span> is given to the household.</p>
<p>The household faces a <strong>single</strong> budget constraint
that requires that the present value of the household’s net excess
demands must be zero:</p>
<div class="math notranslate nohighlight">
\[
\sum_{t=0}^T q^0_t e_t  \leq 0
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
\sum_{t=0}^T q^0_t  \left(c_t + (k_{t+1} -(1-\delta)k_t)\right) \leq \sum_{t=0}^T q^0_t(w_t 1 + \eta_t k_t)  \
\]</div>
<p>The household faces price system <span class="math notranslate nohighlight">\(\{q^0_t, w_t, \eta_t\}\)</span> as a price-taker and  chooses an allocation to solve the constrained optimization problem:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}&amp; \max_{\vec{c}, \vec{k} }  \sum_{t=0}^T \beta^t u(c_t) \\ \text{subject to} \ \   &amp; \sum_{t=0}^T q_t^0\left(c_t +\left(k_{t+1}-(1-\delta) k_t \right) - (w_t -\eta_t k_t) \right)\leq 0  \notag \end{aligned}
\end{split}\]</div>
<p>Components of a  <strong>price system</strong> have the following units:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w_t\)</span> is measured in units of the  time <span class="math notranslate nohighlight">\(t\)</span> good per unit of time <span class="math notranslate nohighlight">\(t\)</span> labor hired</p></li>
<li><p><span class="math notranslate nohighlight">\(\eta_t\)</span> is measured in  units of the time <span class="math notranslate nohighlight">\(t\)</span> good per unit of time <span class="math notranslate nohighlight">\(t\)</span> capital  hired</p></li>
<li><p><span class="math notranslate nohighlight">\(q_t^0\)</span> is measured in units of a numeraire  per unit of the time <span class="math notranslate nohighlight">\(t\)</span> good</p></li>
</ul>
<section id="definitions">
<h3><span class="section-number">48.6.1. </span>Definitions<a class="headerlink" href="#definitions" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>A <strong>price system</strong> is a sequence
<span class="math notranslate nohighlight">\(\{q_t^0,\eta_t,w_t\}_{t=0}^T= \{\vec{q}, \vec{\eta}, \vec{w}\}\)</span>.</p></li>
<li><p>An <strong>allocation</strong> is a sequence
<span class="math notranslate nohighlight">\(\{c_t,k_{t+1},n_t=1\}_{t=0}^T = \{\vec{c}, \vec{k}, \vec{n}\}\)</span>.</p></li>
<li><p>A <strong>competitive equilibrium</strong> is a price system and an allocation
with the following properties:</p>
<ul>
<li><p>Given the price system, the allocation solves the household’s
problem.</p></li>
<li><p>Given the price system, the allocation solves the firm’s
problem.</p></li>
</ul>
</li>
</ul>
<p>The vision here is that an equilibrium price system and allocation are determined once and for all.</p>
<p>In effect, we imagine that all trades occur just before time <span class="math notranslate nohighlight">\(0\)</span>.</p>
</section>
</section>
<section id="computing-a-competitive-equilibrium">
<h2><a class="toc-backref" href="#id10"><span class="section-number">48.7. </span>Computing a Competitive Equilibrium</a><a class="headerlink" href="#computing-a-competitive-equilibrium" title="Permalink to this heading">#</a></h2>
<p>We compute a competitive equilibrium by using a <strong>guess and
verify</strong> approach.</p>
<ul class="simple">
<li><p>We  <strong>guess</strong> equilibrium price sequences
<span class="math notranslate nohighlight">\(\{\vec{q}, \vec{\eta}, \vec{w}\}\)</span>.</p></li>
<li><p>We then <strong>verify</strong> that at those prices, the household and
the firm choose the same allocation.</p></li>
</ul>
<section id="guess-for-price-system">
<h3><span class="section-number">48.7.1. </span>Guess for Price System<a class="headerlink" href="#guess-for-price-system" title="Permalink to this heading">#</a></h3>
<p>In this lecture <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a>, we  computed an allocation <span class="math notranslate nohighlight">\(\{\vec{C}, \vec{K}, \vec{N}\}\)</span>
that solves a planning problem.</p>
<p>We use that allocation to construct a guess for the equilibrium
price system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This allocation will constitute the <strong>Big</strong> <span class="math notranslate nohighlight">\(K\)</span>  to be in the present instance of the <strong>Big</strong> <span class="math notranslate nohighlight">\(K\)</span> <strong>, little</strong> <span class="math notranslate nohighlight">\(k\)</span> trick
that we’ll apply to  a competitive equilibrium in the spirit of <a class="reference external" href="https://python.quantecon.org/rational_expectations.html">this lecture</a>
and  <a class="reference external" href="https://python-advanced.quantecon.org/dyn_stack.html">this lecture</a>.</p>
</div>
<p>In particular, we shall use the following procedure:</p>
<ul class="simple">
<li><p>obtain first-order conditions for the representative firm and the representative consumer.</p></li>
<li><p>from these equations, obtain a new set of equations by replacing the firm’s choice variables <span class="math notranslate nohighlight">\(\tilde k, \tilde n\)</span> and the consumer’s choice variables with the quantities <span class="math notranslate nohighlight">\(\vec C, \vec K\)</span> that solve the planning problem.</p></li>
<li><p>solve the resulting equations for  <span class="math notranslate nohighlight">\(\{\vec{q}, \vec{\eta}, \vec{w}\}\)</span> as functions of <span class="math notranslate nohighlight">\(\vec C, \vec K\)</span>.</p></li>
<li><p>verify that at these prices, <span class="math notranslate nohighlight">\(c_t = C_t, k_t = \tilde k_t = K_t, \tilde n_t = 1\)</span> for <span class="math notranslate nohighlight">\(t = 0, 1, \ldots, T\)</span>.</p></li>
</ul>
<p>Thus, we guess that for <span class="math notranslate nohighlight">\(t=0,\dots,T\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-price">
<span class="eqno">(48.2)<a class="headerlink" href="#equation-eq-price" title="Permalink to this equation">#</a></span>\[q_t^0 = \beta^t u'(C_t) \]</div>
<div class="math notranslate nohighlight" id="equation-eq-price2">
<span class="eqno">(48.3)<a class="headerlink" href="#equation-eq-price2" title="Permalink to this equation">#</a></span>\[w_t = f(K_t) -K_t f'(K_t)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-price3">
<span class="eqno">(48.4)<a class="headerlink" href="#equation-eq-price3" title="Permalink to this equation">#</a></span>\[\eta_t = f'(K_t)\]</div>
<p>At these prices, let  capital chosen by the household be</p>
<div class="math notranslate nohighlight" id="equation-eq-pr4">
<span class="eqno">(48.5)<a class="headerlink" href="#equation-eq-pr4" title="Permalink to this equation">#</a></span>\[k^*_t(\vec {q}, \vec{w}, \vec{\eta)} , \quad t \geq 0\]</div>
<p>and let the allocation chosen by the firm be</p>
<div class="math notranslate nohighlight">
\[
\tilde k^*_t(\vec{q}, \vec{w}, \vec{\eta}), \quad t \geq 0
\]</div>
<p>and so on.</p>
<p>If our guess for the equilibrium price system is correct, then it
must occur that</p>
<div class="math notranslate nohighlight" id="equation-ge1">
<span class="eqno">(48.6)<a class="headerlink" href="#equation-ge1" title="Permalink to this equation">#</a></span>\[k_t^*  = \tilde k_t^*\]</div>
<div class="math notranslate nohighlight" id="equation-ge2">
<span class="eqno">(48.7)<a class="headerlink" href="#equation-ge2" title="Permalink to this equation">#</a></span>\[1   = \tilde n_t^*\]</div>
<div class="math notranslate nohighlight">
\[
c_t^* + k_{t+1}^* - (1-\delta) k_t^*  = F(\tilde k_t^*, \tilde n_t^*)
\]</div>
<p>We shall verify that for <span class="math notranslate nohighlight">\(t=0,\dots,T\)</span>  allocations chosen
by the household and the firm both equal the allocation that solves
the planning problem:</p>
<div class="math notranslate nohighlight" id="equation-eq-pl">
<span class="eqno">(48.8)<a class="headerlink" href="#equation-eq-pl" title="Permalink to this equation">#</a></span>\[k^*_t = \tilde k^*_t=K_t, \tilde n_t=1, c^*_t=C_t\]</div>
</section>
<section id="verification-procedure">
<h3><span class="section-number">48.7.2. </span>Verification Procedure<a class="headerlink" href="#verification-procedure" title="Permalink to this heading">#</a></h3>
<p>Our approach is firsts to stare at first-order necessary conditions for
optimization problems of the household and the firm.</p>
<p>At the price system we have guessed, we’ll then verify that both sets of first-order
conditions are satisfied at the allocation that solves the planning
problem.</p>
</section>
<section id="households-lagrangian">
<h3><span class="section-number">48.7.3. </span>Household’s Lagrangian<a class="headerlink" href="#households-lagrangian" title="Permalink to this heading">#</a></h3>
<p>To solve the household’s problem, we formulate the Lagrangian</p>
<div class="math notranslate nohighlight">
\[
\mathcal{L}(\vec{c},\vec{k},\lambda) = \sum_{t=0}^T \beta^t u(c_t)+ \lambda \left(\sum_{t=0}^T q_t^0\left(\left((1-\delta) k_t -w_t\right)
+\eta_t k_t -c_t  - k_{t+1}\right)\right)
\]</div>
<p>and attack the min-max problem:</p>
<div class="math notranslate nohighlight">
\[
\min_{\lambda} \max_{\vec{c},\vec{k}}  \mathcal{L}(\vec{c},\vec{k},\lambda)
\]</div>
<p>First-order conditions are</p>
<div class="math notranslate nohighlight" id="equation-cond1">
<span class="eqno">(48.9)<a class="headerlink" href="#equation-cond1" title="Permalink to this equation">#</a></span>\[c_t: \quad \beta^t u'(c_t)-\lambda q_t^0=0 \quad  t=0,1,\dots,T\]</div>
<div class="math notranslate nohighlight" id="equation-cond2">
<span class="eqno">(48.10)<a class="headerlink" href="#equation-cond2" title="Permalink to this equation">#</a></span>\[k_t: \quad -\lambda q_t^0 \left[(1-\delta)+\eta_t \right]+\lambda q^0_{t-1}=0 \quad  t=1,2,\dots,T+1\]</div>
<div class="math notranslate nohighlight" id="equation-cond3">
<span class="eqno">(48.11)<a class="headerlink" href="#equation-cond3" title="Permalink to this equation">#</a></span>\[\lambda:  \quad \left(\sum_{t=0}^T q_t^0\left(c_t + \left(k_{t+1}-(1-\delta) k_t\right) -w_t -\eta_t k_t\right)\right) \leq 0\]</div>
<div class="math notranslate nohighlight" id="equation-cond4">
<span class="eqno">(48.12)<a class="headerlink" href="#equation-cond4" title="Permalink to this equation">#</a></span>\[k_{T+1}: \quad -\lambda q_0^{T+1} \leq 0, \ \leq 0 \text{ if } k_{T+1}=0; \ =0 \text{ if } k_{T+1}&gt;0\]</div>
<p>Now we plug in our guesses of prices and do some algebra in the hope of recovering all first-order necessary conditions
<a class="reference internal" href="cass_koopmans_1.html#equation-constraint1">(47.9)</a>-<a class="reference internal" href="cass_koopmans_1.html#equation-constraint4">(47.12)</a> for the planning problem from this lecture <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a>.</p>
<p>Combining <a class="reference internal" href="#equation-cond1">(48.9)</a> and <a class="reference internal" href="#equation-eq-price">(48.2)</a>, we get:</p>
<div class="math notranslate nohighlight">
\[
u'(C_t) = \mu_t
\]</div>
<p>which is <a class="reference internal" href="cass_koopmans_1.html#equation-constraint1">(47.9)</a>.</p>
<p>Combining <a class="reference internal" href="#equation-cond2">(48.10)</a>, <a class="reference internal" href="#equation-eq-price">(48.2)</a>, and
<a class="reference internal" href="#equation-eq-price3">(48.4)</a>, we get:</p>
<div class="math notranslate nohighlight" id="equation-co-re">
<span class="eqno">(48.13)<a class="headerlink" href="#equation-co-re" title="Permalink to this equation">#</a></span>\[-\lambda \beta^t \mu_t\left[(1-\delta) +f'(K_t)\right] +\lambda \beta^{t-1}\mu_{t-1}=0\]</div>
<p>Rewriting <a class="reference internal" href="#equation-co-re">(48.13)</a> by dividing by <span class="math notranslate nohighlight">\(\lambda\)</span> on
both sides (which is nonzero since  u’&gt;0) we get:</p>
<div class="math notranslate nohighlight">
\[
\beta^t \mu_t [(1-\delta+f'(K_t)] = \beta^{t-1} \mu_{t-1}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
\beta \mu_t [(1-\delta+f'(K_t)] = \mu_{t-1}
\]</div>
<p>which is <a class="reference internal" href="cass_koopmans_1.html#equation-constraint2">(47.10)</a>.</p>
<p>Combining <a class="reference internal" href="#equation-cond3">(48.11)</a>, <a class="reference internal" href="#equation-eq-price">(48.2)</a>, <a class="reference internal" href="#equation-eq-price2">(48.3)</a>
and <a class="reference internal" href="#equation-eq-price3">(48.4)</a> after multiplying both sides of
<a class="reference internal" href="#equation-cond3">(48.11)</a> by <span class="math notranslate nohighlight">\(\lambda\)</span>, we get</p>
<div class="math notranslate nohighlight">
\[
\sum_{t=0}^T \beta^t \mu_{t} \left(C_t+ (K_{t+1} -(1-\delta)K_t)-f(K_t)+K_t f'(K_t)-f'(K_t)K_t\right) \leq 0
\]</div>
<p>which simplifies to</p>
<div class="math notranslate nohighlight">
\[
\sum_{t=0}^T  \beta^t \mu_{t} \left(C_t +K_{t+1} -(1-\delta)K_t - F(K_t,1)\right) \leq 0
\]</div>
<p>Since <span class="math notranslate nohighlight">\(\beta^t \mu_t &gt;0\)</span> for <span class="math notranslate nohighlight">\(t =0, \ldots, T\)</span>, it follows that</p>
<div class="math notranslate nohighlight">
\[
C_t+K_{t+1}-(1-\delta)K_t -F(K_t,1)=0 \quad  \text{ for all }t \text{ in } \{0, 1, \ldots, T\}
\]</div>
<p>which is <a class="reference internal" href="cass_koopmans_1.html#equation-constraint3">(47.11)</a>.</p>
<p>Combining <a class="reference internal" href="#equation-cond4">(48.12)</a> and <a class="reference internal" href="#equation-eq-price">(48.2)</a>, we get:</p>
<div class="math notranslate nohighlight">
\[
-\beta^{T+1} \mu_{T+1} \leq 0
\]</div>
<p>Dividing both sides by <span class="math notranslate nohighlight">\(\beta^{T+1}\)</span> gives</p>
<div class="math notranslate nohighlight">
\[
-\mu_{T+1} \leq 0
\]</div>
<p>which is  <a class="reference internal" href="cass_koopmans_1.html#equation-constraint4">(47.12)</a> for the  planning problem.</p>
<p>Thus, at our guess of the equilibrium price system, the allocation
that solves the planning problem also solves the problem faced by a
representative household living in a competitive equilibrium.</p>
</section>
<section id="representative-firms-problem">
<h3><span class="section-number">48.7.4. </span>Representative Firm’s Problem<a class="headerlink" href="#representative-firms-problem" title="Permalink to this heading">#</a></h3>
<p>We now turn to  the problem faced by a firm in a competitive
equilibrium:</p>
<p>If we plug <a class="reference internal" href="#equation-eq-pl">(48.8)</a> into <a class="reference internal" href="#equation-zero-profits">(48.1)</a> for all t, we
get</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial F(K_t, 1)}{\partial K_t} = f'(K_t) = \eta_t
\]</div>
<p>which is <a class="reference internal" href="#equation-eq-price3">(48.4)</a>.</p>
<p>If we now plug <a class="reference internal" href="#equation-eq-pl">(48.8)</a> into <a class="reference internal" href="#equation-zero-profits">(48.1)</a> for all t, we
get:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial F(\tilde K_t, 1)}{\partial \tilde L_t} = f(K_t)-f'(K_t)K_t=w_t
\]</div>
<p>which is exactly <a class="reference internal" href="#equation-eq-pr4">(48.5)</a>.</p>
<p>Thus, at our guess for the equilibrium price system, the allocation
that solves the planning problem also solves the problem faced by a firm
within a competitive equilibrium.</p>
<p>By <a class="reference internal" href="#equation-ge1">(48.6)</a> and <a class="reference internal" href="#equation-ge2">(48.7)</a> this allocation is
identical to the one that solves the consumer’s problem.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because budget sets are affected only by relative prices,
<span class="math notranslate nohighlight">\(\{q^0_t\}\)</span> is determined only up to multiplication by a
positive constant.</p>
</div>
<p><strong>Normalization:</strong> We are free to choose a <span class="math notranslate nohighlight">\(\{q_t^0\}\)</span> that
makes <span class="math notranslate nohighlight">\(\lambda=1\)</span> so that we are measuring <span class="math notranslate nohighlight">\(q_t^0\)</span>  in
units of the marginal utility of time <span class="math notranslate nohighlight">\(0\)</span> goods.</p>
<p>We will  plot <span class="math notranslate nohighlight">\(q, w, \eta\)</span> below to show these equilibrium  prices
induce the same aggregate movements that we saw earlier in the planning
problem.</p>
<p>To proceed, we bring in Python code that <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a> used to solve the planning problem</p>
<p>First let’s define a <code class="docutils literal notranslate"><span class="pre">jitclass</span></code> that stores  parameters and functions
the characterize an economy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planning_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;γ&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">),</span>    <span class="c1"># Coefficient of relative risk aversion</span>
    <span class="p">(</span><span class="s1">&#39;β&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">),</span>    <span class="c1"># Discount factor</span>
    <span class="p">(</span><span class="s1">&#39;δ&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">),</span>    <span class="c1"># Depreciation rate on capital</span>
    <span class="p">(</span><span class="s1">&#39;α&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">),</span>    <span class="c1"># Return to capital per capita</span>
    <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">float64</span><span class="p">)</span>     <span class="c1"># Technology</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jitclass</span><span class="p">(</span><span class="n">planning_data</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">PlanningProblem</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">δ</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">α</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span> <span class="o">=</span> <span class="n">γ</span><span class="p">,</span> <span class="n">β</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">δ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">δ</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">A</span>

    <span class="k">def</span> <span class="nf">u</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Utility function</span>
<span class="sd">        ASIDE: If you have a utility function that is hard to solve by hand</span>
<span class="sd">        you can use automatic or symbolic differentiation</span>
<span class="sd">        See https://github.com/HIPS/autograd</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">γ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span>

        <span class="k">return</span> <span class="n">c</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">γ</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">γ</span><span class="p">)</span> <span class="k">if</span> <span class="n">γ</span><span class="o">!=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">u_prime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="s1">&#39;Derivative of utility&#39;</span>
        <span class="n">γ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span>

        <span class="k">return</span> <span class="n">c</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">γ</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">u_prime_inv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="s1">&#39;Inverse of derivative of utility&#39;</span>
        <span class="n">γ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span>

        <span class="k">return</span> <span class="n">c</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">γ</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="s1">&#39;Production function&#39;</span>
        <span class="n">α</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span>

        <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">k</span> <span class="o">**</span> <span class="n">α</span>

    <span class="k">def</span> <span class="nf">f_prime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="s1">&#39;Derivative of production function&#39;</span>
        <span class="n">α</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span>

        <span class="k">return</span> <span class="n">α</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">k</span> <span class="o">**</span> <span class="p">(</span><span class="n">α</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">f_prime_inv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="s1">&#39;Inverse of derivative of production function&#39;</span>
        <span class="n">α</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">α</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">α</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">next_k_c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;&#39;</span>
<span class="sd">        Given the current capital Kt and an arbitrary feasible</span>
<span class="sd">        consumption choice Ct, computes Kt+1 by state transition law</span>
<span class="sd">        and optimal Ct+1 by Euler equation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">β</span><span class="p">,</span> <span class="n">δ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">δ</span>
        <span class="n">u_prime</span><span class="p">,</span> <span class="n">u_prime_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_prime</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u_prime_inv</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">f_prime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_prime</span>

        <span class="n">k_next</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">δ</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">-</span> <span class="n">c</span>
        <span class="n">c_next</span> <span class="o">=</span> <span class="n">u_prime_inv</span><span class="p">(</span><span class="n">u_prime</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">β</span> <span class="o">*</span> <span class="p">(</span><span class="n">f_prime</span><span class="p">(</span><span class="n">k_next</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">δ</span><span class="p">))))</span>

        <span class="k">return</span> <span class="n">k_next</span><span class="p">,</span> <span class="n">c_next</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">shooting</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Given the initial condition of capital k0 and an initial guess</span>
<span class="sd">    of consumption c0, computes the whole paths of c and k</span>
<span class="sd">    using the state transition law and Euler equation for T periods.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">c0</span> <span class="o">&gt;</span> <span class="n">pp</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">k0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;initial consumption is not feasible&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># initialize vectors of c and k</span>
    <span class="n">c_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">k_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">c_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c0</span>
    <span class="n">k_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">k0</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
        <span class="n">k_vec</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">c_vec</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">next_k_c</span><span class="p">(</span><span class="n">k_vec</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">c_vec</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>

    <span class="n">k_vec</span><span class="p">[</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">k_vec</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pp</span><span class="o">.</span><span class="n">δ</span><span class="p">)</span> <span class="o">*</span> <span class="n">k_vec</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">-</span> <span class="n">c_vec</span><span class="p">[</span><span class="n">T</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">c_vec</span><span class="p">,</span> <span class="n">k_vec</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">bisection</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">k_ter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="c1"># initial boundaries for guess c0</span>
    <span class="n">c0_upper</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">k0</span><span class="p">)</span>
    <span class="n">c0_lower</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">c_vec</span><span class="p">,</span> <span class="n">k_vec</span> <span class="o">=</span> <span class="n">shooting</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">k_vec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">k_ter</span>

        <span class="c1"># check if the terminal condition is satisfied</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converged successfully on iteration &#39;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">c_vec</span><span class="p">,</span> <span class="n">k_vec</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">max_iter</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Convergence failed.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">c_vec</span><span class="p">,</span> <span class="n">k_vec</span>

        <span class="c1"># if iteration continues, updates boundaries and guess of c0</span>
        <span class="k">if</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c0_lower</span> <span class="o">=</span> <span class="n">c0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c0_upper</span> <span class="o">=</span> <span class="n">c0</span>

        <span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="n">c0_lower</span> <span class="o">+</span> <span class="n">c0_upper</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pp</span> <span class="o">=</span> <span class="n">PlanningProblem</span><span class="p">()</span>

<span class="c1"># Steady states</span>
<span class="n">ρ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">pp</span><span class="o">.</span><span class="n">β</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">k_ss</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">f_prime_inv</span><span class="p">(</span><span class="n">ρ</span><span class="o">+</span><span class="n">pp</span><span class="o">.</span><span class="n">δ</span><span class="p">)</span>
<span class="n">c_ss</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">k_ss</span><span class="p">)</span> <span class="o">-</span> <span class="n">pp</span><span class="o">.</span><span class="n">δ</span> <span class="o">*</span> <span class="n">k_ss</span>
</pre></div>
</div>
</div>
</div>
<p>The above code from this lecture <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">Cass-Koopmans Planning Model</span></a> lets us compute an optimal allocation for the planning problem.</p>
<ul class="simple">
<li><p>from the preceding analysis, we know that it will also be  an  allocation associated with a competitive equilibium.</p></li>
</ul>
<p>Now  we’re ready to bring in Python code that we require to compute additional objects that appear in a competitive equilibrium.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">q</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">c_path</span><span class="p">):</span>
    <span class="c1"># Here we choose numeraire to be u&#39;(c_0) -- this is q^(t_0)_t</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">q_path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">q_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">q_path</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">β</span> <span class="o">**</span> <span class="n">t</span> <span class="o">*</span> <span class="n">pp</span><span class="o">.</span><span class="n">u_prime</span><span class="p">(</span><span class="n">c_path</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">q_path</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">k_path</span><span class="p">):</span>
    <span class="n">w_path</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">k_path</span><span class="p">)</span> <span class="o">-</span> <span class="n">k_path</span> <span class="o">*</span> <span class="n">pp</span><span class="o">.</span><span class="n">f_prime</span><span class="p">(</span><span class="n">k_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">w_path</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">η</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">k_path</span><span class="p">):</span>
    <span class="n">η_path</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">f_prime</span><span class="p">(</span><span class="n">k_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">η_path</span>
</pre></div>
</div>
</div>
</div>
<p>Now we calculate and plot for each <span class="math notranslate nohighlight">\(T\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>

<span class="n">fix</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Arrow-Hicks Prices&#39;</span><span class="p">,</span> <span class="s1">&#39;Labor Rental Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;Capital Rental Rate&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Consumption&#39;</span><span class="p">,</span> <span class="s1">&#39;Capital&#39;</span><span class="p">,</span> <span class="s1">&#39;Lagrange Multiplier&#39;</span><span class="p">]</span>
<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$q_t^0$&#39;</span><span class="p">,</span> <span class="s1">&#39;$w_t$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\eta_t$&#39;</span><span class="p">,</span> <span class="s1">&#39;$c_t$&#39;</span><span class="p">,</span> <span class="s1">&#39;$k_t$&#39;</span><span class="p">,</span> <span class="s1">&#39;$\mu_t$&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_arr</span><span class="p">:</span>
    <span class="n">c_path</span><span class="p">,</span> <span class="n">k_path</span> <span class="o">=</span> <span class="n">bisection</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">k_ss</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">μ_path</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">u_prime</span><span class="p">(</span><span class="n">c_path</span><span class="p">)</span>

    <span class="n">q_path</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">c_path</span><span class="p">)</span>
    <span class="n">w_path</span> <span class="o">=</span> <span class="n">w</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">k_path</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">η_path</span> <span class="o">=</span> <span class="n">η</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">k_path</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">q_path</span><span class="p">,</span> <span class="n">w_path</span><span class="p">,</span> <span class="n">η_path</span><span class="p">,</span> <span class="n">c_path</span><span class="p">,</span> <span class="n">k_path</span><span class="p">,</span> <span class="n">μ_path</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Capital&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">k_ss</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Consumption&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">c_ss</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\e&#39;
&lt;&gt;:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
/tmp/ipykernel_5929/2143488158.py:6: SyntaxWarning: invalid escape sequence &#39;\e&#39;
  ylabels = [&#39;$q_t^0$&#39;, &#39;$w_t$&#39;, &#39;$\eta_t$&#39;, &#39;$c_t$&#39;, &#39;$k_t$&#39;, &#39;$\mu_t$&#39;]
/tmp/ipykernel_5929/2143488158.py:6: SyntaxWarning: invalid escape sequence &#39;\m&#39;
  ylabels = [&#39;$q_t^0$&#39;, &#39;$w_t$&#39;, &#39;$\eta_t$&#39;, &#39;$c_t$&#39;, &#39;$k_t$&#39;, &#39;$\mu_t$&#39;]
</pre></div>
</div>
<img alt="_images/ad7e3730836bff78f69cdea50196031a52e5a91e8fd0eb1b47242fcb78265f76.png" src="_images/ad7e3730836bff78f69cdea50196031a52e5a91e8fd0eb1b47242fcb78265f76.png" />
</div>
</div>
<section id="varying-curvature">
<h4><span class="section-number">48.7.4.1. </span>Varying Curvature<a class="headerlink" href="#varying-curvature" title="Permalink to this heading">#</a></h4>
<p>Now we see how our results change if we keep <span class="math notranslate nohighlight">\(T\)</span> constant, but allow
the curvature parameter, <span class="math notranslate nohighlight">\(\gamma\)</span> to vary, starting
with <span class="math notranslate nohighlight">\(K_0\)</span> below the steady state.</p>
<p>We plot the results for <span class="math notranslate nohighlight">\(T=150\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">γ_arr</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>

<span class="n">fix</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">γ</span> <span class="ow">in</span> <span class="n">γ_arr</span><span class="p">:</span>
    <span class="n">pp_γ</span> <span class="o">=</span> <span class="n">PlanningProblem</span><span class="p">(</span><span class="n">γ</span><span class="o">=</span><span class="n">γ</span><span class="p">)</span>
    <span class="n">c_path</span><span class="p">,</span> <span class="n">k_path</span> <span class="o">=</span> <span class="n">bisection</span><span class="p">(</span><span class="n">pp_γ</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">k_ss</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">μ_path</span> <span class="o">=</span> <span class="n">pp_γ</span><span class="o">.</span><span class="n">u_prime</span><span class="p">(</span><span class="n">c_path</span><span class="p">)</span>

    <span class="n">q_path</span> <span class="o">=</span> <span class="n">q</span><span class="p">(</span><span class="n">pp_γ</span><span class="p">,</span> <span class="n">c_path</span><span class="p">)</span>
    <span class="n">w_path</span> <span class="o">=</span> <span class="n">w</span><span class="p">(</span><span class="n">pp_γ</span><span class="p">,</span> <span class="n">k_path</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">η_path</span> <span class="o">=</span> <span class="n">η</span><span class="p">(</span><span class="n">pp_γ</span><span class="p">,</span> <span class="n">k_path</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">q_path</span><span class="p">,</span> <span class="n">w_path</span><span class="p">,</span> <span class="n">η_path</span><span class="p">,</span> <span class="n">c_path</span><span class="p">,</span> <span class="n">k_path</span><span class="p">,</span> <span class="n">μ_path</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$\gamma = </span><span class="si">{</span><span class="n">γ</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Capital&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">k_ss</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Consumption&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">c_ss</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;&gt;:17: SyntaxWarning: invalid escape sequence &#39;\g&#39;
&lt;&gt;:17: SyntaxWarning: invalid escape sequence &#39;\g&#39;
/tmp/ipykernel_5929/134256387.py:17: SyntaxWarning: invalid escape sequence &#39;\g&#39;
  ax.plot(paths[i], label=f&#39;$\gamma = {γ}$&#39;)
</pre></div>
</div>
<img alt="_images/848f2ba410c9d99df22f6b7203afa5d639670715f7b0589c932213aafd75135a.png" src="_images/848f2ba410c9d99df22f6b7203afa5d639670715f7b0589c932213aafd75135a.png" />
</div>
</div>
<p>Adjusting <span class="math notranslate nohighlight">\(\gamma\)</span> means adjusting how much individuals prefer
to smooth consumption.</p>
<p>Higher <span class="math notranslate nohighlight">\(\gamma\)</span> means individuals prefer to smooth more
resulting in slower convergence to a  steady state allocation.</p>
<p>Lower <span class="math notranslate nohighlight">\(\gamma\)</span> means individuals prefer to smooth less,
resulting in faster convergence  to a steady state allocation.</p>
</section>
</section>
</section>
<section id="yield-curves-and-hicks-arrow-prices">
<h2><a class="toc-backref" href="#id11"><span class="section-number">48.8. </span>Yield Curves and Hicks-Arrow Prices</a><a class="headerlink" href="#yield-curves-and-hicks-arrow-prices" title="Permalink to this heading">#</a></h2>
<p>We return to  Hicks-Arrow prices and  calculate how they are related to  <strong>yields</strong>  on loans of alternative maturities.</p>
<p>This will let us plot a <strong>yield curve</strong> that graphs   yields  on bonds of  maturities <span class="math notranslate nohighlight">\(j=1, 2, \ldots\)</span> against <span class="math notranslate nohighlight">\(j=1,2, \ldots\)</span>.</p>
<p>We use the following formulas.</p>
<p>A <strong>yield to maturity</strong> on a loan made at time <span class="math notranslate nohighlight">\(t_0\)</span> that matures at time <span class="math notranslate nohighlight">\(t &gt; t_0\)</span></p>
<div class="math notranslate nohighlight">
\[
r_{t_0,t}= -\frac{\log q^{t_0}_t}{t - t_0}
\]</div>
<p>A Hicks-Arrow price system for a base-year <span class="math notranslate nohighlight">\(t_0\leq t\)</span> satisfies</p>
<div class="math notranslate nohighlight">
\[
q^{t_0}_t = \beta^{t-t_0} \frac{u'(c_t)}{u'(c_{t_0})}= \beta^{t-t_0}
\frac{c_t^{-\gamma}}{c_{t_0}^{-\gamma}}
\]</div>
<p>We redefine our function for <span class="math notranslate nohighlight">\(q\)</span> to allow arbitrary base
years, and define a new function for <span class="math notranslate nohighlight">\(r\)</span>, then plot both.</p>
<p>We begin by continuing to assume that  <span class="math notranslate nohighlight">\(t_0=0\)</span> and plot things for different maturities <span class="math notranslate nohighlight">\(t=T\)</span>, with <span class="math notranslate nohighlight">\(K_0\)</span> below the steady state</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">q_generic</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">c_path</span><span class="p">):</span>
    <span class="c1"># simplify notations</span>
    <span class="n">β</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">β</span>
    <span class="n">u_prime</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">u_prime</span>

    <span class="n">T</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">q_path</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span>
    <span class="n">q_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t0</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">q_path</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">]</span> <span class="o">=</span> <span class="n">β</span> <span class="o">**</span> <span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">)</span> <span class="o">*</span> <span class="n">u_prime</span><span class="p">(</span><span class="n">c_path</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">/</span> <span class="n">u_prime</span><span class="p">(</span><span class="n">c_path</span><span class="p">[</span><span class="n">t0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">q_path</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">q_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Yield to maturity&#39;&#39;&#39;</span>
    <span class="n">r_path</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">q_path</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_path</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">r_path</span>

<span class="k">def</span> <span class="nf">plot_yield_curves</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">T_arr</span><span class="p">):</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_arr</span><span class="p">:</span>
        <span class="n">c_path</span><span class="p">,</span> <span class="n">k_path</span> <span class="o">=</span> <span class="n">bisection</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">q_path</span> <span class="o">=</span> <span class="n">q_generic</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">c_path</span><span class="p">)</span>
        <span class="n">r_path</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">q_path</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">q_path</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$q_t^0$&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hicks-Arrow Prices&#39;</span><span class="p">)</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">t0</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">r_path</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$r_t^0$&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Yields&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T_arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">plot_yield_curves</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">k_ss</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">T_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d053a2edf24beeeb3f244a85e87df5503bede7f0f036e4d1ee8bf70dfda7e318.png" src="_images/d053a2edf24beeeb3f244a85e87df5503bede7f0f036e4d1ee8bf70dfda7e318.png" />
</div>
</div>
<p>Now we plot when <span class="math notranslate nohighlight">\(t_0=20\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_yield_curves</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">k_ss</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">T_arr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4cde067abcc284392c73ac53cf29e91288a7e1b048d26cbcbdcefe393933b6b2.png" src="_images/4cde067abcc284392c73ac53cf29e91288a7e1b048d26cbcbdcefe393933b6b2.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   1. Modeling COVID 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   2. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   3. QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   4. Circulant Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   5. Singular Value Decomposition (SVD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   6. VARs and DMDs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   7. Using Newton’s Method to Solve Economic Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementary Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   8. Elementary Probability with Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_examples.html">
   9. Some Probability Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   10. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   11. Two Meanings of Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   12. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   13. Multivariate Normal Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   14. Fault Tree Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   15. Introduction to Artificial Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   16. Randomized Response Surveys
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   17. Expected Utilities of Random Responses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bayes Law
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   18. Non-Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   19. Posterior Distributions for  AR(1) Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   20. Forecasting  an AR(1) Process
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics and Information
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   21. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   22. Mean of a Likelihood Ratio Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   23. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman_2.html">
   24. A Bayesian Formulation of Friedman and Wald’s Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   25. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   26. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   27. Incorrect Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   28. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   29. Optimal Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   30. Von Neumann Growth Model (and a Generalization)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   31. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   32. Inventory Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   33. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   34. Samuelson Multiplier-Accelerator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   35. Kesten Processes and Firm Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   36. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   37. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   38. Another Look at the Kalman Filter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Search
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   39. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   40. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   41. Job Search III: Fitted Value Function Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_correlated.html">
   42. Job Search IV: Correlated Wage Offers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   43. Job Search V: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   44. Job Search VI: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   45. Job Search VII: A McCall Worker Q-Learns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   46. Job Search VII: Search with Learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Consumption, Savings and Capital
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   47. Cass-Koopmans Model
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   48. Cass-Koopmans Competitive Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal.html">
   49. Cass-Koopmans Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal_2.html">
   50. Two-Country Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak2.html">
   51. Transitions in an Overlapping Generations Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_problem.html">
   52. Cake Eating I: Introduction to Optimal Saving
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_numerical.html">
   53. Cake Eating II: Numerical Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   54. Optimal Growth I: The Stochastic Optimal Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth_fast.html">
   55. Optimal Growth II: Accelerating the Code with Numba
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   56. Optimal Growth III: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   57. Optimal Growth IV: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   58. The Income Fluctuation Problem I: Basic Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   59. The Income Fluctuation Problem II: Stochastic Returns on Assets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   60. LQ Control: Foundations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   61. Lagrangian for LQ Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   62. Eliminating Cross Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   63. The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   64. Permanent Income II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   65. Production Smoothing via Inventories
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   66. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   67. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   68. Stability in Linear Rational Expectations Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   69. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   70. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   71. The Aiyagari Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   72. Asset Pricing: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   73. Competitive Equilibria with Arrow Securities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   74. Heterogeneous Beliefs and Bubbles
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data and Empirics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   75. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   76. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   77. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Auctions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   78. First-Price and Second-Price Auctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   79. Multiple Good Allocation Mechanisms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   80. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   81. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   82. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/cass_koopmans_2.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/blob/main/lectures/cass_koopmans_2.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/cass_koopmans_2.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/cass_koopmans_2.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/cass_koopmans_2.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "cass_koopmans_2";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/cass_koopmans_2.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>