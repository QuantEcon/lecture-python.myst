

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>23. Heterogeneous Beliefs and Financial Markets &#8212; Intermediate Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=bd0785fbb14d8d2bd4d9ae501d79ed8d3bc089ec" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.5ea377869091fd0449014c60fc090103.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=d6d86bce9979111653c4c495e33499e1796e172a"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'likelihood_ratio_process_2';</script>
    <link rel="canonical" href="https://python.quantecon.org/likelihood_ratio_process_2.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="24. Likelihood Processes for VAR Models" href="likelihood_var.html" />
    <link rel="prev" title="22. Likelihood Ratio Processes" href="likelihood_ratio_process.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Heterogeneous Beliefs and Financial Markets"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Heterogeneous Beliefs and Financial Markets" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/likelihood_ratio_process_2.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Intermediate Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=likelihood_ratio_process_2>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">23.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#review-likelihood-ratio-processes">23.2. Review: Likelihood Ratio Processes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#blume-and-easleys-setting">23.3. Blume and Easley’s Setting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nature-and-agents-beliefs">23.4. Nature and Agents’ Beliefs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-socialist-risk-sharing-arrangement">23.5. A Socialist Risk-Sharing Arrangement</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#social-planners-allocation-problem">23.6. Social Planner’s Allocation Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#if-youre-so-smart-ldots">23.7. If You’re So Smart, <span class="math notranslate nohighlight">\(\ldots\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#competitive-equilibrium-prices">23.8. Competitive Equilibrium Prices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulations">23.9. Simulations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#related-lectures">23.10. Related Lectures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">23.11. Exercise</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Intermediate Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Heterogeneous Beliefs and Financial Markets</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="heterogeneous-beliefs-and-financial-markets">
<h1><a class="toc-backref" href="#id8"><span class="section-number">23. </span>Heterogeneous Beliefs and Financial Markets</a><a class="headerlink" href="#heterogeneous-beliefs-and-financial-markets" title="Permalink to this heading">#</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#heterogeneous-beliefs-and-financial-markets" id="id8">Heterogeneous Beliefs and Financial Markets</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id9">Overview</a></p></li>
<li><p><a class="reference internal" href="#review-likelihood-ratio-processes" id="id10">Review: Likelihood Ratio Processes</a></p></li>
<li><p><a class="reference internal" href="#blume-and-easleys-setting" id="id11">Blume and Easley’s Setting</a></p></li>
<li><p><a class="reference internal" href="#nature-and-agents-beliefs" id="id12">Nature and Agents’ Beliefs</a></p></li>
<li><p><a class="reference internal" href="#a-socialist-risk-sharing-arrangement" id="id13">A Socialist Risk-Sharing Arrangement</a></p></li>
<li><p><a class="reference internal" href="#social-planners-allocation-problem" id="id14">Social Planner’s Allocation Problem</a></p></li>
<li><p><a class="reference internal" href="#if-youre-so-smart-ldots" id="id15">If You’re So Smart, <span class="math notranslate nohighlight">\(\ldots\)</span></a></p></li>
<li><p><a class="reference internal" href="#competitive-equilibrium-prices" id="id16">Competitive Equilibrium Prices</a></p></li>
<li><p><a class="reference internal" href="#simulations" id="id17">Simulations</a></p></li>
<li><p><a class="reference internal" href="#related-lectures" id="id18">Related Lectures</a></p></li>
<li><p><a class="reference internal" href="#exercise" id="id19">Exercise</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="overview">
<span id="id1"></span><h2><a class="toc-backref" href="#id9"><span class="section-number">23.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>A likelihood ratio process lies behind Lawrence Blume and David Easley’s answer to their question
‘‘If you’re so smart, why aren’t you rich?’’ <span id="id2">[<a class="reference internal" href="zreferences.html#id8" title="Lawrence Blume and David Easley. If you're so smart, why aren't you rich? belief selection in complete and incomplete markets. Econometrica, 74(4):929–966, 2006.">Blume and Easley, 2006</a>]</span>.</p>
<p>Blume and Easley constructed formal models to study how differences of opinions about probabilities governing risky income processes would influence outcomes and be reflected in prices of stocks, bonds, and insurance policies that individuals use to share and hedge risks.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span id="id3">[<a class="reference internal" href="zreferences.html#id7" title="Armen A Alchian. Uncertainty, evolution, and economic theory. Journal of political economy, 58(3):211–221, 1950.">Alchian, 1950</a>]</span> and <span id="id4">[<a class="reference internal" href="zreferences.html#id6" title="Milton Friedman. Essays in positive economics. University of Chicago press, 1953.">Friedman, 1953</a>]</span> conjectured that, by rewarding traders with more realistic probability models, competitive markets in financial securities put wealth in the hands of better informed traders and help
make prices of risky assets reflect realistic probability assessments.</p>
</div>
<p>Here we’ll provide an example that illustrates basic components of Blume and Easley’s analysis.</p>
<p>We’ll focus only on their analysis of an environment with complete markets in which trades in all conceivable risky securities are possible.</p>
<p>We’ll study two alternative arrangements:</p>
<ul class="simple">
<li><p>perfect socialism in which individuals surrender their endowments of consumption goods each period to a central planner who then dictatorially allocates those goods</p></li>
<li><p>a decentralized system of competitive markets in which selfish price-taking individuals voluntarily trade with each other in competitive markets</p></li>
</ul>
<p>The fundamental theorems of welfare economics will apply and assure us that these two arrangements end up producing exactly the same allocation of consumption goods to individuals <strong>provided</strong> that the social planner assigns an appropriate set of <strong>Pareto weights</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can learn about how the two welfare theorems are applied in modern macroeconomic models in <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">this lecture on a planning problem</span></a> and <a class="reference internal" href="cass_koopmans_2.html"><span class="doc">this lecture on a related competitive equilibrium</span></a>.</p>
</div>
<p>Let’s start by importing some Python tools.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">vectorize</span><span class="p">,</span> <span class="n">jit</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">gamma</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">brentq</span><span class="p">,</span> <span class="n">minimize_scalar</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Math</span>
<span class="kn">import</span> <span class="nn">quantecon</span> <span class="k">as</span> <span class="nn">qe</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="review-likelihood-ratio-processes">
<h2><a class="toc-backref" href="#id10"><span class="section-number">23.2. </span>Review: Likelihood Ratio Processes</a><a class="headerlink" href="#review-likelihood-ratio-processes" title="Permalink to this heading">#</a></h2>
<p>We’ll begin by reminding ourselves definitions and properties of likelihood ratio processes.</p>
<p>A nonnegative random variable <span class="math notranslate nohighlight">\(W\)</span> has one of two probability density functions, either
<span class="math notranslate nohighlight">\(f\)</span> or <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>Before the beginning of time, nature once and for all decides whether she will draw a sequence of IID draws from either
<span class="math notranslate nohighlight">\(f\)</span> or <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>We will sometimes let <span class="math notranslate nohighlight">\(q\)</span> be the density that nature chose once and for all, so
that <span class="math notranslate nohighlight">\(q\)</span> is either <span class="math notranslate nohighlight">\(f\)</span> or <span class="math notranslate nohighlight">\(g\)</span>, permanently.</p>
<p>Nature knows which density it permanently draws from, but we the observers do not.</p>
<p>We know both <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> but we don’t know which density nature
chose.</p>
<p>But we want to know.</p>
<p>To do that, we use observations.</p>
<p>We observe a sequence <span class="math notranslate nohighlight">\(\{w_t\}_{t=1}^T\)</span> of <span class="math notranslate nohighlight">\(T\)</span> IID draws that we know came from either <span class="math notranslate nohighlight">\(f\)</span> or <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>We want to use these observations to infer whether nature chose <span class="math notranslate nohighlight">\(f\)</span> or <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>A <strong>likelihood ratio process</strong> is a useful tool for this task.</p>
<p>To begin, we define a key component of a likelihood ratio process, namely, the time <span class="math notranslate nohighlight">\(t\)</span> likelihood ratio as the random variable</p>
<div class="math notranslate nohighlight">
\[
\ell (w_t)=\frac{f\left(w_t\right)}{g\left(w_t\right)},\quad t\geq1.
\]</div>
<p>We assume that <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> both put positive probabilities on the
same intervals of possible realizations of the random variable <span class="math notranslate nohighlight">\(W\)</span>.</p>
<p>That means that under the <span class="math notranslate nohighlight">\(g\)</span> density, <span class="math notranslate nohighlight">\(\ell (w_t)=
\frac{f\left(w_{t}\right)}{g\left(w_{t}\right)}\)</span>
is a nonnegative random variable with mean <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>A <strong>likelihood ratio process</strong> for sequence
<span class="math notranslate nohighlight">\(\left\{ w_{t}\right\} _{t=1}^{\infty}\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[
L\left(w^{t}\right)=\prod_{i=1}^{t} \ell (w_i),
\]</div>
<p>where <span class="math notranslate nohighlight">\(w^t=\{ w_1,\dots,w_t\}\)</span> is a history of
observations up to and including time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Sometimes for shorthand we’ll write <span class="math notranslate nohighlight">\(L_t = L(w^t)\)</span>.</p>
<p>Notice that the likelihood process satisfies the <em>recursion</em></p>
<div class="math notranslate nohighlight">
\[
L(w^t) = \ell (w_t) L (w^{t-1}) .
\]</div>
<p>The likelihood ratio and its logarithm are key tools for making
inferences using a classic frequentist approach due to Neyman and
Pearson <span id="id5">[<a class="reference internal" href="zreferences.html#id262" title="J. Neyman and E. S Pearson. On the problem of the most efficient tests of statistical hypotheses. Phil. Trans. R. Soc. Lond. A. 231 (694–706), pages 289–337, 1933.">Neyman and Pearson, 1933</a>]</span>.</p>
<p>To help us appreciate how things work, the following Python code evaluates <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> as two different
Beta distributions, then computes and simulates an associated likelihood
ratio process by generating a sequence <span class="math notranslate nohighlight">\(w^t\)</span> from one of the two
probability distributions, for example, a sequence of IID draws from <span class="math notranslate nohighlight">\(g\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters in the two Beta distributions.</span>
<span class="n">F_a</span><span class="p">,</span> <span class="n">F_b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">G_a</span><span class="p">,</span> <span class="n">G_b</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">1.2</span>

<span class="nd">@vectorize</span>
<span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">gamma</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># The two density functions.</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">F_a</span><span class="p">,</span> <span class="n">F_b</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">G_a</span><span class="p">,</span> <span class="n">G_b</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Generate N sets of T observations of the likelihood ratio,</span>
<span class="sd">    return as N x T matrix.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">l_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">l_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="n">g</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">l_arr</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="blume-and-easleys-setting">
<h2><a class="toc-backref" href="#id11"><span class="section-number">23.3. </span>Blume and Easley’s Setting</a><a class="headerlink" href="#blume-and-easleys-setting" title="Permalink to this heading">#</a></h2>
<p>Let the random variable <span class="math notranslate nohighlight">\(s_t \in (0,1)\)</span> at time <span class="math notranslate nohighlight">\(t =0, 1, 2, \ldots\)</span> be distributed according to the same Beta distribution with parameters
<span class="math notranslate nohighlight">\(\theta = \{\theta_1, \theta_2\}\)</span>.</p>
<p>We’ll denote this probability density as</p>
<div class="math notranslate nohighlight">
\[
\pi(s_t|\theta)
\]</div>
<p>Below, we’ll often just write <span class="math notranslate nohighlight">\(\pi(s_t)\)</span> instead of <span class="math notranslate nohighlight">\(\pi(s_t|\theta)\)</span> to save space.</p>
<p>Let <span class="math notranslate nohighlight">\(s_t \equiv y_t^1\)</span> be the endowment of a nonstorable consumption good that a person we’ll call “agent 1” receives at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>Let a history <span class="math notranslate nohighlight">\(s^t = [s_t, s_{t-1}, \ldots, s_0]\)</span> be a sequence of i.i.d. random variables with joint distribution</p>
<div class="math notranslate nohighlight">
\[
\pi_t(s^t) = \pi(s_t) \pi(s_{t-1}) \cdots \pi(s_0)
\]</div>
<p>So in our example, the history <span class="math notranslate nohighlight">\(s^t\)</span> is a comprehensive record of agent <span class="math notranslate nohighlight">\(1\)</span>’s endowments of the consumption good from time <span class="math notranslate nohighlight">\(0\)</span> up to time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>If agent <span class="math notranslate nohighlight">\(1\)</span> were to live on an island by himself, agent <span class="math notranslate nohighlight">\(1\)</span>’s consumption <span class="math notranslate nohighlight">\(c^1(s_t)\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> is</p>
<div class="math notranslate nohighlight">
\[c^1(s_t) = y_t^1 = s_t. \]</div>
<p>But in our model, agent 1 is not alone.</p>
</section>
<section id="nature-and-agents-beliefs">
<h2><a class="toc-backref" href="#id12"><span class="section-number">23.4. </span>Nature and Agents’ Beliefs</a><a class="headerlink" href="#nature-and-agents-beliefs" title="Permalink to this heading">#</a></h2>
<p>Nature draws i.i.d. sequences <span class="math notranslate nohighlight">\(\{s_t\}_{t=0}^\infty\)</span> from <span class="math notranslate nohighlight">\(\pi_t(s^t)\)</span>.</p>
<ul class="simple">
<li><p>so <span class="math notranslate nohighlight">\(\pi\)</span> without a superscript is nature’s model</p></li>
<li><p>but in addition to nature, there are other entities inside our model – artificial people that we call “agents”</p></li>
<li><p>each agent has a sequence of probability distributions over <span class="math notranslate nohighlight">\(s^t\)</span> for <span class="math notranslate nohighlight">\(t=0, \ldots\)</span></p></li>
<li><p>agent <span class="math notranslate nohighlight">\(i\)</span> thinks that nature draws i.i.d. sequences <span class="math notranslate nohighlight">\(\{s_t\}_{t=0}^\infty\)</span> from <span class="math notranslate nohighlight">\(\{\pi_t^i(s^t)\}_{t=0}^\infty\)</span></p>
<ul>
<li><p>agent <span class="math notranslate nohighlight">\(i\)</span> is mistaken unless <span class="math notranslate nohighlight">\(\pi_t^i(s^t) = \pi_t(s^t)\)</span></p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <strong>rational expectations</strong> model would set <span class="math notranslate nohighlight">\(\pi_t^i(s^t) = \pi_t(s^t)\)</span> for all agents <span class="math notranslate nohighlight">\(i\)</span>.</p>
</div>
<p>There are two agents named <span class="math notranslate nohighlight">\(i=1\)</span> and <span class="math notranslate nohighlight">\(i=2\)</span>.</p>
<p>At time <span class="math notranslate nohighlight">\(t\)</span>, agent <span class="math notranslate nohighlight">\(1\)</span> receives an endowment</p>
<div class="math notranslate nohighlight">
\[
y_t^1 = s_t 
\]</div>
<p>of a nonstorable consumption good, while agent <span class="math notranslate nohighlight">\(2\)</span> receives an endowment of</p>
<div class="math notranslate nohighlight">
\[
y_t^2 = 1 - s_t 
\]</div>
<p>The aggregate endowment of the consumption good is</p>
<div class="math notranslate nohighlight">
\[
y_t^1 + y_t^2 = 1
\]</div>
<p>at each date <span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<p>At date <span class="math notranslate nohighlight">\(t\)</span> agent <span class="math notranslate nohighlight">\(i\)</span> consumes <span class="math notranslate nohighlight">\(c_t^i(s^t)\)</span> of the good.</p>
<p>A (non wasteful) feasible allocation of the aggregate endowment of <span class="math notranslate nohighlight">\(1\)</span> each period satisfies</p>
<div class="math notranslate nohighlight">
\[
c_t^1 + c_t^2 = 1 .
\]</div>
</section>
<section id="a-socialist-risk-sharing-arrangement">
<h2><a class="toc-backref" href="#id13"><span class="section-number">23.5. </span>A Socialist Risk-Sharing Arrangement</a><a class="headerlink" href="#a-socialist-risk-sharing-arrangement" title="Permalink to this heading">#</a></h2>
<p>In order to share risks, a benevolent social planner  dictates a history-dependent consumption allocation that takes the form of a sequence of functions</p>
<div class="math notranslate nohighlight">
\[
c_t^i = c_t^i(s^t)
\]</div>
<p>that satisfy</p>
<div class="math notranslate nohighlight" id="equation-eq-feasibility">
<span class="eqno">(23.1)<a class="headerlink" href="#equation-eq-feasibility" title="Permalink to this equation">#</a></span>\[
c_t^1(s^t) + c_t^2(s^t) = 1  
\]</div>
<p>for all <span class="math notranslate nohighlight">\(s^t\)</span> for all <span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<p>To design a socially optimal allocation, the social planner wants to know what agent <span class="math notranslate nohighlight">\(1\)</span> believes about the endowment sequence and how they feel about bearing risks.</p>
<p>As for the endowment sequences, agent <span class="math notranslate nohighlight">\(i\)</span> believes that nature draws i.i.d. sequences from joint densities</p>
<div class="math notranslate nohighlight">
\[
\pi_t^i(s^t) = \pi(s_t)^i \pi^i(s_{t-1}) \cdots \pi^i(s_0)
\]</div>
<p>As for attitudes toward bearing risks, agent <span class="math notranslate nohighlight">\(i\)</span> has a one-period utility function</p>
<div class="math notranslate nohighlight">
\[
u(c_t^i) = \ln (c_t^i)
\]</div>
<p>with marginal utility of consumption in period <span class="math notranslate nohighlight">\(i\)</span></p>
<div class="math notranslate nohighlight">
\[
u'(c_t^i) = \frac{1}{c_t^i}
\]</div>
<p>Putting its beliefs about its random endowment sequence and its attitudes toward bearing risks together, agent <span class="math notranslate nohighlight">\(i\)</span> has intertemporal utility function</p>
<div class="math notranslate nohighlight" id="equation-eq-objectiveagenti">
<span class="eqno">(23.2)<a class="headerlink" href="#equation-eq-objectiveagenti" title="Permalink to this equation">#</a></span>\[
V^i = \sum_{t=0}^{\infty} \sum_{s^t} \delta^t u(c_t^i(s^t)) \pi_t^i(s^t) ,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta \in (0,1)\)</span> is an intertemporal discount factor, and <span class="math notranslate nohighlight">\(u(\cdot)\)</span> is a strictly increasing, concave one-period utility function.</p>
</section>
<section id="social-planners-allocation-problem">
<h2><a class="toc-backref" href="#id14"><span class="section-number">23.6. </span>Social Planner’s Allocation Problem</a><a class="headerlink" href="#social-planners-allocation-problem" title="Permalink to this heading">#</a></h2>
<p>The benevolent dictator has all the information it requires to choose a consumption allocation that maximizes the social welfare criterion</p>
<div class="math notranslate nohighlight" id="equation-eq-welfarew">
<span class="eqno">(23.3)<a class="headerlink" href="#equation-eq-welfarew" title="Permalink to this equation">#</a></span>\[
W = \lambda V^1 + (1-\lambda) V^2
\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda \in [0,1]\)</span> is a Pareto weight that tells how much the planner likes agent <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(1 - \lambda\)</span> is a Pareto weight that tells how much the social planner likes agent <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p>Setting <span class="math notranslate nohighlight">\(\lambda = .5\)</span> expresses ‘‘egalitarian’’ social preferences.</p>
<p>Notice how social welfare criterion <a class="reference internal" href="#equation-eq-welfarew">(23.3)</a> takes into account both agents’ preferences as represented by formula <a class="reference internal" href="#equation-eq-objectiveagenti">(23.2)</a>.</p>
<p>This means that the social planner knows and respects</p>
<ul class="simple">
<li><p>each agent’s one period utility function <span class="math notranslate nohighlight">\(u(\cdot) = \ln(\cdot)\)</span></p></li>
<li><p>each agent <span class="math notranslate nohighlight">\(i\)</span>’s probability model <span class="math notranslate nohighlight">\(\{\pi_t^i(s^t)\}_{t=0}^\infty\)</span></p></li>
</ul>
<p>Consequently, we anticipate that these objects will appear in the social planner’s rule for allocating the aggregate endowment each period.</p>
<p>First-order necessary conditions for maximizing welfare criterion <a class="reference internal" href="#equation-eq-welfarew">(23.3)</a> subject to the feasibility constraint <a class="reference internal" href="#equation-eq-feasibility">(23.1)</a> are</p>
<div class="math notranslate nohighlight">
\[\frac{\pi_t^2(s^t)}{\pi_t^1(s^t)} \frac{(1/c_t^2(s^t))}{(1/c_t^1(s^t))} = \frac{\lambda}{1-\lambda}\]</div>
<p>which can be rearranged to become</p>
<div class="math notranslate nohighlight" id="equation-eq-allocationrule0">
<span class="eqno">(23.4)<a class="headerlink" href="#equation-eq-allocationrule0" title="Permalink to this equation">#</a></span>\[
\frac{c_t^1(s^t)}{c_t^2(s^t)} = \frac{\lambda}{1-\lambda} l_t(s^t)
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ l_t(s^t) = \frac{\pi_t^1(s^t)}{\pi_t^2(s^t)} \]</div>
<p>is the likelihood ratio of agent 1’s joint density to agent 2’s joint density.</p>
<p>Using</p>
<div class="math notranslate nohighlight">
\[c_t^1(s^t) + c_t^2(s^t) = 1\]</div>
<p>we can rewrite allocation rule <a class="reference internal" href="#equation-eq-allocationrule0">(23.4)</a> as</p>
<div class="math notranslate nohighlight">
\[\frac{c_t^1(s^t)}{1 - c_t^1(s^t)} = \frac{\lambda}{1-\lambda} l_t(s^t)\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[c_t^1(s^t) = \frac{\lambda}{1-\lambda} l_t(s^t)(1 - c_t^1(s^t))\]</div>
<p>which implies that the social planner’s allocation rule is</p>
<div class="math notranslate nohighlight" id="equation-eq-allocationrule1">
<span class="eqno">(23.5)<a class="headerlink" href="#equation-eq-allocationrule1" title="Permalink to this equation">#</a></span>\[
c_t^1(s^t) = \frac{\lambda l_t(s^t)}{1-\lambda + \lambda l_t(s^t)}
\]</div>
<p>If we define a temporary or <strong>continuation Pareto weight</strong> process as</p>
<div class="math notranslate nohighlight">
\[
\lambda_t(s^t) = \frac{\lambda l_t(s^t)}{1-\lambda + \lambda l_t(s^t)},
\]</div>
<p>then we can represent the social planner’s allocation rule as</p>
<div class="math notranslate nohighlight">
\[
c_t^1(s^t) = \lambda_t(s^t) .
\]</div>
</section>
<section id="if-youre-so-smart-ldots">
<h2><a class="toc-backref" href="#id15"><span class="section-number">23.7. </span>If You’re So Smart, <span class="math notranslate nohighlight">\(\ldots\)</span></a><a class="headerlink" href="#if-youre-so-smart-ldots" title="Permalink to this heading">#</a></h2>
<p>Let’s compute some values of limiting allocations <a class="reference internal" href="#equation-eq-allocationrule1">(23.5)</a> for some interesting possible limiting
values of the likelihood ratio process <span class="math notranslate nohighlight">\(l_t(s^t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[l_\infty (s^\infty)= 1; \quad c_\infty^1 = \lambda\]</div>
<ul class="simple">
<li><p>In the above case, both agents are equally smart (or equally not smart) and the consumption allocation stays put at a <span class="math notranslate nohighlight">\(\lambda, 1 - \lambda\)</span> split between the two agents.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[l_\infty (s^\infty) = 0; \quad c_\infty^1 = 0\]</div>
<ul class="simple">
<li><p>In the above case, agent 2 is ‘‘smarter’’ than agent 1, and agent 1’s share of the aggregate endowment converges to zero.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[l_\infty (s^\infty)= \infty; \quad c_\infty^1 = 1\]</div>
<ul class="simple">
<li><p>In the above case, agent 1 is smarter than agent 2, and agent 1’s share of the aggregate endowment converges to 1.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These three cases are somehow telling us about how relative <strong>wealths</strong> of the agents evolve as time passes.</p>
<ul class="simple">
<li><p>when the two agents are equally smart and <span class="math notranslate nohighlight">\(\lambda \in (0,1)\)</span>, agent 1’s wealth share stays at <span class="math notranslate nohighlight">\(\lambda\)</span> perpetually.</p></li>
<li><p>when agent 1 is smarter and <span class="math notranslate nohighlight">\(\lambda \in (0,1)\)</span>, agent 1 eventually “owns” the entire continuation endowment and agent 2 eventually “owns” nothing.</p></li>
<li><p>when agent 2 is smarter and <span class="math notranslate nohighlight">\(\lambda \in (0,1)\)</span>, agent 2 eventually “owns” the entire continuation endowment and agent 1 eventually “owns” nothing.
Continuation wealths can be defined precisely after we introduce a competitive equilibrium <strong>price</strong> system below.</p></li>
</ul>
</div>
<p>Soon we’ll do some simulations that will shed further light on possible outcomes.</p>
<p>But before we do that, let’s take a detour and study some  “shadow prices” for the social planning problem that can readily be
converted to “equilibrium prices” for a competitive equilibrium.</p>
<p>Doing this will allow us to connect our analysis with an argument of <span id="id6">[<a class="reference internal" href="zreferences.html#id7" title="Armen A Alchian. Uncertainty, evolution, and economic theory. Journal of political economy, 58(3):211–221, 1950.">Alchian, 1950</a>]</span> and <span id="id7">[<a class="reference internal" href="zreferences.html#id6" title="Milton Friedman. Essays in positive economics. University of Chicago press, 1953.">Friedman, 1953</a>]</span> that competitive market processes can make prices of risky assets better reflect realistic probability assessments.</p>
</section>
<section id="competitive-equilibrium-prices">
<h2><a class="toc-backref" href="#id16"><span class="section-number">23.8. </span>Competitive Equilibrium Prices</a><a class="headerlink" href="#competitive-equilibrium-prices" title="Permalink to this heading">#</a></h2>
<p>Two fundamental welfare theorems for general equilibrium models lead us to anticipate that there is  a connection between the allocation that solves the social planning problem we have been studying and the allocation in a  <strong>competitive equilibrium</strong>  with complete markets in history-contingent commodities.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the two welfare theorems and their history, see   <a class="reference external" href="https://en.wikipedia.org/wiki/Fundamental_theorems_of_welfare_economics">https://en.wikipedia.org/wiki/Fundamental_theorems_of_welfare_economics</a>.
Again, for applications to a classic  macroeconomic growth  model, see <a class="reference internal" href="cass_koopmans_1.html"><span class="doc">this lecture on a planning problem</span></a>  and <a class="reference internal" href="cass_koopmans_2.html"><span class="doc">this lecture on a related competitive equilibrium</span></a></p>
</div>
<p>Such a connection prevails for our model.</p>
<p>We’ll sketch it now.</p>
<p>In a competitive equilibrium, there is no social planner that dictatorially collects everybody’s endowments and then reallocates them.</p>
<p>Instead, there is a comprehensive centralized   market that meets at one point in time.</p>
<p>There are <strong>prices</strong> at which price-taking agents can buy or sell whatever goods that they want.</p>
<p>Trade is multilateral in the sense that that there is a “Walrasian auctioneer” who lives outside the model and whose job is to verify that
each agent’s budget constraint is satisfied.</p>
<p>That budget constraint involves the total value of the agent’s endowment stream and the total value of its consumption stream.</p>
<p>These values are computed at price vectors that the agents take as given – they are “price-takers” who assume that they can buy or sell
whatever quantities that they want at those prices.</p>
<p>Suppose that at time <span class="math notranslate nohighlight">\(-1\)</span>, before time <span class="math notranslate nohighlight">\(0\)</span> starts, agent <span class="math notranslate nohighlight">\(i\)</span> can purchase one unit <span class="math notranslate nohighlight">\(c_t(s^t)\)</span> of consumption at time <span class="math notranslate nohighlight">\(t\)</span> after history
<span class="math notranslate nohighlight">\(s^t\)</span> at price <span class="math notranslate nohighlight">\(p_t(s^t)\)</span>.</p>
<p>Notice that there is (very long) <strong>vector</strong> of prices.</p>
<ul class="simple">
<li><p>there is one price <span class="math notranslate nohighlight">\(p_t(s^t)\)</span> for each history <span class="math notranslate nohighlight">\(s^t\)</span> at every date <span class="math notranslate nohighlight">\(t = 0, 1, \ldots, \)</span>.</p></li>
<li><p>so there are as many prices as there are histories and dates.</p></li>
</ul>
<p>These prices determined at time <span class="math notranslate nohighlight">\(-1\)</span> before the economy starts.</p>
<p>The market meets once at time <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<p>At times <span class="math notranslate nohighlight">\(t =0, 1, 2, \ldots\)</span> trades made at time <span class="math notranslate nohighlight">\(-1\)</span> are executed.</p>
<ul class="simple">
<li><p>in the background, there is an “enforcement” procedure that forces agents to carry out the exchanges or “deliveries”  that they agreed to at time <span class="math notranslate nohighlight">\(-1\)</span>.</p></li>
</ul>
<p>We want to study how agents’  beliefs influence equilibrium prices.</p>
<p>Agent <span class="math notranslate nohighlight">\(i\)</span> faces a <strong>single</strong> intertemporal budget constraint</p>
<div class="math notranslate nohighlight" id="equation-eq-budgeti">
<span class="eqno">(23.6)<a class="headerlink" href="#equation-eq-budgeti" title="Permalink to this equation">#</a></span>\[
\sum_{t=0}^\infty\sum_{s^t} p_t(s^t) c_t^i (s^t) \leq \sum_{t=0}^\infty\sum_{s^t} p_t(s^t) y_t^i (s^t)
\]</div>
<p>According to budget constraint <a class="reference internal" href="#equation-eq-budgeti">(23.6)</a>,  trade is <strong>multilateral</strong> in the following  sense</p>
<ul class="simple">
<li><p>we can imagine  that  agent <span class="math notranslate nohighlight">\(i\)</span> first sells his random endowment stream <span class="math notranslate nohighlight">\(\{y_t^i (s^t)\}\)</span> and then uses the proceeds (i.e., his “wealth”) to purchase a random consumption stream <span class="math notranslate nohighlight">\(\{c_t^i (s^t)\}\)</span>.</p></li>
</ul>
<p>Agent <span class="math notranslate nohighlight">\(i\)</span> puts a Lagrange multiplier <span class="math notranslate nohighlight">\(\mu_i\)</span> on <a class="reference internal" href="#equation-eq-budgeti">(23.6)</a> and once-and-for-all chooses a consumption plan <span class="math notranslate nohighlight">\(\{c^i_t(s^t)\}_{t=0}^\infty\)</span>
to maximize criterion <a class="reference internal" href="#equation-eq-objectiveagenti">(23.2)</a> subject to budget constraint <a class="reference internal" href="#equation-eq-budgeti">(23.6)</a>.</p>
<p>This means that the agent <span class="math notranslate nohighlight">\(i\)</span>  chooses many objects, namely, <span class="math notranslate nohighlight">\(c_t^i(s^t)\)</span> for all <span class="math notranslate nohighlight">\(s^t\)</span> for <span class="math notranslate nohighlight">\(t = 0, 1, 2, \ldots\)</span>.</p>
<p>For convenience, let’s remind ourselves of criterion <span class="math notranslate nohighlight">\(V^i\)</span> defined in <a class="reference internal" href="#equation-eq-objectiveagenti">(23.2)</a>:</p>
<div class="math notranslate nohighlight">
\[
V^i = \sum_{t=0}^{\infty} \sum_{s^t} \delta^t u(c_t^i(s^t)) \pi_t^i(s^t)
\]</div>
<p>First-order necessary conditions for maximizing objective <span class="math notranslate nohighlight">\(V^i\)</span> defined in <a class="reference internal" href="#equation-eq-objectiveagenti">(23.2)</a> with respect to <span class="math notranslate nohighlight">\(c_t^i(s^t)\)</span> are</p>
<div class="math notranslate nohighlight">
\[
\delta^t u'(c^i_t(s^t)) \pi_t^i(s^t) = \mu_i p_t(s^t) ,
\]</div>
<p>which we can rearrange to obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-priceequation1">
<span class="eqno">(23.7)<a class="headerlink" href="#equation-eq-priceequation1" title="Permalink to this equation">#</a></span>\[
p_t(s^t) = \frac{ \delta^t \pi_t^i(s^t)}{\mu_i c^i_t(s^t)}   
\]</div>
<p>for <span class="math notranslate nohighlight">\(i=1,2\)</span>.</p>
<p>If we divide equation <a class="reference internal" href="#equation-eq-priceequation1">(23.7)</a> for agent <span class="math notranslate nohighlight">\(1\)</span> by the appropriate  version of equation <a class="reference internal" href="#equation-eq-priceequation1">(23.7)</a> for agent 2, use
<span class="math notranslate nohighlight">\(c^2_t(s^t) = 1 - c^1_t(s^t)\)</span>, and do some algebra, we’ll obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-allocationce">
<span class="eqno">(23.8)<a class="headerlink" href="#equation-eq-allocationce" title="Permalink to this equation">#</a></span>\[
c_t^1(s^t) = \frac{\mu_1 l_t(s^t)}{\mu_2 + \mu_1 l_t(s^t)} .
\]</div>
<p>We now engage in an extended “guess-and-verify” exercise that involves matching objects in our competitive equilibrium with objects in
our social planning problem.</p>
<ul class="simple">
<li><p>we’ll match consumption allocations in the planning problem with equilibrium consumption allocations in the competitive equilibrium</p></li>
<li><p>we’ll match “shadow” prices in the planning problem with competitive equilibrium prices.</p></li>
</ul>
<p>Notice that if we set <span class="math notranslate nohighlight">\(\mu_1 = 1-\lambda\)</span> and <span class="math notranslate nohighlight">\(\mu_2 = \lambda\)</span>, then  formula <a class="reference internal" href="#equation-eq-allocationce">(23.8)</a> agrees with formula
<a class="reference internal" href="#equation-eq-allocationrule1">(23.5)</a>.</p>
<ul class="simple">
<li><p>doing this amounts to choosing a <strong>numeraire</strong> or normalization for the price system <span class="math notranslate nohighlight">\(\{p_t(s^t)\}_{t=0}^\infty\)</span></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For information about how a numeraire  must be chosen to pin down the absolute price level in a model like ours that determines only
relative prices,   see <a class="reference external" href="https://en.wikipedia.org/wiki/Num%C3%A9raire">https://en.wikipedia.org/wiki/Numéraire</a>.</p>
</div>
<p>If we substitute formula  <a class="reference internal" href="#equation-eq-allocationce">(23.8)</a> for <span class="math notranslate nohighlight">\(c_t^1(s^t)\)</span> into formula <a class="reference internal" href="#equation-eq-priceequation1">(23.7)</a> and rearrange, we obtain</p>
<div class="math notranslate nohighlight">
\[
p_t(s^t) = \frac{\delta^t}{\lambda(1-\lambda)} \pi_t^2(s^t) \bigl[1 - \lambda + \lambda l_t(s^t)\bigr]
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-eq-pformulafinal">
<span class="eqno">(23.9)<a class="headerlink" href="#equation-eq-pformulafinal" title="Permalink to this equation">#</a></span>\[
p_t(s^t) = \frac{\delta^t}{\lambda(1-\lambda)}  \bigl[(1 - \lambda) \pi_t^2(s^t) + \lambda \pi_t^1(s^t)\bigr]
\]</div>
<p>According to formula <a class="reference internal" href="#equation-eq-pformulafinal">(23.9)</a>, we have the following possible limiting cases:</p>
<ul class="simple">
<li><p>when <span class="math notranslate nohighlight">\(l_\infty = 0\)</span>, <span class="math notranslate nohighlight">\(c_\infty^1 = 0 \)</span> and tails of competitive equilibrium prices reflect agent <span class="math notranslate nohighlight">\(2\)</span>’s probability model <span class="math notranslate nohighlight">\(\pi_t^2(s^t)\)</span> according to <span class="math notranslate nohighlight">\(p_t(s^t) \propto \delta^t \pi_t^2(s^t) \)</span></p></li>
<li><p>when <span class="math notranslate nohighlight">\(l_\infty = \infty\)</span>, <span class="math notranslate nohighlight">\(c_\infty^1 = 1 \)</span> and tails of competitive equilibrium prices reflect agent <span class="math notranslate nohighlight">\(1\)</span>’s probability model <span class="math notranslate nohighlight">\(\pi_t^1(s^t)\)</span> according to <span class="math notranslate nohighlight">\(p_t(s^t) \propto \delta^t \pi_t^1(s^t) \)</span></p></li>
<li><p>for small <span class="math notranslate nohighlight">\(t\)</span>’s, competitive equilibrium prices reflect both agents’ probability models.</p></li>
</ul>
</section>
<section id="simulations">
<h2><a class="toc-backref" href="#id17"><span class="section-number">23.9. </span>Simulations</a><a class="headerlink" href="#simulations" title="Permalink to this heading">#</a></h2>
<p>Now let’s implement some simulations when agent <span class="math notranslate nohighlight">\(1\)</span> believes marginal density</p>
<div class="math notranslate nohighlight">
\[\pi^1(s_t) = f(s_t) \]</div>
<p>and agent <span class="math notranslate nohighlight">\(2\)</span> believes marginal density</p>
<div class="math notranslate nohighlight">
\[ \pi^2(s_t) = g(s_t) \]</div>
<p>where <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> are Beta distributions like ones that  we used in earlier  sections of this lecture.</p>
<p>Meanwhile, we’ll assume that  nature believes a  marginal density</p>
<div class="math notranslate nohighlight">
\[
\pi(s_t) = h(s_t) 
\]</div>
<p>where <span class="math notranslate nohighlight">\(h(s_t)\)</span> is perhaps a  mixture of <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>First, we write a function to compute the likelihood ratio process</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_likelihood_ratios</span><span class="p">(</span><span class="n">sequences</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute likelihood ratios and cumulative products.&quot;&quot;&quot;</span>
    <span class="n">l_ratios</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">sequences</span><span class="p">)</span> <span class="o">/</span> <span class="n">g</span><span class="p">(</span><span class="n">sequences</span><span class="p">)</span>
    <span class="n">L_cumulative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">l_ratios</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">l_ratios</span><span class="p">,</span> <span class="n">L_cumulative</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s compute the Kullback–Leibler discrepancies by quadrature
integration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_KL</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute KL divergence KL(f, g)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">integrand</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="n">g</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
    <span class="n">val</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">integrand</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">1e-5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span>
</pre></div>
</div>
</div>
</div>
<p>We also create a helper function to compute KL divergence with respect to a reference distribution <span class="math notranslate nohighlight">\(h\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_KL_h</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute KL divergence with reference distribution h</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Kf</span> <span class="o">=</span> <span class="n">compute_KL</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">Kg</span> <span class="o">=</span> <span class="n">compute_KL</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Kf</span><span class="p">,</span> <span class="n">Kg</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s  write a Python function that computes agent 1’s  consumption share</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simulate_blume_easley</span><span class="p">(</span><span class="n">sequences</span><span class="p">,</span> <span class="n">f_belief</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">g_belief</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">λ</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate Blume-Easley model consumption shares.&quot;&quot;&quot;</span>
    <span class="n">l_ratios</span><span class="p">,</span> <span class="n">l_cumulative</span> <span class="o">=</span> <span class="n">compute_likelihood_ratios</span><span class="p">(</span><span class="n">sequences</span><span class="p">,</span> <span class="n">f_belief</span><span class="p">,</span> <span class="n">g_belief</span><span class="p">)</span>
    <span class="n">c1_share</span> <span class="o">=</span> <span class="n">λ</span> <span class="o">*</span> <span class="n">l_cumulative</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">λ</span> <span class="o">+</span> <span class="n">λ</span> <span class="o">*</span> <span class="n">l_cumulative</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">l_cumulative</span><span class="p">,</span> <span class="n">c1_share</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s use this function to generate sequences in which</p>
<ul class="simple">
<li><p>nature draws from <span class="math notranslate nohighlight">\(f\)</span> each period, or</p></li>
<li><p>nature draws from <span class="math notranslate nohighlight">\(g\)</span> each period, or</p></li>
<li><p>nature flips a fair coin each period to decide whether to draw from <span class="math notranslate nohighlight">\(f\)</span> or <span class="math notranslate nohighlight">\(g\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Nature follows f, g, or mixture</span>
<span class="n">s_seq_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">F_a</span><span class="p">,</span> <span class="n">F_b</span><span class="p">,</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>
<span class="n">s_seq_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">G_a</span><span class="p">,</span> <span class="n">G_b</span><span class="p">,</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>

<span class="n">h</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">model_choices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.5</span>
<span class="n">s_seq_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>
<span class="n">s_seq_h</span><span class="p">[</span><span class="n">model_choices</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">F_a</span><span class="p">,</span> <span class="n">F_b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">model_choices</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">s_seq_h</span><span class="p">[</span><span class="o">~</span><span class="n">model_choices</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">G_a</span><span class="p">,</span> <span class="n">G_b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="o">~</span><span class="n">model_choices</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">l_cum_f</span><span class="p">,</span> <span class="n">c1_f</span> <span class="o">=</span> <span class="n">simulate_blume_easley</span><span class="p">(</span><span class="n">s_seq_f</span><span class="p">)</span>
<span class="n">l_cum_g</span><span class="p">,</span> <span class="n">c1_g</span> <span class="o">=</span> <span class="n">simulate_blume_easley</span><span class="p">(</span><span class="n">s_seq_g</span><span class="p">)</span>
<span class="n">l_cum_h</span><span class="p">,</span> <span class="n">c1_h</span> <span class="o">=</span> <span class="n">simulate_blume_easley</span><span class="p">(</span><span class="n">s_seq_h</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Before looking at the figure below, have some fun by guessing whether agent 1 or agent 2 will have a larger and larger consumption share as time passes in our three cases.</p>
<p>To make better guesses,  let’s visualize instances of the likelihood ratio processes in  the three cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Nature = f&quot;</span><span class="p">,</span> <span class="s2">&quot;Nature = g&quot;</span><span class="p">,</span> <span class="s2">&quot;Nature = mixture&quot;</span><span class="p">]</span>
<span class="n">data_pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">l_cum_f</span><span class="p">,</span> <span class="n">c1_f</span><span class="p">),</span> <span class="p">(</span><span class="n">l_cum_g</span><span class="p">,</span> <span class="n">c1_g</span><span class="p">),</span> <span class="p">(</span><span class="n">l_cum_h</span><span class="p">,</span> <span class="n">c1_h</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">l_cum</span><span class="p">,</span> <span class="n">c1</span><span class="p">),</span> <span class="n">title</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data_pairs</span><span class="p">,</span> <span class="n">titles</span><span class="p">)):</span>
    <span class="c1"># Likelihood ratios</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">l_cum</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">l_cum</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Likelihood ratio $l_t$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="c1"># Consumption shares</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">c1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c1</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Agent 1&#39;s consumption share&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">λ</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9fd98c4c99a41169f444c716060a173c5948cbb7bab15d3441aac4d3c27c5516.png" src="_images/9fd98c4c99a41169f444c716060a173c5948cbb7bab15d3441aac4d3c27c5516.png" />
</div>
</div>
<p>In the left panel, nature chooses <span class="math notranslate nohighlight">\(f\)</span>. Agent 1’s consumption reaches <span class="math notranslate nohighlight">\(1\)</span> very quickly.</p>
<p>In the middle panel, nature chooses <span class="math notranslate nohighlight">\(g\)</span>. Agent 1’s consumption ratio tends to move towards <span class="math notranslate nohighlight">\(0\)</span> but not as fast as in the first case.</p>
<p>In the right panel, nature flips coins each period. We see a very similar pattern to the processes in the left panel.</p>
<p>The figures in the top panel remind us of the discussion in <a class="reference internal" href="likelihood_ratio_process.html#kl-link"><span class="std std-ref">this section</span></a>.</p>
<p>We invite readers to revisit <a class="reference internal" href="likelihood_ratio_process.html#llr-h"><span class="std std-ref">that section</span></a> and try to infer the relationships among <span class="math notranslate nohighlight">\(D_{KL}(f\|g)\)</span>, <span class="math notranslate nohighlight">\(D_{KL}(g\|f)\)</span>, <span class="math notranslate nohighlight">\(D_{KL}(h\|f)\)</span>, and <span class="math notranslate nohighlight">\(D_{KL}(h\|g)\)</span>.</p>
<p>Let’s compute values of KL divergence</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shares</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">c1_f</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">c1_g</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">c1_h</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
<span class="n">Kf_g</span><span class="p">,</span> <span class="n">Kg_f</span> <span class="o">=</span> <span class="n">compute_KL</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="n">compute_KL</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="n">Kf_h</span><span class="p">,</span> <span class="n">Kg_h</span> <span class="o">=</span> <span class="n">compute_KL_h</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final shares: f=</span><span class="si">{</span><span class="n">shares</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, g=</span><span class="si">{</span><span class="n">shares</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, mix=</span><span class="si">{</span><span class="n">shares</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KL divergences: </span><span class="se">\n</span><span class="s2">KL(f,g)=</span><span class="si">{</span><span class="n">Kf_g</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, KL(g,f)=</span><span class="si">{</span><span class="n">Kg_f</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KL(h,f)=</span><span class="si">{</span><span class="n">Kf_h</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, KL(h,g)=</span><span class="si">{</span><span class="n">Kg_h</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final shares: f=1.000, g=0.000, mix=0.927
KL divergences: 
KL(f,g)=0.759, KL(g,f)=0.344
KL(h,f)=0.073, KL(h,g)=0.281
</pre></div>
</div>
</div>
</div>
<p>We find that <span class="math notranslate nohighlight">\(KL(f,g) &gt; KL(g,f)\)</span> and <span class="math notranslate nohighlight">\(KL(h,g) &gt; KL(h,f)\)</span>.</p>
<p>The first inequality tells us that the average “surprise” from having belief <span class="math notranslate nohighlight">\(g\)</span> when nature chooses <span class="math notranslate nohighlight">\(f\)</span> is greater than the “surprise” from having  belief <span class="math notranslate nohighlight">\(f\)</span> when nature chooses <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>This explains the difference between the first two panels we noted above.</p>
<p>The second inequality tells us that agent 1’s belief distribution <span class="math notranslate nohighlight">\(f\)</span> is closer to nature’s pick than agent 2’s belief <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>To make this idea more concrete, let’s compare two cases:</p>
<ul class="simple">
<li><p>agent 1’s belief distribution <span class="math notranslate nohighlight">\(f\)</span> is close to agent 2’s belief distribution <span class="math notranslate nohighlight">\(g\)</span>;</p></li>
<li><p>agent 1’s belief distribution <span class="math notranslate nohighlight">\(f\)</span> is far from agent 2’s belief distribution <span class="math notranslate nohighlight">\(g\)</span>.</p></li>
</ul>
<p>We use the two distributions visualized below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_distribution_overlap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">f_vals</span><span class="p">,</span> <span class="n">g_vals</span><span class="p">,</span> 
                            <span class="n">f_label</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="n">g_label</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> 
                            <span class="n">f_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">g_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot two distributions with their overlap region.&quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">f_vals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">f_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">f_label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">g_vals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">g_color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">g_label</span><span class="p">)</span>
    
    <span class="n">overlap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">f_vals</span><span class="p">,</span> <span class="n">g_vals</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Overlap&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
<span class="c1"># Define close and far belief distributions</span>
<span class="n">f_close</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">g_close</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">))</span>

<span class="n">f_far</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">g_far</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>

<span class="c1"># Visualize the belief distributions</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Close beliefs</span>
<span class="n">f_close_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">f_close</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_range</span><span class="p">]</span>
<span class="n">g_close_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">g_close</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_range</span><span class="p">]</span>
<span class="n">plot_distribution_overlap</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">f_close_vals</span><span class="p">,</span> <span class="n">g_close_vals</span><span class="p">,</span>
                         <span class="n">f_label</span><span class="o">=</span><span class="s1">&#39;f (Beta(1, 1))&#39;</span><span class="p">,</span> <span class="n">g_label</span><span class="o">=</span><span class="s1">&#39;g (Beta(1.1, 1.05))&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Close Beliefs&#39;</span><span class="p">)</span>

<span class="c1"># Far beliefs</span>
<span class="n">f_far_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">f_far</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_range</span><span class="p">]</span>
<span class="n">g_far_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">g_far</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_range</span><span class="p">]</span>
<span class="n">plot_distribution_overlap</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">x_range</span><span class="p">,</span> <span class="n">f_far_vals</span><span class="p">,</span> <span class="n">g_far_vals</span><span class="p">,</span>
                         <span class="n">f_label</span><span class="o">=</span><span class="s1">&#39;f (Beta(1, 1))&#39;</span><span class="p">,</span> <span class="n">g_label</span><span class="o">=</span><span class="s1">&#39;g (Beta(3, 1.2))&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Far Beliefs&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cf48a67dd8357ed1c3ef1c9901bacf79f6e66c90209f496058a1c5a62d1ee386.png" src="_images/cf48a67dd8357ed1c3ef1c9901bacf79f6e66c90209f496058a1c5a62d1ee386.png" />
</div>
</div>
<p>Let’s draw the same consumption ratio plots as above for agent 1.</p>
<p>We replace the simulation paths with median and percentiles to make the figure cleaner.</p>
<p>Staring at the figure below, can we infer the relation between <span class="math notranslate nohighlight">\(KL(f,g)\)</span> and <span class="math notranslate nohighlight">\(KL(g,f)\)</span>?</p>
<p>From the right panel, can we infer the relation between <span class="math notranslate nohighlight">\(KL(h,g)\)</span> and <span class="math notranslate nohighlight">\(KL(h,f)\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">nature_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;close&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)],</span>
                 <span class="s1">&#39;far&#39;</span><span class="p">:</span>   <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span>   <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)]}</span>
<span class="n">nature_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Nature = f&quot;</span><span class="p">,</span> <span class="s2">&quot;Nature = g&quot;</span><span class="p">,</span> <span class="s2">&quot;Nature = h&quot;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;close&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;far&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span>

<span class="n">threshold</span> <span class="o">=</span> <span class="mf">1e-5</span>  <span class="c1"># &quot;close to zero&quot; cutoff</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">f_belief</span><span class="p">,</span> <span class="n">g_belief</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span>
                        <span class="p">(</span><span class="n">f_close</span><span class="p">,</span> <span class="n">g_close</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">f_far</span><span class="p">,</span> <span class="n">g_far</span><span class="p">,</span> <span class="s1">&#39;far&#39;</span><span class="p">)]):</span>
    
    <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">nature_label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nature_labels</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">nature_params</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
        <span class="n">s_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">simulate_blume_easley</span><span class="p">(</span><span class="n">s_seq</span><span class="p">,</span> <span class="n">f_belief</span><span class="p">,</span> <span class="n">g_belief</span><span class="p">,</span> <span class="n">λ</span><span class="p">)</span>
        
        <span class="n">median_c1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">p10</span><span class="p">,</span> <span class="n">p90</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">median_c1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Median&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">median_c1</span><span class="p">)),</span> <span class="n">p10</span><span class="p">,</span> <span class="n">p90</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;10–90%&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Agent 1&#39;s share&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">nature_label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">λ</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">below</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">median_c1</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">above</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">median_c1</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">-</span><span class="n">threshold</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">below</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">first_zero</span> <span class="o">=</span> <span class="p">(</span><span class="n">below</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">above</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="n">first_zero</span> <span class="o">=</span> <span class="p">(</span><span class="n">above</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">first_zero</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">first_zero</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">first_zero</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> 
                       <span class="n">label</span><span class="o">=</span><span class="sa">fr</span><span class="s1">&#39;Median $\leq$ </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">first_zero</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                       <span class="k">else</span> <span class="sa">fr</span><span class="s1">&#39;Median $\geq$ 1-</span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/af4c6d3178b04879baa58c3f2aea492d2549a3811e903fd4b6fa5a9acca838ae.png" src="_images/af4c6d3178b04879baa58c3f2aea492d2549a3811e903fd4b6fa5a9acca838ae.png" />
</div>
</div>
<p>Holding to our guesses, let’s calculate the four values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Close case</span>
<span class="n">Kf_g</span><span class="p">,</span> <span class="n">Kg_f</span> <span class="o">=</span> <span class="n">compute_KL</span><span class="p">(</span><span class="n">f_close</span><span class="p">,</span> <span class="n">g_close</span><span class="p">),</span> <span class="n">compute_KL</span><span class="p">(</span><span class="n">g_close</span><span class="p">,</span> <span class="n">f_close</span><span class="p">)</span>
<span class="n">Kf_h</span><span class="p">,</span> <span class="n">Kg_h</span> <span class="o">=</span> <span class="n">compute_KL_h</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">f_close</span><span class="p">,</span> <span class="n">g_close</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KL divergences (close): </span><span class="se">\n</span><span class="s2">KL(f,g)=</span><span class="si">{</span><span class="n">Kf_g</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, KL(g,f)=</span><span class="si">{</span><span class="n">Kg_f</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KL(h,f)=</span><span class="si">{</span><span class="n">Kf_h</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, KL(h,g)=</span><span class="si">{</span><span class="n">Kg_h</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Far case</span>
<span class="n">Kf_g</span><span class="p">,</span> <span class="n">Kg_f</span> <span class="o">=</span> <span class="n">compute_KL</span><span class="p">(</span><span class="n">f_far</span><span class="p">,</span> <span class="n">g_far</span><span class="p">),</span> <span class="n">compute_KL</span><span class="p">(</span><span class="n">g_far</span><span class="p">,</span> <span class="n">f_far</span><span class="p">)</span>
<span class="n">Kf_h</span><span class="p">,</span> <span class="n">Kg_h</span> <span class="o">=</span> <span class="n">compute_KL_h</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">f_far</span><span class="p">,</span> <span class="n">g_far</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KL divergences (far): </span><span class="se">\n</span><span class="s2">KL(f,g)=</span><span class="si">{</span><span class="n">Kf_g</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, KL(g,f)=</span><span class="si">{</span><span class="n">Kg_f</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KL(h,f)=</span><span class="si">{</span><span class="n">Kf_h</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, KL(h,g)=</span><span class="si">{</span><span class="n">Kg_h</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KL divergences (close): 
KL(f,g)=0.003, KL(g,f)=0.003
KL(h,f)=0.073, KL(h,g)=0.061
KL divergences (far): 
KL(f,g)=0.759, KL(g,f)=0.344
KL(h,f)=0.073, KL(h,g)=0.281
</pre></div>
</div>
</div>
</div>
<p>We find that in the first case, <span class="math notranslate nohighlight">\(KL(f,g) \approx KL(g,f)\)</span> and both are relatively small, so although either agent 1 or agent 2 will eventually consume everything, convergence displayed in the first two panels on the top is pretty slow.</p>
<p>In the first two panels at the bottom, we see convergence occurring faster (as indicated by the black dashed line) because the divergence gaps <span class="math notranslate nohighlight">\(KL(f, g)\)</span> and <span class="math notranslate nohighlight">\(KL(g, f)\)</span> are larger.</p>
<p>Since <span class="math notranslate nohighlight">\(KL(f,g) &gt; KL(g,f)\)</span>, we see faster convergence in the first panel at the bottom when nature chooses <span class="math notranslate nohighlight">\(f\)</span> than in the second panel where nature chooses <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>This ties in nicely with <a class="reference internal" href="likelihood_ratio_process.html#equation-eq-kl-likelihood-link">(22.1)</a>.</p>
</section>
<section id="related-lectures">
<h2><a class="toc-backref" href="#id18"><span class="section-number">23.10. </span>Related Lectures</a><a class="headerlink" href="#related-lectures" title="Permalink to this heading">#</a></h2>
<p>Likelihood processes play an important role in Bayesian learning, as described in <a class="reference internal" href="likelihood_bayes.html"><span class="doc">Likelihood Ratio Processes and Bayesian Learning</span></a>
and as applied in <a class="reference internal" href="odu.html"><span class="doc">Job Search VII: Search with Learning</span></a>.</p>
<p>Likelihood ratio processes appear again in <a class="reference external" href="https://python-advanced.quantecon.org/additive_functionals.html" title="(in Python)"><span>Additive and Multiplicative Functionals</span></a>.</p>
</section>
<section id="exercise">
<h2><a class="toc-backref" href="#id19"><span class="section-number">23.11. </span>Exercise</a><a class="headerlink" href="#exercise" title="Permalink to this heading">#</a></h2>
<div class="exercise admonition" id="lr_ex3">

<p class="admonition-title"><span class="caption-number">Exercise 23.1 </span></p>
<section id="exercise-content">
<p>Starting from <a class="reference internal" href="#equation-eq-priceequation1">(23.7)</a>, show that the competitive equilibrium prices can be expressed as</p>
<div class="math notranslate nohighlight">
\[
p_t(s^t) = \frac{\delta^t}{\lambda(1-\lambda)} \pi_t^2(s^t) \bigl[1 - \lambda + \lambda l_t(s^t)\bigr]
\]</div>
</section>
</div>
<div class="solution dropdown admonition" id="likelihood_ratio_process_2-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#lr_ex3"> Exercise 23.1</a></p>
<section id="solution-content">
<p>Starting from</p>
<div class="math notranslate nohighlight">
\[
p_t(s^t) = \frac{\delta^t \pi_t^i(s^t)}{\mu_i c_t^i(s^t)}, \qquad i=1,2.
\]</div>
<p>Since both expressions equal the same price, we can equate them</p>
<div class="math notranslate nohighlight">
\[
\frac{\pi_t^1(s^t)}{\mu_1 c_t^1(s^t)} = \frac{\pi_t^2(s^t)}{\mu_2 c_t^2(s^t)}
\]</div>
<p>Rearranging gives</p>
<div class="math notranslate nohighlight">
\[
\frac{c_t^1(s^t)}{c_t^2(s^t)} = \frac{\mu_2}{\mu_1} l_t(s^t)
\]</div>
<p>where <span class="math notranslate nohighlight">\(l_t(s^t) \equiv \pi_t^1(s^t)/\pi_t^2(s^t)\)</span> is the likelihood ratio process.</p>
<p>Using <span class="math notranslate nohighlight">\(c_t^2(s^t) = 1 - c_t^1(s^t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\frac{c_t^1(s^t)}{1 - c_t^1(s^t)} = \frac{\mu_2}{\mu_1} l_t(s^t)
\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(c_t^1(s^t)\)</span></p>
<div class="math notranslate nohighlight">
\[
c_t^1(s^t) = \frac{\mu_2 l_t(s^t)}{\mu_1 + \mu_2 l_t(s^t)}
\]</div>
<p>The planner’s solution gives</p>
<div class="math notranslate nohighlight">
\[
c_t^1(s^t) = \frac{\lambda l_t(s^t)}{1 - \lambda + \lambda l_t(s^t)}
\]</div>
<p>To match them, we need the following equality to hold</p>
<div class="math notranslate nohighlight">
\[
\frac{\mu_2}{\mu_1} = \frac{\lambda}{1 - \lambda}
\]</div>
<p>Hence we have</p>
<div class="math notranslate nohighlight">
\[
\mu_1 = 1 - \lambda, \qquad \mu_2 = \lambda
\]</div>
<p>With <span class="math notranslate nohighlight">\(\mu_1 = 1-\lambda\)</span> and <span class="math notranslate nohighlight">\(c_t^1(s^t) = \frac{\lambda l_t(s^t)}{1-\lambda+\lambda l_t(s^t)}\)</span>,
we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
p_t(s^t) &amp;= \frac{\delta^t \pi_t^1(s^t)}{(1-\lambda) c_t^1(s^t)} \\
&amp;= \frac{\delta^t \pi_t^1(s^t)}{(1-\lambda)} \cdot \frac{1 - \lambda + \lambda l_t(s^t)}{\lambda l_t(s^t)} \\
&amp;= \frac{\delta^t \pi_t^1(s^t)}{(1-\lambda)\lambda l_t(s^t)} \bigl[1 - \lambda + \lambda l_t(s^t)\bigr].
\end{aligned}
\end{split}\]</div>
<p>Since <span class="math notranslate nohighlight">\(\pi_t^1(s^t) = l_t(s^t) \pi_t^2(s^t)\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
p_t(s^t) &amp;= \frac{\delta^t l_t(s^t) \pi_t^2(s^t)}{(1-\lambda)\lambda l_t(s^t)} \bigl[1 - \lambda + \lambda l_t(s^t)\bigr] \\
&amp;= \frac{\delta^t \pi_t^2(s^t)}{(1-\lambda)\lambda} \bigl[1 - \lambda + \lambda l_t(s^t)\bigr] \\
&amp;= \frac{\delta^t}{\lambda(1-\lambda)} \pi_t^2(s^t) \bigl[1 - \lambda + \lambda l_t(s^t)\bigr].
\end{aligned}
\end{split}\]</div>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   1. Modeling COVID 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   2. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   3. QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   4. Circulant Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   5. Singular Value Decomposition (SVD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   6. VARs and DMDs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   7. Using Newton’s Method to Solve Economic Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementary Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   8. Elementary Probability with Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_examples.html">
   9. Some Probability Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   10. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   11. Two Meanings of Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   12. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   13. Multivariate Normal Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   14. Fault Tree Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   15. Introduction to Artificial Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   16. Randomized Response Surveys
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   17. Expected Utilities of Random Responses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bayes Law
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   18. Non-Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   19. Posterior Distributions for  AR(1) Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   20. Forecasting  an AR(1) Process
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics and Information
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="divergence_measures.html">
   21. Statistical Divergence Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   22. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   23. Heterogeneous Beliefs and Financial Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_var.html">
   24. Likelihood Processes for VAR Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   25. Mean of a Likelihood Ratio Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   26. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman_2.html">
   27. A Bayesian Formulation of Friedman and Wald’s Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   28. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   29. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   30. Incorrect Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   31. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   32. Optimal Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   33. Von Neumann Growth Model (and a Generalization)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   34. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   35. Inventory Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   36. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   37. Samuelson Multiplier-Accelerator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   38. Kesten Processes and Firm Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   39. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   40. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   41. Another Look at the Kalman Filter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Search
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   42. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   43. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   44. Job Search III: Fitted Value Function Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_correlated.html">
   45. Job Search IV: Correlated Wage Offers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   46. Job Search V: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   47. Job Search VI: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   48. Job Search VII: A McCall Worker Q-Learns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   49. Job Search VII: Search with Learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Consumption, Savings and Capital
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   50. Cass-Koopmans Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   51. Cass-Koopmans Competitive Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal.html">
   52. Cass-Koopmans Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal_2.html">
   53. Two-Country Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak2.html">
   54. Transitions in an Overlapping Generations Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_problem.html">
   55. Cake Eating I: Introduction to Optimal Saving
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_numerical.html">
   56. Cake Eating II: Numerical Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   57. Optimal Growth I: The Stochastic Optimal Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth_fast.html">
   58. Optimal Growth II: Accelerating the Code with Numba
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   59. Optimal Growth III: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   60. Optimal Growth IV: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   61. The Income Fluctuation Problem I: Basic Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   62. The Income Fluctuation Problem II: Stochastic Returns on Assets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   63. LQ Control: Foundations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   64. Lagrangian for LQ Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   65. Eliminating Cross Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   66. The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   67. Permanent Income II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   68. Production Smoothing via Inventories
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   69. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   70. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   71. Stability in Linear Rational Expectations Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   72. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   73. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   74. The Aiyagari Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   75. Asset Pricing: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   76. Competitive Equilibria with Arrow Securities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   77. Heterogeneous Beliefs and Bubbles
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data and Empirics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   78. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   79. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   80. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Auctions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   81. First-Price and Second-Price Auctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   82. Multiple Good Allocation Mechanisms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   83. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   84. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   85. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/likelihood_ratio_process_2.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/blob/main/lectures/likelihood_ratio_process_2.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/likelihood_ratio_process_2.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/likelihood_ratio_process_2.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/likelihood_ratio_process_2.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "likelihood_ratio_process_2";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/likelihood_ratio_process_2.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>