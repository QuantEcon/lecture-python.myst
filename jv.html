
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>48. Job Search VII: On-the-Job Search &#8212; Intermediate Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=10af625e9e6eb695015491be7f888e42a03bc430" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=4c010e0d" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=ceefa0362b71a389a50c4058a117a949b54259bd"></script>
    <script src="_static/scripts/jquery.js?v=5d32c60e"></script>
    <script src="_static/scripts/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'jv';</script>
    <link rel="canonical" href="https://python.quantecon.org/jv.html" />
    <link rel="icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="49. Job Search VIII: Search with Learning" href="odu.html" />
    <link rel="prev" title="47. Job Search VI: Modeling Career Choice" href="career.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Job Search VII: On-the-Job Search"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Job Search VII: On-the-Job Search" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/jv.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Intermediate Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=jv>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">48.1. Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-features">48.1.1. Model Features</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model">48.2. Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameterization">48.2.1. Parameterization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#back-of-the-envelope-calculations">48.2.2. Back-of-the-Envelope Calculations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">48.3. Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-for-policies">48.4. Solving for Policies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">48.5. Exercises</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/v1/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Intermediate Quantitative Economics with Python</a></p>

                    </div>

                    <!-- Authors section -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>

                    <!-- Last modified / Changelog dropdown -->
                        <button class="qe-page__header-changed" id="changelog-toggle" aria-expanded="false">
                            Last changed: Nov 08, 2025
                            <span class="changelog-icon">▼</span>
                        </button>

                    <!-- Changelog dropdown content -->
                    <div class="qe-page__header-changelog" id="changelog-content" aria-hidden="true">
                        <h4>Changelog (<a href="https://github.com/QuantEcon/lecture-python.myst/commits/main/lectures/jv.md">full history</a>)</h4>
                        <ul class="changelog-list">
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/74949c492" class="changelog-hash">74949c492</a>
                                
                                <span class="changelog-author">John Stachurski</span>
                                <span class="changelog-time">2 weeks ago</span>
                                <span class="changelog-message">Standardize Job Search lecture titles to consistent I-IX numbering (#681)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/3a053155f" class="changelog-hash">3a053155f</a>
                                
                                <span class="changelog-author">Humphrey Yang</span>
                                <span class="changelog-time">3 months ago</span>
                                <span class="changelog-message">[FIX] Remove Syntax Warning from Cache Rebuild (#508)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/f4d7a8d77" class="changelog-hash">f4d7a8d77</a>
                                
                                <span class="changelog-author">Matt McKay</span>
                                <span class="changelog-time">11 months ago</span>
                                <span class="changelog-message">FIX: pass quantecon logo through to download notebooks (#432)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/9ec9e13ed" class="changelog-hash">9ec9e13ed</a>
                                
                                <span class="changelog-author">Matt McKay</span>
                                <span class="changelog-time">1 year ago</span>
                                <span class="changelog-message">MAINT: update @jit(nopython=True) to @jit with numba>=0.59 (#395)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/db29a2423" class="changelog-hash">db29a2423</a>
                                
                                <span class="changelog-author">kp992</span>
                                <span class="changelog-time">1 year ago</span>
                                <span class="changelog-message">Use np.interp instead of interpolation.interp</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/dd9fd0199" class="changelog-hash">dd9fd0199</a>
                                
                                <span class="changelog-author">Smit Lunagariya</span>
                                <span class="changelog-time">1 year ago</span>
                                <span class="changelog-message">MAINT: Fix small typos (#362)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/bab7a8e95" class="changelog-hash">bab7a8e95</a>
                                
                                <span class="changelog-author">Smit Lunagariya</span>
                                <span class="changelog-time">2 years ago</span>
                                <span class="changelog-message">Remove unused imports (#357)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/338a4a488" class="changelog-hash">338a4a488</a>
                                
                                <span class="changelog-author">Humphrey Yang</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">Reformat the Exercise and Solution (#271)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/6f29c3306" class="changelog-hash">6f29c3306</a>
                                
                                <span class="changelog-author">Smit-create</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">Print only when convergence is successful</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/817b6444d" class="changelog-hash">817b6444d</a>
                                
                                <span class="changelog-author">Smit-create</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">Fix convergence conditions</span>
                            </li>
                            
                        </ul>
                    </div>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="job-search-vii-on-the-job-search">
<h1><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">48. </span><span class="target" id="index-0"></span>Job Search VII: On-the-Job Search</a><a class="headerlink" href="#job-search-vii-on-the-job-search" title="Link to this heading">#</a></h1>
<nav class="contents" id="contents">
<span id="index-1"></span><p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#job-search-vii-on-the-job-search" id="id3">Job Search VII: On-the-Job Search</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id4">Overview</a></p></li>
<li><p><a class="reference internal" href="#model" id="id5">Model</a></p></li>
<li><p><a class="reference internal" href="#implementation" id="id6">Implementation</a></p></li>
<li><p><a class="reference internal" href="#solving-for-policies" id="id7">Solving for Policies</a></p></li>
<li><p><a class="reference internal" href="#exercises" id="id8">Exercises</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">48.1. </span>Overview</a><a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>In this section, we solve a simple on-the-job search model</p>
<ul class="simple">
<li><p>based on <span id="id1">[<a class="reference internal" href="zreferences.html#id200" title="L Ljungqvist and T J Sargent. Recursive Macroeconomic Theory. MIT Press, 4 edition, 2018.">Ljungqvist and Sargent, 2018</a>]</span>, exercise 6.18, and <span id="id2">[<a class="reference internal" href="zreferences.html#id113" title="Boyan Jovanovic. Firm-specific capital and turnover. Journal of Political Economy, 87(6):1246–1260, 1979.">Jovanovic, 1979</a>]</span></p></li>
</ul>
<p>Let’s start with some imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numba</span><span class="w"> </span><span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">prange</span>
</pre></div>
</div>
</div>
</div>
<section id="model-features">
<h3><span class="section-number">48.1.1. </span>Model Features<a class="headerlink" href="#model-features" title="Link to this heading">#</a></h3>
<ul class="simple" id="index-2">
<li><p>job-specific human capital accumulation combined with on-the-job search</p></li>
<li><p>infinite-horizon dynamic programming with one state variable and two controls</p></li>
</ul>
</section>
</section>
<section id="model">
<h2><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">48.2. </span>Model</a><a class="headerlink" href="#model" title="Link to this heading">#</a></h2>
<p id="index-3">Let <span class="math notranslate nohighlight">\(x_t\)</span> denote the time-<span class="math notranslate nohighlight">\(t\)</span> job-specific human capital of a worker employed at a given firm and let  <span class="math notranslate nohighlight">\(w_t\)</span> denote current wages.</p>
<p>Let <span class="math notranslate nohighlight">\(w_t = x_t(1 - s_t - \phi_t)\)</span>, where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\phi_t\)</span> is investment in job-specific human capital for the current role and</p></li>
<li><p><span class="math notranslate nohighlight">\(s_t\)</span> is search effort, devoted to obtaining new offers from other firms.</p></li>
</ul>
<p>For as long as the worker remains in the current job, evolution of <span class="math notranslate nohighlight">\(\{x_t\}\)</span> is given by <span class="math notranslate nohighlight">\(x_{t+1} = g(x_t, \phi_t)\)</span>.</p>
<p>When search effort at <span class="math notranslate nohighlight">\(t\)</span> is <span class="math notranslate nohighlight">\(s_t\)</span>, the worker receives a new job offer with probability <span class="math notranslate nohighlight">\(\pi(s_t) \in [0, 1]\)</span>.</p>
<p>The value of the offer, measured in job-specific human capital,  is <span class="math notranslate nohighlight">\(u_{t+1}\)</span>, where <span class="math notranslate nohighlight">\(\{u_t\}\)</span> is IID with common distribution <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>The worker can reject the current offer and continue with existing job.</p>
<p>Hence <span class="math notranslate nohighlight">\(x_{t+1} = u_{t+1}\)</span> if he/she accepts and <span class="math notranslate nohighlight">\(x_{t+1} = g(x_t, \phi_t)\)</span> otherwise.</p>
<p>Let <span class="math notranslate nohighlight">\(b_{t+1} \in \{0,1\}\)</span> be a binary random variable, where <span class="math notranslate nohighlight">\(b_{t+1} = 1\)</span> indicates that the worker receives an offer at the end of time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>We can write</p>
<div class="math notranslate nohighlight" id="equation-jd">
<span class="eqno">(48.1)<a class="headerlink" href="#equation-jd" title="Link to this equation">#</a></span>\[x_{t+1}
= (1 - b_{t+1}) g(x_t, \phi_t) + b_{t+1}
    \max \{ g(x_t, \phi_t), u_{t+1}\}\]</div>
<p>Agent’s objective: maximize expected discounted sum of wages via controls <span class="math notranslate nohighlight">\(\{s_t\}\)</span> and <span class="math notranslate nohighlight">\(\{\phi_t\}\)</span>.</p>
<p>Taking the expectation of <span class="math notranslate nohighlight">\(v(x_{t+1})\)</span> and using <a class="reference internal" href="#equation-jd">(48.1)</a>,
the Bellman equation for this problem can be written as</p>
<div class="math notranslate nohighlight" id="equation-jvbell">
<span class="eqno">(48.2)<a class="headerlink" href="#equation-jvbell" title="Link to this equation">#</a></span>\[v(x)
= \max_{s + \phi \leq 1}
    \left\{
        x (1 - s - \phi) + \beta (1 - \pi(s)) v[g(x, \phi)] +
        \beta \pi(s) \int v[g(x, \phi) \vee u] f(du)
     \right\}\]</div>
<p>Here nonnegativity of <span class="math notranslate nohighlight">\(s\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> is understood, while
<span class="math notranslate nohighlight">\(a \vee b := \max\{a, b\}\)</span>.</p>
<section id="parameterization">
<h3><span class="section-number">48.2.1. </span>Parameterization<a class="headerlink" href="#parameterization" title="Link to this heading">#</a></h3>
<p id="index-4">In the implementation below, we will focus on the parameterization</p>
<div class="math notranslate nohighlight">
\[
g(x, \phi) = A (x \phi)^{\alpha},
\quad
\pi(s) = \sqrt s
\quad \text{and} \quad
f = \text{Beta}(2, 2)
\]</div>
<p>with default parameter values</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A = 1.4\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha = 0.6\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta = 0.96\)</span></p></li>
</ul>
<p>The <span class="math notranslate nohighlight">\(\text{Beta}(2,2)\)</span> distribution is supported on <span class="math notranslate nohighlight">\((0,1)\)</span> - it has a unimodal, symmetric density peaked at 0.5.</p>
</section>
<section id="back-of-the-envelope-calculations">
<span id="jvboecalc"></span><h3><span class="section-number">48.2.2. </span>Back-of-the-Envelope Calculations<a class="headerlink" href="#back-of-the-envelope-calculations" title="Link to this heading">#</a></h3>
<p>Before we solve the model, let’s make some quick calculations that
provide intuition on what the solution should look like.</p>
<p>To begin, observe that the worker has two instruments to build
capital and hence wages:</p>
<ol class="arabic simple">
<li><p>invest in capital specific to the current job via <span class="math notranslate nohighlight">\(\phi\)</span></p></li>
<li><p>search for a new job with better job-specific capital match via <span class="math notranslate nohighlight">\(s\)</span></p></li>
</ol>
<p>Since wages are <span class="math notranslate nohighlight">\(x (1 - s - \phi)\)</span>, marginal cost of investment via either <span class="math notranslate nohighlight">\(\phi\)</span> or <span class="math notranslate nohighlight">\(s\)</span> is identical.</p>
<p>Our risk-neutral worker should focus on whatever instrument has the highest expected return.</p>
<p>The relative expected return will depend on <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>For example, suppose first that <span class="math notranslate nohighlight">\(x = 0.05\)</span></p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(s=1\)</span> and <span class="math notranslate nohighlight">\(\phi = 0\)</span>, then since <span class="math notranslate nohighlight">\(g(x,\phi) = 0\)</span>,
taking expectations of <a class="reference internal" href="#equation-jd">(48.1)</a> gives expected next period capital equal to <span class="math notranslate nohighlight">\(\pi(s) \mathbb{E} u
= \mathbb{E} u = 0.5\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(s=0\)</span> and <span class="math notranslate nohighlight">\(\phi=1\)</span>, then next period capital is <span class="math notranslate nohighlight">\(g(x, \phi) = g(0.05, 1) \approx 0.23\)</span>.</p></li>
</ul>
<p>Both rates of return are good, but the return from search is better.</p>
<p>Next, suppose that <span class="math notranslate nohighlight">\(x = 0.4\)</span></p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(s=1\)</span> and <span class="math notranslate nohighlight">\(\phi = 0\)</span>, then expected next period capital is again <span class="math notranslate nohighlight">\(0.5\)</span></p></li>
<li><p>If <span class="math notranslate nohighlight">\(s=0\)</span> and <span class="math notranslate nohighlight">\(\phi = 1\)</span>, then <span class="math notranslate nohighlight">\(g(x, \phi) = g(0.4, 1) \approx 0.8\)</span></p></li>
</ul>
<p>Return from investment via <span class="math notranslate nohighlight">\(\phi\)</span> dominates expected return from search.</p>
<p>Combining these observations gives us two informal predictions:</p>
<ol class="arabic simple">
<li><p>At any given state <span class="math notranslate nohighlight">\(x\)</span>, the two controls <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(s\)</span> will
function primarily as substitutes — worker will focus on whichever instrument has the higher expected return.</p></li>
<li><p>For sufficiently small <span class="math notranslate nohighlight">\(x\)</span>, search will be preferable to investment in
job-specific human capital.  For larger <span class="math notranslate nohighlight">\(x\)</span>, the reverse will be true.</p></li>
</ol>
<p>Now let’s turn to implementation, and see if we can match our predictions.</p>
</section>
</section>
<section id="implementation">
<h2><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">48.3. </span>Implementation</a><a class="headerlink" href="#implementation" title="Link to this heading">#</a></h2>
<p id="index-5">We will set up a class <code class="docutils literal notranslate"><span class="pre">JVWorker</span></code> that holds the parameters of the model described above</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">JVWorker</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Jovanovic-type model of employment with on-the-job search.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">A</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span>
                 <span class="n">α</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                 <span class="n">β</span><span class="o">=</span><span class="mf">0.96</span><span class="p">,</span>         <span class="c1"># Discount factor</span>
                 <span class="n">π</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">,</span>      <span class="c1"># Search effort function</span>
                 <span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>            <span class="c1"># Parameter of f</span>
                 <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>            <span class="c1"># Parameter of f</span>
                 <span class="n">grid_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                 <span class="n">mc_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                 <span class="n">ɛ</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">α</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">π</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="n">α</span><span class="p">,</span> <span class="n">β</span><span class="p">,</span> <span class="n">π</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mc_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ɛ</span> <span class="o">=</span> <span class="n">mc_size</span><span class="p">,</span> <span class="n">ɛ</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">:</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">ϕ</span><span class="p">)</span><span class="o">**</span><span class="n">α</span><span class="p">)</span>    <span class="c1"># Transition function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f_rvs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">mc_size</span><span class="p">)</span>

        <span class="c1"># Max of grid is the max of a large quantile value for f and the</span>
        <span class="c1"># fixed point y = g(y, 1)</span>
        <span class="n">ɛ</span> <span class="o">=</span> <span class="mf">1e-4</span>
        <span class="n">grid_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">A</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="p">)),</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ɛ</span><span class="p">))</span>

        <span class="c1"># Human capital</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ɛ</span><span class="p">,</span> <span class="n">grid_max</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">operator_factory</span></code> takes an instance of this class and returns a
jitted version of the Bellman operator <code class="docutils literal notranslate"><span class="pre">T</span></code>, i.e.</p>
<div class="math notranslate nohighlight">
\[
Tv(x)
= \max_{s + \phi \leq 1} w(s, \phi)
\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-defw">
<span class="eqno">(48.3)<a class="headerlink" href="#equation-defw" title="Link to this equation">#</a></span>\[w(s, \phi)
 := x (1 - s - \phi) + \beta (1 - \pi(s)) v[g(x, \phi)] +
         \beta \pi(s) \int v[g(x, \phi) \vee u] f(du)\]</div>
<p>When we represent <span class="math notranslate nohighlight">\(v\)</span>, it will be with a NumPy array <code class="docutils literal notranslate"><span class="pre">v</span></code> giving values on grid <code class="docutils literal notranslate"><span class="pre">x_grid</span></code>.</p>
<p>But to evaluate the right-hand side of <a class="reference internal" href="#equation-defw">(48.3)</a>, we need a function, so
we replace the arrays <code class="docutils literal notranslate"><span class="pre">v</span></code> and <code class="docutils literal notranslate"><span class="pre">x_grid</span></code> with a function <code class="docutils literal notranslate"><span class="pre">v_func</span></code> that gives linear
interpolation of <code class="docutils literal notranslate"><span class="pre">v</span></code> on <code class="docutils literal notranslate"><span class="pre">x_grid</span></code>.</p>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, for each <code class="docutils literal notranslate"><span class="pre">x</span></code> in the grid over the state space, we
set up the function <span class="math notranslate nohighlight">\(w(z) = w(s, \phi)\)</span> defined in <a class="reference internal" href="#equation-defw">(48.3)</a>.</p>
<p>The function is maximized over all feasible <span class="math notranslate nohighlight">\((s, \phi)\)</span> pairs.</p>
<p>Another function, <code class="docutils literal notranslate"><span class="pre">get_greedy</span></code> returns the optimal choice of <span class="math notranslate nohighlight">\(s\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>
at each <span class="math notranslate nohighlight">\(x\)</span>, given a value function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">operator_factory</span><span class="p">(</span><span class="n">jv</span><span class="p">,</span> <span class="n">parallel_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a jitted version of the Bellman operator T</span>

<span class="sd">    jv is an instance of JVWorker</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">π</span><span class="p">,</span> <span class="n">β</span> <span class="o">=</span> <span class="n">jv</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="n">jv</span><span class="o">.</span><span class="n">β</span>
    <span class="n">x_grid</span><span class="p">,</span> <span class="n">ɛ</span><span class="p">,</span> <span class="n">mc_size</span> <span class="o">=</span> <span class="n">jv</span><span class="o">.</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">jv</span><span class="o">.</span><span class="n">ɛ</span><span class="p">,</span> <span class="n">jv</span><span class="o">.</span><span class="n">mc_size</span>
    <span class="n">f_rvs</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">jv</span><span class="o">.</span><span class="n">f_rvs</span><span class="p">,</span> <span class="n">jv</span><span class="o">.</span><span class="n">g</span>

    <span class="nd">@jit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">state_action_values</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">ϕ</span> <span class="o">=</span> <span class="n">z</span>
        <span class="n">v_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="n">integral</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mc_size</span><span class="p">):</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">f_rvs</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
            <span class="n">integral</span> <span class="o">+=</span> <span class="n">v_func</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">),</span> <span class="n">u</span><span class="p">))</span>
        <span class="n">integral</span> <span class="o">=</span> <span class="n">integral</span> <span class="o">/</span> <span class="n">mc_size</span>

        <span class="n">q</span> <span class="o">=</span> <span class="n">π</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">integral</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">π</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">*</span> <span class="n">v_func</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ϕ</span> <span class="o">-</span> <span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="n">β</span> <span class="o">*</span> <span class="n">q</span>

    <span class="nd">@jit</span><span class="p">(</span><span class="n">parallel</span><span class="o">=</span><span class="n">parallel_flag</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">T</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Bellman operator</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">v_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_grid</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="c1"># Search on a grid</span>
            <span class="n">search_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ɛ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
            <span class="n">max_val</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">search_grid</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ϕ</span> <span class="ow">in</span> <span class="n">search_grid</span><span class="p">:</span>
                    <span class="n">current_val</span> <span class="o">=</span> <span class="n">state_action_values</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span> <span class="o">+</span> <span class="n">ϕ</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">current_val</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
                        <span class="n">max_val</span> <span class="o">=</span> <span class="n">current_val</span>
            <span class="n">v_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_val</span>

        <span class="k">return</span> <span class="n">v_new</span>

    <span class="nd">@jit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_greedy</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the v-greedy policy of a given function v</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s_policy</span><span class="p">,</span> <span class="n">ϕ_policy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_grid</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># Search on a grid</span>
            <span class="n">search_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ɛ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
            <span class="n">max_val</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">search_grid</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ϕ</span> <span class="ow">in</span> <span class="n">search_grid</span><span class="p">:</span>
                    <span class="n">current_val</span> <span class="o">=</span> <span class="n">state_action_values</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">if</span> <span class="n">s</span> <span class="o">+</span> <span class="n">ϕ</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">current_val</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
                        <span class="n">max_val</span> <span class="o">=</span> <span class="n">current_val</span>
                        <span class="n">max_s</span><span class="p">,</span> <span class="n">max_ϕ</span> <span class="o">=</span> <span class="n">s</span><span class="p">,</span> <span class="n">ϕ</span>
                        <span class="n">s_policy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ϕ_policy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_s</span><span class="p">,</span> <span class="n">max_ϕ</span>
        <span class="k">return</span> <span class="n">s_policy</span><span class="p">,</span> <span class="n">ϕ_policy</span>

    <span class="k">return</span> <span class="n">T</span><span class="p">,</span> <span class="n">get_greedy</span>
</pre></div>
</div>
</div>
</div>
<p>To solve the model, we will write a function that uses the Bellman operator
and iterates to find a fixed point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">solve_model</span><span class="p">(</span><span class="n">jv</span><span class="p">,</span>
                <span class="n">use_parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
                <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">print_skip</span><span class="o">=</span><span class="mi">25</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solves the model by value function iteration</span>

<span class="sd">    * jv is an instance of JVWorker</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">T</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">operator_factory</span><span class="p">(</span><span class="n">jv</span><span class="p">,</span> <span class="n">parallel_flag</span><span class="o">=</span><span class="n">use_parallel</span><span class="p">)</span>

    <span class="c1"># Set up loop</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">jv</span><span class="o">.</span><span class="n">x_grid</span> <span class="o">*</span> <span class="mf">0.5</span>  <span class="c1"># Initial condition</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">tol</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">max_iter</span> <span class="ow">and</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="n">v_new</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">v_new</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">%</span> <span class="n">print_skip</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error at iteration </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v_new</span>

    <span class="k">if</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to converge!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Converged in </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> iterations.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">v_new</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving-for-policies">
<h2><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">48.4. </span>Solving for Policies</a><a class="headerlink" href="#solving-for-policies" title="Link to this heading">#</a></h2>
<p id="index-6">Let’s generate the optimal policies and see what they look like.</p>
<div class="cell docutils container" id="jv-policies">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jv</span> <span class="o">=</span> <span class="n">JVWorker</span><span class="p">()</span>
<span class="n">T</span><span class="p">,</span> <span class="n">get_greedy</span> <span class="o">=</span> <span class="n">operator_factory</span><span class="p">(</span><span class="n">jv</span><span class="p">)</span>
<span class="n">v_star</span> <span class="o">=</span> <span class="n">solve_model</span><span class="p">(</span><span class="n">jv</span><span class="p">)</span>
<span class="n">s_star</span><span class="p">,</span> <span class="n">ϕ_star</span> <span class="o">=</span> <span class="n">get_greedy</span><span class="p">(</span><span class="n">v_star</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error at iteration 25 is 0.15111138517481848.
Error at iteration 50 is 0.05446004707108543.
Error at iteration 75 is 0.019627222164354308.
Error at iteration 100 is 0.007073586429077849.
Error at iteration 125 is 0.0025492973254532814.
Error at iteration 150 is 0.0009187583863941029.
Error at iteration 175 is 0.00033111750604319923.
Error at iteration 200 is 0.00011933366207372842.

Converged in 205 iterations.
</pre></div>
</div>
</div>
</div>
<p>Here are the plots:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plots</span> <span class="o">=</span> <span class="p">[</span><span class="n">s_star</span><span class="p">,</span> <span class="n">ϕ_star</span><span class="p">,</span> <span class="n">v_star</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s policy&quot;</span><span class="p">,</span> <span class="s2">&quot;ϕ policy&quot;</span><span class="p">,</span>  <span class="s2">&quot;value function&quot;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">plots</span><span class="p">,</span> <span class="n">titles</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jv</span><span class="o">.</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">plot</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a0d201d48aed42f0b3c9ac9ec6c3e3f692cca05264534e69c557a1f3cd2ba3b4.png" src="_images/a0d201d48aed42f0b3c9ac9ec6c3e3f692cca05264534e69c557a1f3cd2ba3b4.png" />
</div>
</div>
<p>The horizontal axis is the state <span class="math notranslate nohighlight">\(x\)</span>, while the vertical axis gives <span class="math notranslate nohighlight">\(s(x)\)</span> and <span class="math notranslate nohighlight">\(\phi(x)\)</span>.</p>
<p>Overall, the policies match well with our predictions from <a class="reference internal" href="#jvboecalc"><span class="std std-ref">above</span></a></p>
<ul class="simple">
<li><p>Worker switches from one investment strategy to the other depending on relative return.</p></li>
<li><p>For low values of <span class="math notranslate nohighlight">\(x\)</span>, the best option is to search for a new job.</p></li>
<li><p>Once <span class="math notranslate nohighlight">\(x\)</span> is larger, worker does better by investing in human capital specific to the current position.</p></li>
</ul>
</section>
<section id="exercises">
<h2><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">48.5. </span>Exercises</a><a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<div class="exercise admonition" id="jv_ex1">

<p class="admonition-title"><span class="caption-number">Exercise 48.1 </span></p>
<section id="exercise-content">
<p>Let’s look at the dynamics for the state process <span class="math notranslate nohighlight">\(\{x_t\}\)</span> associated with these policies.</p>
<p>The dynamics are given by <a class="reference internal" href="#equation-jd">(48.1)</a> when <span class="math notranslate nohighlight">\(\phi_t\)</span> and <span class="math notranslate nohighlight">\(s_t\)</span> are
chosen according to the optimal policies, and <span class="math notranslate nohighlight">\(\mathbb{P}\{b_{t+1} = 1\}
= \pi(s_t)\)</span>.</p>
<p>Since the dynamics are random, analysis is a bit subtle.</p>
<p>One way to do it is to plot, for each <span class="math notranslate nohighlight">\(x\)</span> in a relatively fine grid
called <code class="docutils literal notranslate"><span class="pre">plot_grid</span></code>, a
large number <span class="math notranslate nohighlight">\(K\)</span> of realizations of <span class="math notranslate nohighlight">\(x_{t+1}\)</span> given <span class="math notranslate nohighlight">\(x_t =
x\)</span>.</p>
<p>Plot this with one dot for each realization, in the form of a 45 degree
diagram, setting</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">jv</span> <span class="o">=</span> <span class="n">JVWorker</span><span class="p">(</span><span class="n">grid_size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">mc_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plot_grid_max</span><span class="p">,</span> <span class="n">plot_grid_size</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">plot_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_grid_max</span><span class="p">,</span> <span class="n">plot_grid_size</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_grid_max</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_grid_max</span><span class="p">)</span>
</pre></div>
</div>
<p>By examining the plot, argue that under the optimal policies, the state
<span class="math notranslate nohighlight">\(x_t\)</span> will converge to a constant value <span class="math notranslate nohighlight">\(\bar x\)</span> close to unity.</p>
<p>Argue that at the steady state, <span class="math notranslate nohighlight">\(s_t \approx 0\)</span> and <span class="math notranslate nohighlight">\(\phi_t \approx 0.6\)</span>.</p>
</section>
</div>
<div class="solution dropdown admonition" id="jv-solution-1">

<p class="admonition-title">Solution</p>
<section id="solution-content">
<p>Here’s code to produce the 45 degree diagram</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jv</span> <span class="o">=</span> <span class="n">JVWorker</span><span class="p">(</span><span class="n">grid_size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">mc_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">π</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">f_rvs</span><span class="p">,</span> <span class="n">x_grid</span> <span class="o">=</span> <span class="n">jv</span><span class="o">.</span><span class="n">π</span><span class="p">,</span> <span class="n">jv</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="n">jv</span><span class="o">.</span><span class="n">f_rvs</span><span class="p">,</span> <span class="n">jv</span><span class="o">.</span><span class="n">x_grid</span>
<span class="n">T</span><span class="p">,</span> <span class="n">get_greedy</span> <span class="o">=</span> <span class="n">operator_factory</span><span class="p">(</span><span class="n">jv</span><span class="p">)</span>
<span class="n">v_star</span> <span class="o">=</span> <span class="n">solve_model</span><span class="p">(</span><span class="n">jv</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">s_policy</span><span class="p">,</span> <span class="n">ϕ_policy</span> <span class="o">=</span> <span class="n">get_greedy</span><span class="p">(</span><span class="n">v_star</span><span class="p">)</span>

<span class="c1"># Turn the policy function arrays into actual functions</span>
<span class="n">s</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">s_policy</span><span class="p">)</span>
<span class="n">ϕ</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">ϕ_policy</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">h</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ϕ</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">u</span><span class="p">)</span>


<span class="n">plot_grid_max</span><span class="p">,</span> <span class="n">plot_grid_size</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">plot_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_grid_max</span><span class="p">,</span> <span class="n">plot_grid_size</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ticks</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span>
       <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_grid_max</span><span class="p">),</span>
       <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_grid_max</span><span class="p">),</span>
       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;$x_t$&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$x_{t+1}$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_grid</span><span class="p">,</span> <span class="n">plot_grid</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>  <span class="c1"># 45 degree line</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plot_grid</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jv</span><span class="o">.</span><span class="n">mc_size</span><span class="p">):</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">π</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">f_rvs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e735c6f30fb3ab272e8c368379a3de88951839bddfeb7155d3c92267837dcfda.png" src="_images/e735c6f30fb3ab272e8c368379a3de88951839bddfeb7155d3c92267837dcfda.png" />
</div>
</div>
<p>Looking at the dynamics, we can see that</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(x_t\)</span> is below about 0.2 the dynamics are random, but
<span class="math notranslate nohighlight">\(x_{t+1} &gt; x_t\)</span> is very likely.</p></li>
<li><p>As <span class="math notranslate nohighlight">\(x_t\)</span> increases the dynamics become deterministic, and
<span class="math notranslate nohighlight">\(x_t\)</span> converges to a steady state value close to 1.</p></li>
</ul>
<p>Referring back to the figure <a class="reference internal" href="#jv-policies"><span class="std std-ref">here</span></a> we see that <span class="math notranslate nohighlight">\(x_t \approx 1\)</span> means that
<span class="math notranslate nohighlight">\(s_t = s(x_t) \approx 0\)</span> and
<span class="math notranslate nohighlight">\(\phi_t = \phi(x_t) \approx 0.6\)</span>.</p>
</section>
</div>
<div class="exercise admonition" id="jv_ex2">

<p class="admonition-title"><span class="caption-number">Exercise 48.2 </span></p>
<section id="exercise-content">
<p>In <a class="reference internal" href="#jv_ex1"><span class="std std-numref">Exercise 48.1</span></a>, we found that <span class="math notranslate nohighlight">\(s_t\)</span> converges to zero
and <span class="math notranslate nohighlight">\(\phi_t\)</span> converges to about 0.6.</p>
<p>Since these results were calculated at a value of <span class="math notranslate nohighlight">\(\beta\)</span> close to
one, let’s compare them to the best choice for an <em>infinitely</em> patient worker.</p>
<p>Intuitively, an infinitely patient worker would like to maximize steady state
wages, which are a function of steady state capital.</p>
<p>You can take it as given—it’s certainly true—that the infinitely patient worker does not
search in the long run (i.e., <span class="math notranslate nohighlight">\(s_t = 0\)</span> for large <span class="math notranslate nohighlight">\(t\)</span>).</p>
<p>Thus, given <span class="math notranslate nohighlight">\(\phi\)</span>, steady state capital is the positive fixed point
<span class="math notranslate nohighlight">\(x^*(\phi)\)</span> of the map <span class="math notranslate nohighlight">\(x \mapsto g(x, \phi)\)</span>.</p>
<p>Steady state wages can be written as <span class="math notranslate nohighlight">\(w^*(\phi) = x^*(\phi) (1 - \phi)\)</span>.</p>
<p>Graph <span class="math notranslate nohighlight">\(w^*(\phi)\)</span> with respect to <span class="math notranslate nohighlight">\(\phi\)</span>, and examine the best
choice of <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
<p>Can you give a rough interpretation for the value that you see?</p>
</section>
</div>
<div class="solution dropdown admonition" id="jv-solution-3">

<p class="admonition-title">Solution</p>
<section id="solution-content">
<p>The figure can be produced as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jv</span> <span class="o">=</span> <span class="n">JVWorker</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">xbar</span><span class="p">(</span><span class="n">ϕ</span><span class="p">):</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">α</span> <span class="o">=</span> <span class="n">jv</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">jv</span><span class="o">.</span><span class="n">α</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">ϕ</span><span class="o">**</span><span class="n">α</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">α</span><span class="p">))</span>

<span class="n">ϕ_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\phi$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ϕ_grid</span><span class="p">,</span> <span class="p">[</span><span class="n">xbar</span><span class="p">(</span><span class="n">ϕ</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ϕ</span><span class="p">)</span> <span class="k">for</span> <span class="n">ϕ</span> <span class="ow">in</span> <span class="n">ϕ_grid</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$w^*(\phi)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4375079e5cffa9ec7f3f009cbf376e2061c5a202996179515289a83ce61a63ee.png" src="_images/4375079e5cffa9ec7f3f009cbf376e2061c5a202996179515289a83ce61a63ee.png" />
</div>
</div>
<p>Observe that the maximizer is around 0.6.</p>
<p>This is similar to the long-run value for <span class="math notranslate nohighlight">\(\phi\)</span> obtained in
<a class="reference internal" href="#jv_ex1"><span class="std std-numref">Exercise 48.1</span></a>.</p>
<p>Hence the behavior of the infinitely patent worker is similar to that
of the worker with <span class="math notranslate nohighlight">\(\beta = 0.96\)</span>.</p>
<p>This seems reasonable and helps us confirm that our dynamic programming
solutions are probably correct.</p>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   1. Modeling COVID 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   2. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   3. QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   4. Circulant Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   5. Singular Value Decomposition (SVD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   6. VARs and DMDs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   7. Using Newton’s Method to Solve Economic Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementary Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   8. Elementary Probability with Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_examples.html">
   9. Some Probability Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   10. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   11. Two Meanings of Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   12. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   13. Multivariate Normal Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   14. Fault Tree Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   15. Introduction to Artificial Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   16. Randomized Response Surveys
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   17. Expected Utilities of Random Responses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bayes Law
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   18. Non-Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   19. Posterior Distributions for  AR(1) Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   20. Forecasting  an AR(1) Process
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics and Information
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="divergence_measures.html">
   21. Statistical Divergence Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   22. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process_2.html">
   23. Heterogeneous Beliefs and Financial Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_var.html">
   24. Likelihood Processes For VAR Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   25. Mean of a Likelihood Ratio Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   26. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman_2.html">
   27. A Bayesian Formulation of Friedman and Wald’s Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   28. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   29. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   30. Incorrect Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   31. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   32. Optimal Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   33. Von Neumann Growth Model (and a Generalization)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   34. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   35. Inventory Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   36. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   37. Samuelson Multiplier-Accelerator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   38. Kesten Processes and Firm Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   39. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   40. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   41. Another Look at the Kalman Filter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Search
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   42. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   43. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_sep_markov.html">
   44. Job Search III: Search with Separation and Markov Wages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   45. Job Search IV: Fitted Value Function Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_persist_trans.html">
   46. Job Search V: Persistent and Transitory Wage Shocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   47. Job Search VI: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   48. Job Search VII: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   49. Job Search VIII: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   50. Job Search IX: Search with Q-Learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Optimal Savings
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="os.html">
   51. Optimal Savings I: Cake Eating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_numerical.html">
   52. Optimal Savings II: Numerical Cake Eating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_stochastic.html">
   53. Optimal Savings III: Stochastic Returns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_time_iter.html">
   54. Optimal Savings IV: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_egm.html">
   55. Optimal Savings V: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_egm_jax.html">
   56. Optimal Savings VI: EGM with JAX
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Household Problems
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_discrete.html">
   57. The Income Fluctuation Problem I: Discretization and VFI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_opi.html">
   58. The Income Fluctuation Problem II: Optimistic Policy Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_egm.html">
   59. The Income Fluctuation Problem III: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_egm_transient_shocks.html">
   60. The Income Fluctuation Problem IV: Transient Income Shocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   61. The Income Fluctuation Problem V: Stochastic Returns on Assets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   62. LQ Control: Foundations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   63. Lagrangian for LQ Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   64. Eliminating Cross Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   65. The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   66. Permanent Income II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   67. Production Smoothing via Inventories
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Optimal Growth
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   68. Cass-Koopmans Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   69. Cass-Koopmans Competitive Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal.html">
   70. Cass-Koopmans Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal_2.html">
   71. Two-Country Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak2.html">
   72. Transitions in an Overlapping Generations Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   73. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="endogenous_lake.html">
   74. Lake Model with an Endogenous Job Finding Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   75. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   76. Stability in Linear Rational Expectations Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   77. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   78. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   79. The Aiyagari Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak_aiyagari.html">
   80. A Long-Lived, Heterogeneous Agent, Overlapping Generations Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   81. Asset Pricing: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   82. Competitive Equilibria with Arrow Securities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   83. Heterogeneous Beliefs and Bubbles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morris_learn.html">
   84. Speculative Behavior with Bayesian Learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data and Empirics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   85. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   86. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   87. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Auctions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   88. First-Price and Second-Price Auctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   89. Multiple Good Allocation Mechanisms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   90. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   91. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   92. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/jv.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/blob/main/lectures/jv.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/jv.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/jv.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/jv.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "jv";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/jv.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>