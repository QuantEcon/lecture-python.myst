
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>81. Asset Pricing: Finite State Models &#8212; Intermediate Quantitative Economics with Python</title>
    
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js" integrity="sha384-bq5PNg/ZcfW7KMvFSmhjqCQJ/VFnec+6sZkctn/4ZLeubkn7U58Le4zFFSn3dhUu" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js" integrity="sha384-qEqAs1VsN9WH2myXDbiP2wGGIttL9bMRZBKCl54ZnzpDlVqbYANP9vMaoT/wvQcf" crossorigin="anonymous"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=22b71a9b445b7b2b6a277c0a48ea72bf6e7c90d9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css?v=982b99e0" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=4c010e0d" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>


    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=65b86b9423025043228643fcfb616ce846cb91c1"></script>
    <script src="_static/scripts/jquery.js?v=5d32c60e"></script>
    <script src="_static/scripts/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'markov_asset';</script>
    <link rel="canonical" href="https://python.quantecon.org/markov_asset.html" />
    <link rel="icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="82. Competitive Equilibria with Arrow Securities" href="ge_arrow.html" />
    <link rel="prev" title="80. A Long-Lived, Heterogeneous Agent, Overlapping Generations Model" href="ak_aiyagari.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Asset Pricing: Finite State Models"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Asset Pricing: Finite State Models" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/markov_asset.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Intermediate Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>

<!-- Override QuantEcon theme colors -->

    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=markov_asset>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">81.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pricing-models">81.2. Pricing Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#risk-neutral-pricing">81.2.1. Risk-Neutral Pricing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pricing-with-random-discount-factor">81.2.2. Pricing with Random Discount Factor</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#asset-pricing-and-covariances">81.2.3. Asset Pricing and Covariances</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-price-dividend-ratio">81.2.4. The Price-Dividend Ratio</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prices-in-the-risk-neutral-case">81.3. Prices in the Risk-Neutral Case</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-constant-dividends">81.3.1. Example 1: Constant Dividends</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-dividends-with-deterministic-growth-paths">81.3.2. Example 2: Dividends with Deterministic Growth Paths</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-markov-growth-risk-neutral-pricing">81.3.3. Example 3: Markov Growth, Risk-Neutral Pricing</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pricing-formula">81.3.3.1. Pricing Formula</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code">81.3.4. Code</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#risk-aversion-and-asset-prices">81.4. Risk Aversion and Asset Prices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pricing-a-lucas-tree">81.4.1. Pricing a Lucas Tree</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#special-cases">81.4.1.1. Special Cases</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-risk-free-consol">81.4.2. A Risk-Free Consol</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pricing-an-option-to-purchase-the-consol">81.4.3. Pricing an Option to Purchase the Consol</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#an-infinite-horizon-call-option">81.4.3.1. An Infinite Horizon Call Option</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#risk-free-rates">81.4.4. Risk-Free Rates</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-one-period-risk-free-interest-rate">81.4.4.1. The One-period Risk-free Interest Rate</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#other-terms">81.4.4.2. Other Terms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">81.5. Exercises</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/v1/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Intermediate Quantitative Economics with Python</a></p>

                    </div>

                    <!-- Authors section -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>

                    <!-- Last modified / Changelog dropdown -->
                        <button class="qe-page__header-changed" id="changelog-toggle" aria-expanded="false">
                            Last changed: Nov 21, 2025
                            <span class="changelog-icon">▼</span>
                        </button>

                    <!-- Changelog dropdown content -->
                    <div class="qe-page__header-changelog" id="changelog-content" aria-hidden="true">
                        <h4>Changelog (<a href="https://github.com/QuantEcon/lecture-python.myst/commits/main/lectures/markov_asset.md">full history</a>)</h4>
                        <ul class="changelog-list">
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/a1cd90c5e" class="changelog-hash">a1cd90c5e</a>
                                
                                <span class="changelog-author">Matt McKay</span>
                                <span class="changelog-time">2 months ago</span>
                                <span class="changelog-message">STYLE: Fix emphasis vs definitions style guide compliance (Issue #721) (#723)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/a73ba0f7d" class="changelog-hash">a73ba0f7d</a>
                                
                                <span class="changelog-author">Copilot</span>
                                <span class="changelog-time">5 months ago</span>
                                <span class="changelog-message">[style] Remove local figsize adjustments from all lecture files (#574)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/f4d7a8d77" class="changelog-hash">f4d7a8d77</a>
                                
                                <span class="changelog-author">Matt McKay</span>
                                <span class="changelog-time">1 year ago</span>
                                <span class="changelog-message">FIX: pass quantecon logo through to download notebooks (#432)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/dd9fd0199" class="changelog-hash">dd9fd0199</a>
                                
                                <span class="changelog-author">Smit Lunagariya</span>
                                <span class="changelog-time">2 years ago</span>
                                <span class="changelog-message">MAINT: Fix small typos (#362)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/a6fd5d3f4" class="changelog-hash">a6fd5d3f4</a>
                                
                                <span class="changelog-author">mmcky</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">FIX: Adjust for quantecon==0.6.0 (#296)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/338a4a488" class="changelog-hash">338a4a488</a>
                                
                                <span class="changelog-author">Humphrey Yang</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">Reformat the Exercise and Solution (#271)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/ef2812ee7" class="changelog-hash">ef2812ee7</a>
                                
                                <span class="changelog-author">Smit Lunagariya</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">A minor typo fix (#259)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/80ef919b9" class="changelog-hash">80ef919b9</a>
                                
                                <span class="changelog-author">mmcky</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">ENH: Improve compatibility with Google Colab (#236)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/0d1df5576" class="changelog-hash">0d1df5576</a>
                                
                                <span class="changelog-author">mmcky</span>
                                <span class="changelog-time">3 years ago</span>
                                <span class="changelog-message">ENH: Migrate to sphinx-exercise (#231)</span>
                            </li>
                            
                            <li class="changelog-entry">
                                
                                <a href="https://github.com/QuantEcon/lecture-python.myst/commit/085dce079" class="changelog-hash">085dce079</a>
                                
                                <span class="changelog-author">thomassargent30</span>
                                <span class="changelog-time">4 years ago</span>
                                <span class="changelog-message">Tom's Jan 26 edits of a lecture</span>
                            </li>
                            
                        </ul>
                    </div>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <section class="tex2jax_ignore mathjax_ignore" id="asset-pricing-finite-state-models">
<h1><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">81. </span><span class="target" id="index-0"></span>Asset Pricing: Finite State Models</a><a class="headerlink" href="#asset-pricing-finite-state-models" title="Link to this heading">#</a></h1>
<nav class="contents" id="contents">
<span id="index-1"></span><p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#asset-pricing-finite-state-models" id="id6">Asset Pricing: Finite State Models</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id7">Overview</a></p></li>
<li><p><a class="reference internal" href="#pricing-models" id="id8">Pricing Models</a></p></li>
<li><p><a class="reference internal" href="#prices-in-the-risk-neutral-case" id="id9">Prices in the Risk-Neutral Case</a></p></li>
<li><p><a class="reference internal" href="#risk-aversion-and-asset-prices" id="id10">Risk Aversion and Asset Prices</a></p></li>
<li><p><a class="reference internal" href="#exercises" id="id11">Exercises</a></p></li>
</ul>
</li>
</ul>
</nav>
<blockquote class="epigraph">
<div><p>“A little knowledge of geometric series goes a long way” – Robert E. Lucas, Jr.</p>
</div></blockquote>
<blockquote class="epigraph">
<div><p>“Asset pricing is all about covariances” – Lars Peter Hansen</p>
</div></blockquote>
<p>In addition to what’s in Anaconda, this lecture will need the following libraries:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>quantecon
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: quantecon in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (0.10.1)
Requirement already satisfied: numba&gt;=0.49.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (0.62.1)
Requirement already satisfied: numpy&gt;=1.17.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (2.3.5)
Requirement already satisfied: requests in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (2.32.5)
Requirement already satisfied: scipy&gt;=1.5.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (1.16.3)
Requirement already satisfied: sympy in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from quantecon) (1.14.0)
Requirement already satisfied: llvmlite&lt;0.46,&gt;=0.45.0dev0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from numba&gt;=0.49.0-&gt;quantecon) (0.45.1)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from requests-&gt;quantecon) (3.4.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from requests-&gt;quantecon) (3.11)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from requests-&gt;quantecon) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from requests-&gt;quantecon) (2025.11.12)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /home/runner/miniconda3/envs/quantecon/lib/python3.13/site-packages (from sympy-&gt;quantecon) (1.3.0)
</pre></div>
</div>
</div>
</details>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">81.1. </span>Overview</a><a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p id="index-2">An asset is a claim on one or more future payoffs.</p>
<p>The spot price of an asset depends primarily on</p>
<ul class="simple">
<li><p>the anticipated  income stream</p></li>
<li><p>attitudes about risk</p></li>
<li><p>rates of time preference</p></li>
</ul>
<p>In this lecture, we consider some standard pricing models and dividend stream specifications.</p>
<p>We study how prices and dividend-price ratios respond in these different scenarios.</p>
<p>We also look at creating and pricing <em>derivative</em> assets that repackage income streams.</p>
<p>Key tools for the lecture are</p>
<ul class="simple">
<li><p>Markov processses</p></li>
<li><p>formulas for predicting future values of functions of a Markov state</p></li>
<li><p>a formula for predicting the discounted sum of future values of a Markov state</p></li>
</ul>
<p>Let’s start with some imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">quantecon</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">qe</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.linalg</span><span class="w"> </span><span class="kn">import</span> <span class="n">eigvals</span><span class="p">,</span> <span class="n">solve</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pricing-models">
<h2><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">81.2. </span><span class="target" id="index-3"></span>Pricing Models</a><a class="headerlink" href="#pricing-models" title="Link to this heading">#</a></h2>
<p id="index-4">Let <span class="math notranslate nohighlight">\(\{d_t\}_{t \geq 0}\)</span> be a stream of dividends</p>
<ul class="simple">
<li><p>A time-<span class="math notranslate nohighlight">\(t\)</span> <strong>cum-dividend</strong> asset is a claim to the stream <span class="math notranslate nohighlight">\(d_t, d_{t+1}, \ldots\)</span>.</p></li>
<li><p>A time-<span class="math notranslate nohighlight">\(t\)</span> <strong>ex-dividend</strong> asset is a claim to the stream <span class="math notranslate nohighlight">\(d_{t+1}, d_{t+2}, \ldots\)</span>.</p></li>
</ul>
<p>Let’s look at some equations that we expect to hold for prices of assets under ex-dividend contracts
(we will consider cum-dividend pricing in the exercises).</p>
<section id="risk-neutral-pricing">
<h3><span class="section-number">81.2.1. </span>Risk-Neutral Pricing<a class="headerlink" href="#risk-neutral-pricing" title="Link to this heading">#</a></h3>
<p id="index-5">Our first scenario is risk-neutral pricing.</p>
<p>Let <span class="math notranslate nohighlight">\(\beta = 1/(1+\rho)\)</span> be an intertemporal discount <strong>factor</strong>, where
<span class="math notranslate nohighlight">\(\rho\)</span> is the <strong>rate</strong> at which agents discount the future.</p>
<p>The basic risk-neutral asset pricing equation for pricing one unit of an ex-dividend asset is</p>
<div class="math notranslate nohighlight" id="equation-rnapex">
<span id="mass-pra"></span><span class="eqno">(81.1)<a class="headerlink" href="#equation-rnapex" title="Link to this equation">#</a></span>\[p_t = \beta {\mathbb E}_t [d_{t+1} + p_{t+1}]\]</div>
<p>This is a simple “cost equals expected benefit” relationship.</p>
<p>Here <span class="math notranslate nohighlight">\({\mathbb E}_t [y]\)</span> denotes the best forecast of <span class="math notranslate nohighlight">\(y\)</span>, conditioned on information available at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>More precisely, <span class="math notranslate nohighlight">\({\mathbb E}_t [y]\)</span> is the mathematical expectation of <span class="math notranslate nohighlight">\(y\)</span> conditional on information available at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
</section>
<section id="pricing-with-random-discount-factor">
<h3><span class="section-number">81.2.2. </span>Pricing with Random Discount Factor<a class="headerlink" href="#pricing-with-random-discount-factor" title="Link to this heading">#</a></h3>
<p id="index-6">What happens if for some reason traders discount payouts differently depending on the state of the world?</p>
<p>Michael Harrison and David Kreps <span id="id1">[<a class="reference internal" href="zreferences.html#id140" title="J. Michael Harrison and David M. Kreps. Martingales and arbitrage in multiperiod securities markets. Journal of Economic Theory, 20(3):381-408, June 1979.">Harrison and Kreps, 1979</a>]</span> and Lars Peter Hansen
and Scott Richard <span id="id2">[<a class="reference internal" href="zreferences.html#id141" title="Lars Peter Hansen and Scott F Richard. The role of conditioning information in deducing testable restrictions implied by dynamc asset pricing models. Econometrica, 55(3):587-613, May 1987.">Hansen and Richard, 1987</a>]</span> showed that in quite general
settings the price of an ex-dividend asset obeys</p>
<div class="math notranslate nohighlight" id="equation-lteeqs0">
<span class="eqno">(81.2)<a class="headerlink" href="#equation-lteeqs0" title="Link to this equation">#</a></span>\[p_t = {\mathbb E}_t \left[ m_{t+1}  ( d_{t+1} + p_{t+1} ) \right]\]</div>
<p>for some  <strong>stochastic discount factor</strong> <span class="math notranslate nohighlight">\(m_{t+1}\)</span>.</p>
<p>Here the fixed discount factor <span class="math notranslate nohighlight">\(\beta\)</span> in <a class="reference internal" href="#equation-rnapex">(81.1)</a> has been replaced by the random variable <span class="math notranslate nohighlight">\(m_{t+1}\)</span>.</p>
<p>How anticipated future payoffs are evaluated  now depends on statistical properties of <span class="math notranslate nohighlight">\(m_{t+1}\)</span>.</p>
<p>The stochastic discount factor can be specified to capture the idea that assets that tend to have good payoffs in bad states of the world are valued more highly than other assets whose payoffs don’t behave that way.</p>
<p>This is because such assets pay well when funds are more urgently wanted.</p>
<p>We give examples of how the stochastic discount factor has been modeled below.</p>
</section>
<section id="asset-pricing-and-covariances">
<h3><span class="section-number">81.2.3. </span>Asset Pricing and Covariances<a class="headerlink" href="#asset-pricing-and-covariances" title="Link to this heading">#</a></h3>
<p>Recall that, from the definition of a conditional covariance <span class="math notranslate nohighlight">\({\rm cov}_t (x_{t+1}, y_{t+1})\)</span>, we have</p>
<div class="math notranslate nohighlight" id="equation-lteeqs101">
<span class="eqno">(81.3)<a class="headerlink" href="#equation-lteeqs101" title="Link to this equation">#</a></span>\[{\mathbb E}_t (x_{t+1} y_{t+1}) = {\rm cov}_t (x_{t+1}, y_{t+1}) + {\mathbb E}_t x_{t+1} {\mathbb E}_t y_{t+1}\]</div>
<p>If we apply this definition to the asset pricing equation <a class="reference internal" href="#equation-lteeqs0">(81.2)</a> we obtain</p>
<div class="math notranslate nohighlight" id="equation-lteeqs102">
<span class="eqno">(81.4)<a class="headerlink" href="#equation-lteeqs102" title="Link to this equation">#</a></span>\[p_t = {\mathbb E}_t m_{t+1} {\mathbb E}_t (d_{t+1} + p_{t+1}) + {\rm cov}_t (m_{t+1}, d_{t+1}+ p_{t+1})\]</div>
<p>It is useful to regard equation <a class="reference internal" href="#equation-lteeqs102">(81.4)</a>   as a generalization of equation <a class="reference internal" href="#equation-rnapex">(81.1)</a></p>
<ul class="simple">
<li><p>In equation <a class="reference internal" href="#equation-rnapex">(81.1)</a>, the stochastic discount factor <span class="math notranslate nohighlight">\(m_{t+1} = \beta\)</span>,  a constant.</p></li>
<li><p>In equation <a class="reference internal" href="#equation-rnapex">(81.1)</a>, the covariance term <span class="math notranslate nohighlight">\({\rm cov}_t (m_{t+1}, d_{t+1}+ p_{t+1})\)</span> is zero because <span class="math notranslate nohighlight">\(m_{t+1} = \beta\)</span>.</p></li>
<li><p>In equation <a class="reference internal" href="#equation-rnapex">(81.1)</a>, <span class="math notranslate nohighlight">\({\mathbb E}_t m_{t+1}\)</span> can be interpreted as the reciprocal of the one-period risk-free gross interest rate.</p></li>
<li><p>When  <span class="math notranslate nohighlight">\(m_{t+1}\)</span>  covaries more negatively with the payout <span class="math notranslate nohighlight">\(p_{t+1} + d_{t+1}\)</span>, the price of the asset is lower.</p></li>
</ul>
<p>Equation <a class="reference internal" href="#equation-lteeqs102">(81.4)</a> asserts that the covariance of the stochastic discount factor with the one period payout <span class="math notranslate nohighlight">\(d_{t+1} + p_{t+1}\)</span> is an important determinant of the price <span class="math notranslate nohighlight">\(p_t\)</span>.</p>
<p>We give examples of some models of stochastic discount factors that have been proposed later in this lecture and also in a <a class="reference external" href="https://python-advanced.quantecon.org/lucas_model.html">later lecture</a>.</p>
</section>
<section id="the-price-dividend-ratio">
<h3><span class="section-number">81.2.4. </span>The Price-Dividend Ratio<a class="headerlink" href="#the-price-dividend-ratio" title="Link to this heading">#</a></h3>
<p>Aside from prices, another quantity of interest is the <strong>price-dividend ratio</strong> <span class="math notranslate nohighlight">\(v_t := p_t / d_t\)</span>.</p>
<p>Let’s write down an expression that this ratio should satisfy.</p>
<p>We can divide both sides of <a class="reference internal" href="#equation-lteeqs0">(81.2)</a> by <span class="math notranslate nohighlight">\(d_t\)</span> to get</p>
<div class="math notranslate nohighlight" id="equation-pdex">
<span class="eqno">(81.5)<a class="headerlink" href="#equation-pdex" title="Link to this equation">#</a></span>\[v_t = {\mathbb E}_t \left[ m_{t+1} \frac{d_{t+1}}{d_t} (1 + v_{t+1}) \right]\]</div>
<p>Below we’ll discuss the implication of this equation.</p>
</section>
</section>
<section id="prices-in-the-risk-neutral-case">
<h2><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">81.3. </span>Prices in the Risk-Neutral Case</a><a class="headerlink" href="#prices-in-the-risk-neutral-case" title="Link to this heading">#</a></h2>
<p>What can we say about price dynamics on the basis of the models described above?</p>
<p>The answer to this question depends on</p>
<ol class="arabic simple">
<li><p>the process we specify for dividends</p></li>
<li><p>the stochastic discount factor and how it correlates with dividends</p></li>
</ol>
<p>For now we’ll study  the risk-neutral case in which  the stochastic discount factor is constant.</p>
<p>We’ll  focus on how an asset  price depends on a dividend process.</p>
<section id="example-1-constant-dividends">
<h3><span class="section-number">81.3.1. </span>Example 1: Constant Dividends<a class="headerlink" href="#example-1-constant-dividends" title="Link to this heading">#</a></h3>
<p>The simplest case is risk-neutral price of a constant, non-random dividend stream <span class="math notranslate nohighlight">\(d_t = d &gt; 0\)</span>.</p>
<p>Removing the expectation from <a class="reference internal" href="#equation-rnapex">(81.1)</a> and iterating forward gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    p_t &amp; = \beta (d + p_{t+1})
        \\
        &amp; = \beta (d + \beta(d + p_{t+2}))
        \\
        &amp; \quad \vdots
        \\
        &amp; = \beta (d + \beta d + \beta^2 d +  \cdots + \beta^{k-2} d + \beta^{k-1} p_{t+k})
\end{aligned}
\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(\lim_{k \rightarrow + \infty} \beta^{k-1} p_{t+k} = 0\)</span>, this sequence converges to</p>
<div class="math notranslate nohighlight" id="equation-ddet">
<span class="eqno">(81.6)<a class="headerlink" href="#equation-ddet" title="Link to this equation">#</a></span>\[\bar p := \frac{\beta d}{1-\beta}\]</div>
<p>This is the equilibrium price in the constant dividend case.</p>
<p>Indeed, simple algebra shows that setting <span class="math notranslate nohighlight">\(p_t = \bar p\)</span> for all <span class="math notranslate nohighlight">\(t\)</span>
satisfies the difference equation <span class="math notranslate nohighlight">\(p_t = \beta (d + p_{t+1})\)</span>.</p>
</section>
<section id="example-2-dividends-with-deterministic-growth-paths">
<h3><span class="section-number">81.3.2. </span>Example 2: Dividends with Deterministic Growth Paths<a class="headerlink" href="#example-2-dividends-with-deterministic-growth-paths" title="Link to this heading">#</a></h3>
<p>Consider a growing, non-random dividend process <span class="math notranslate nohighlight">\(d_{t+1} = g d_t\)</span>
where <span class="math notranslate nohighlight">\(0 &lt; g \beta &lt; 1\)</span>.</p>
<p>While prices are not usually constant when dividends grow over time, a price
dividend-ratio can be.</p>
<p>If we guess this, substituting <span class="math notranslate nohighlight">\(v_t = v\)</span> into <a class="reference internal" href="#equation-pdex">(81.5)</a> as well as our
other assumptions, we get <span class="math notranslate nohighlight">\(v = \beta g (1 + v)\)</span>.</p>
<p>Since <span class="math notranslate nohighlight">\(\beta g &lt; 1\)</span>, we have a unique positive solution:</p>
<div class="math notranslate nohighlight">
\[
v = \frac{\beta g}{1 - \beta g }
\]</div>
<p>The price is then</p>
<div class="math notranslate nohighlight">
\[
p_t = \frac{\beta g}{1 - \beta g } d_t
\]</div>
<p>If, in this example, we take <span class="math notranslate nohighlight">\(g = 1+\kappa\)</span> and let
<span class="math notranslate nohighlight">\(\rho := 1/\beta - 1\)</span>, then the price becomes</p>
<div class="math notranslate nohighlight">
\[
p_t = \frac{1 + \kappa}{ \rho - \kappa} d_t
\]</div>
<p>This is called the <strong>Gordon formula</strong>.</p>
</section>
<section id="example-3-markov-growth-risk-neutral-pricing">
<span id="mass-mg"></span><h3><span class="section-number">81.3.3. </span>Example 3: Markov Growth, Risk-Neutral Pricing<a class="headerlink" href="#example-3-markov-growth-risk-neutral-pricing" title="Link to this heading">#</a></h3>
<p>Next, we consider a dividend process</p>
<div class="math notranslate nohighlight" id="equation-mass-fmce">
<span class="eqno">(81.7)<a class="headerlink" href="#equation-mass-fmce" title="Link to this equation">#</a></span>\[d_{t+1} = g_{t+1} d_t\]</div>
<p>The stochastic growth factor <span class="math notranslate nohighlight">\(\{g_t\}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
g_t = g(X_t), \quad t = 1, 2, \ldots
\]</div>
<p>where</p>
<ol class="arabic">
<li><p><span class="math notranslate nohighlight">\(\{X_t\}\)</span> is a finite Markov chain with state space <span class="math notranslate nohighlight">\(S\)</span> and
transition probabilities</p>
<div class="math notranslate nohighlight">
\[
   P(x, y) := \mathbb P \{ X_{t+1} = y \,|\, X_t = x \}
   \qquad (x, y \in S)
   \]</div>
</li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> is a given function on <span class="math notranslate nohighlight">\(S\)</span> taking nonnegative values</p></li>
</ol>
<p>You can think of</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span> as <span class="math notranslate nohighlight">\(n\)</span> possible “states of the world” and <span class="math notranslate nohighlight">\(X_t\)</span> as the
current state.</p></li>
<li><p><span class="math notranslate nohighlight">\(g\)</span> as a function that maps a given state <span class="math notranslate nohighlight">\(X_t\)</span> into a growth of dividends
factor <span class="math notranslate nohighlight">\(g_t = g(X_t)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\ln g_t = \ln (d_{t+1} / d_t)\)</span> is the growth rate of dividends.</p></li>
</ul>
<p>(For a refresher on notation and theory for finite Markov chains see <a class="reference internal" href="finite_markov.html"><span class="doc">this lecture</span></a>)</p>
<p>The next figure shows a simulation, where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\{X_t\}\)</span> evolves as a discretized AR1 process produced using <a class="reference internal" href="finite_markov.html#fm_ex3"><span class="std std-ref">Tauchen’s method</span></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(g_t = \exp(X_t)\)</span>, so that <span class="math notranslate nohighlight">\(\ln g_t = X_t\)</span> is the growth rate.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">tauchen</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">sim_length</span> <span class="o">=</span> <span class="mi">80</span>

<span class="n">x_series</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">sim_length</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span><span class="p">))</span>
<span class="n">g_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
<span class="n">d_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">g_series</span><span class="p">)</span> <span class="c1"># Assumes d_0 = 1</span>

<span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_series</span><span class="p">,</span> <span class="n">g_series</span><span class="p">,</span> <span class="n">d_series</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">d_series</span><span class="p">)]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$X_t$&#39;</span><span class="p">,</span> <span class="s1">&#39;$g_t$&#39;</span><span class="p">,</span> <span class="s1">&#39;$d_t$&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\log \, d_t$&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">series</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/17c7cb6256ffc4df60955932a43f354eba07298cc3c44f42fa7c920f4b3d4c2f.png" src="_images/17c7cb6256ffc4df60955932a43f354eba07298cc3c44f42fa7c920f4b3d4c2f.png" />
</div>
</div>
<section id="pricing-formula">
<h4><span class="section-number">81.3.3.1. </span>Pricing Formula<a class="headerlink" href="#pricing-formula" title="Link to this heading">#</a></h4>
<p>To obtain asset prices in this setting, let’s adapt our analysis from the case of deterministic growth.</p>
<p>In that case, we found that <span class="math notranslate nohighlight">\(v\)</span> is constant.</p>
<p>This encourages us to guess that, in the current case, <span class="math notranslate nohighlight">\(v_t\)</span> is a fixed function of the state <span class="math notranslate nohighlight">\(X_t\)</span>.</p>
<p>We seek a function <span class="math notranslate nohighlight">\(v\)</span> such that the price-dividend ratio satisfies  <span class="math notranslate nohighlight">\(v_t = v(X_t)\)</span>.</p>
<p>We can substitute this guess into <a class="reference internal" href="#equation-pdex">(81.5)</a> to get</p>
<div class="math notranslate nohighlight">
\[
v(X_t) = \beta {\mathbb E}_t [ g(X_{t+1}) (1 + v(X_{t+1})) ]
\]</div>
<p>If we condition on <span class="math notranslate nohighlight">\(X_t = x\)</span>, this becomes</p>
<div class="math notranslate nohighlight">
\[
v(x) = \beta \sum_{y \in S}  g(y) (1 + v(y)) P(x, y)
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-pstack">
<span class="eqno">(81.8)<a class="headerlink" href="#equation-pstack" title="Link to this equation">#</a></span>\[v(x) = \beta \sum_{y \in S}   K(x, y) (1 + v(y))
\quad \text{where} \quad
K(x, y) := g(y) P(x, y)\]</div>
<p>Suppose that there are <span class="math notranslate nohighlight">\(n\)</span> possible states <span class="math notranslate nohighlight">\(x_1, \ldots, x_n\)</span>.</p>
<p>We can then think of <a class="reference internal" href="#equation-pstack">(81.8)</a> as <span class="math notranslate nohighlight">\(n\)</span> stacked equations, one for each state, and write it in matrix form as</p>
<div class="math notranslate nohighlight" id="equation-vcumrn">
<span class="eqno">(81.9)<a class="headerlink" href="#equation-vcumrn" title="Link to this equation">#</a></span>\[v = \beta K (\mathbb 1 + v)\]</div>
<p>Here</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(v\)</span> is understood to be the column vector <span class="math notranslate nohighlight">\((v(x_1), \ldots, v(x_n))'\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(K\)</span> is the matrix <span class="math notranslate nohighlight">\((K(x_i, x_j))_{1 \leq i, j \leq n}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\({\mathbb 1}\)</span> is a column vector of ones.</p></li>
</ul>
<p>When does equation <a class="reference internal" href="#equation-vcumrn">(81.9)</a> have a unique solution?</p>
<p>From the <a class="reference internal" href="linear_algebra.html#la-neumann"><span class="std std-ref">Neumann series lemma</span></a> and Gelfand’s formula, equation <a class="reference internal" href="#equation-vcumrn">(81.9)</a> has a unique solution when <span class="math notranslate nohighlight">\(\beta K\)</span> has spectral radius strictly less than one.</p>
<p>Thus,  we require that the eigenvalues of <span class="math notranslate nohighlight">\(K\)</span>  be strictly less than <span class="math notranslate nohighlight">\(\beta^{-1}\)</span> in modulus.</p>
<p>The solution is then</p>
<div class="math notranslate nohighlight" id="equation-rned">
<span class="eqno">(81.10)<a class="headerlink" href="#equation-rned" title="Link to this equation">#</a></span>\[v = (I - \beta K)^{-1} \beta K{\mathbb 1}\]</div>
</section>
</section>
<section id="code">
<h3><span class="section-number">81.3.4. </span>Code<a class="headerlink" href="#code" title="Link to this heading">#</a></h3>
<p>Let’s calculate and plot the price-dividend ratio at some parameters.</p>
<p>As before, we’ll generate <span class="math notranslate nohighlight">\(\{X_t\}\)</span>  as a <a class="reference internal" href="finite_markov.html#fm_ex3"><span class="std std-ref">discretized AR1 process</span></a> and set <span class="math notranslate nohighlight">\(g_t = \exp(X_t)\)</span>.</p>
<p>Here’s the code, including a test of the spectral radius condition</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">25</span>  <span class="c1"># Size of state space</span>
<span class="n">β</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">tauchen</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">P</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span><span class="p">)</span>

<span class="n">warning_message</span> <span class="o">=</span> <span class="s2">&quot;Spectral radius condition fails&quot;</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigvals</span><span class="p">(</span><span class="n">K</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">β</span><span class="p">,</span>  <span class="n">warning_message</span>

<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="n">β</span> <span class="o">*</span> <span class="n">K</span><span class="p">,</span> <span class="n">β</span> <span class="o">*</span> <span class="n">K</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="s1">&#39;g-o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$v$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;price-dividend ratio&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b116cfe85230104c6a742bf8a8e9a4de4bf6de740062a26b9da3976949d11f04.png" src="_images/b116cfe85230104c6a742bf8a8e9a4de4bf6de740062a26b9da3976949d11f04.png" />
</div>
</div>
<p>Why does the price-dividend ratio increase with the state?</p>
<p>The reason is that this Markov process is positively correlated, so high
current states suggest high future states.</p>
<p>Moreover, dividend growth is increasing in the state.</p>
<p>The anticipation of high future dividend growth leads to a high price-dividend ratio.</p>
</section>
</section>
<section id="risk-aversion-and-asset-prices">
<h2><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">81.4. </span>Risk Aversion and Asset Prices</a><a class="headerlink" href="#risk-aversion-and-asset-prices" title="Link to this heading">#</a></h2>
<p>Now let’s turn to the case where agents are risk averse.</p>
<p>We’ll price several distinct assets, including</p>
<ul class="simple">
<li><p>An endowment stream</p></li>
<li><p>A consol (a type of bond issued by the UK government in the 19th century)</p></li>
<li><p>Call options on a consol</p></li>
</ul>
<section id="pricing-a-lucas-tree">
<h3><span class="section-number">81.4.1. </span>Pricing a Lucas Tree<a class="headerlink" href="#pricing-a-lucas-tree" title="Link to this heading">#</a></h3>
<p id="index-7">Let’s start with a version of the celebrated asset pricing model of Robert E. Lucas, Jr. <span id="id3">[<a class="reference internal" href="zreferences.html#id201" title="Robert E Lucas, Jr. Asset prices in an exchange economy. Econometrica: Journal of the Econometric Society, 46(6):1429–1445, 1978.">Lucas, 1978</a>]</span>.</p>
<p>Lucas considered an abstract pure exchange economy with these features:</p>
<ul class="simple">
<li><p>a single non-storable consumption good</p></li>
<li><p>a Markov process that governs the total amount of the consumption good available each period</p></li>
<li><p>a single <em>tree</em> that each period yields <em>fruit</em> that equals the total amount of consumption available to the economy</p></li>
<li><p>a competitive market in  <em>shares</em> in the tree that entitles their owners to corresponding shares of the <em>dividend</em> stream, i.e., the <em>fruit</em> stream, yielded by the tree</p></li>
<li><p>a representative consumer who in a competitive equilibrium</p>
<ul>
<li><p>consumes the economy’s entire endowment each period</p></li>
<li><p>owns 100 percent of the shares in the tree</p></li>
</ul>
</li>
</ul>
<p>As in <span id="id4">[<a class="reference internal" href="zreferences.html#id201" title="Robert E Lucas, Jr. Asset prices in an exchange economy. Econometrica: Journal of the Econometric Society, 46(6):1429–1445, 1978.">Lucas, 1978</a>]</span>, we suppose that the stochastic discount factor takes the form</p>
<div class="math notranslate nohighlight" id="equation-lucsdf">
<span class="eqno">(81.11)<a class="headerlink" href="#equation-lucsdf" title="Link to this equation">#</a></span>\[m_{t+1} = \beta \frac{u'(c_{t+1})}{u'(c_t)}\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is a concave utility function and <span class="math notranslate nohighlight">\(c_t\)</span> is time <span class="math notranslate nohighlight">\(t\)</span> consumption of a representative consumer.</p>
<p>(A derivation of this expression is given in a <a class="reference external" href="https://python-advanced.quantecon.org/lucas_model.html">later lecture</a>)</p>
<p>Assume the existence of an endowment that follows growth process <a class="reference internal" href="#equation-mass-fmce">(81.7)</a>.</p>
<p>The asset being priced is a claim on the endowment process, i.e., the <strong>Lucas tree</strong> described above.</p>
<p>Following <span id="id5">[<a class="reference internal" href="zreferences.html#id201" title="Robert E Lucas, Jr. Asset prices in an exchange economy. Econometrica: Journal of the Econometric Society, 46(6):1429–1445, 1978.">Lucas, 1978</a>]</span>, we suppose  that in equilibrium the representative consumer’s  consumption equals the aggregate endowment, so that <span class="math notranslate nohighlight">\(d_t = c_t\)</span> for all <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>For utility, we’ll assume the <strong>constant relative risk aversion</strong> (CRRA)
specification</p>
<div class="math notranslate nohighlight" id="equation-eqcrra">
<span class="eqno">(81.12)<a class="headerlink" href="#equation-eqcrra" title="Link to this equation">#</a></span>\[u(c) = \frac{c^{1-\gamma}}{1 - \gamma} \ {\rm with} \ \gamma &gt; 0\]</div>
<p>When <span class="math notranslate nohighlight">\(\gamma =1\)</span> we let <span class="math notranslate nohighlight">\(u(c) = \ln c\)</span>.</p>
<p>Inserting the CRRA specification into <a class="reference internal" href="#equation-lucsdf">(81.11)</a> and using <span class="math notranslate nohighlight">\(c_t = d_t\)</span> gives</p>
<div class="math notranslate nohighlight" id="equation-lucsdf2">
<span class="eqno">(81.13)<a class="headerlink" href="#equation-lucsdf2" title="Link to this equation">#</a></span>\[m_{t+1}
= \beta \left(\frac{c_{t+1}}{c_t}\right)^{-\gamma}
= \beta g_{t+1}^{-\gamma}\]</div>
<p>Substituting this into <a class="reference internal" href="#equation-pdex">(81.5)</a> gives the price-dividend ratio
formula</p>
<div class="math notranslate nohighlight" id="equation-eq-neweqn101">
<span class="eqno">(81.14)<a class="headerlink" href="#equation-eq-neweqn101" title="Link to this equation">#</a></span>\[
v(X_t)
= \beta {\mathbb E}_t
\left[
    g(X_{t+1})^{1-\gamma} (1 + v(X_{t+1}) )
\right]
\]</div>
<p>Conditioning on <span class="math notranslate nohighlight">\(X_t = x\)</span>, we can write this as</p>
<div class="math notranslate nohighlight">
\[
v(x)
= \beta \sum_{y \in S} g(y)^{1-\gamma} (1 + v(y) ) P(x, y)
\]</div>
<p>If we let</p>
<div class="math notranslate nohighlight">
\[
J(x, y) := g(y)^{1-\gamma}  P(x, y)
\]</div>
<p>then we can rewrite equation <a class="reference internal" href="#equation-eq-neweqn101">(81.14)</a> in vector form as</p>
<div class="math notranslate nohighlight">
\[
v = \beta J ({\mathbb 1} + v )
\]</div>
<p>Assuming that the spectral radius of <span class="math notranslate nohighlight">\(J\)</span> is strictly less than <span class="math notranslate nohighlight">\(\beta^{-1}\)</span>, this equation has the unique solution</p>
<div class="math notranslate nohighlight" id="equation-resolvent2">
<span class="eqno">(81.15)<a class="headerlink" href="#equation-resolvent2" title="Link to this equation">#</a></span>\[v = (I - \beta J)^{-1} \beta  J {\mathbb 1}\]</div>
<p>We will define a function tree_price to compute <span class="math notranslate nohighlight">\(v\)</span> given parameters stored in
the class AssetPriceModel</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AssetPriceModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that stores the primitives of the asset pricing model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    β : scalar, float</span>
<span class="sd">        Discount factor</span>
<span class="sd">    mc : MarkovChain</span>
<span class="sd">        Contains the transition matrix and set of state values for the state</span>
<span class="sd">        process</span>
<span class="sd">    γ : scalar(float)</span>
<span class="sd">        Coefficient of risk aversion</span>
<span class="sd">    g : callable</span>
<span class="sd">        The function mapping states to growth rates</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">β</span><span class="o">=</span><span class="mf">0.96</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">γ</span> <span class="o">=</span> <span class="n">β</span><span class="p">,</span> <span class="n">γ</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">g</span>

        <span class="c1"># A default process for the Markov chain</span>
        <span class="k">if</span> <span class="n">mc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ρ</span> <span class="o">=</span> <span class="mf">0.9</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">σ</span> <span class="o">=</span> <span class="mf">0.02</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mc</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">tauchen</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ρ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">σ</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mc</span> <span class="o">=</span> <span class="n">mc</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_stability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stability test for a given matrix Q.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigvals</span><span class="p">(</span><span class="n">Q</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sr</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">β</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Spectral radius condition failed with radius = </span><span class="si">{</span><span class="n">sr</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">tree_price</span><span class="p">(</span><span class="n">ap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the price-dividend ratio of the Lucas tree.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ap: AssetPriceModel</span>
<span class="sd">        An instance of AssetPriceModel containing primitives</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    v : array_like(float)</span>
<span class="sd">        Lucas tree price-dividend ratio</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simplify names, set up matrices</span>
    <span class="n">β</span><span class="p">,</span> <span class="n">γ</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="n">ap</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">γ</span><span class="p">)</span>

    <span class="c1"># Make sure that a unique solution exists</span>
    <span class="n">ap</span><span class="o">.</span><span class="n">test_stability</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>

    <span class="c1"># Compute v</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">Ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="n">β</span> <span class="o">*</span> <span class="n">J</span><span class="p">,</span> <span class="n">β</span> <span class="o">*</span> <span class="n">J</span> <span class="o">@</span> <span class="n">Ones</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">v</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s a plot of <span class="math notranslate nohighlight">\(v\)</span> as a function of the state for several values of <span class="math notranslate nohighlight">\(\gamma\)</span>,
with a positively correlated Markov process and <span class="math notranslate nohighlight">\(g(x) = \exp(x)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">γs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="n">ap</span> <span class="o">=</span> <span class="n">AssetPriceModel</span><span class="p">()</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">γ</span> <span class="ow">in</span> <span class="n">γs</span><span class="p">:</span>
    <span class="n">ap</span><span class="o">.</span><span class="n">γ</span> <span class="o">=</span> <span class="n">γ</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">tree_price</span><span class="p">(</span><span class="n">ap</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;$\gamma = </span><span class="si">{</span><span class="n">γ</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Price-dividend ratio as a function of the state&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;price-dividend ratio&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b98f39c4024d50967cd87a1ef9f6d5416757da05fd480de68138ead24e22cb65.png" src="_images/b98f39c4024d50967cd87a1ef9f6d5416757da05fd480de68138ead24e22cb65.png" />
</div>
</div>
<p>Notice that <span class="math notranslate nohighlight">\(v\)</span> is decreasing in each case.</p>
<p>This is because, with a positively correlated state process, higher states indicate higher future consumption growth.</p>
<p>With the stochastic discount factor <a class="reference internal" href="#equation-lucsdf2">(81.13)</a>, higher growth decreases the
discount factor, lowering the weight placed on future dividends.</p>
<section id="special-cases">
<h4><span class="section-number">81.4.1.1. </span>Special Cases<a class="headerlink" href="#special-cases" title="Link to this heading">#</a></h4>
<p>In the special case <span class="math notranslate nohighlight">\(\gamma =1\)</span>, we have <span class="math notranslate nohighlight">\(J = P\)</span>.</p>
<p>Recalling that <span class="math notranslate nohighlight">\(P^i {\mathbb 1} = {\mathbb 1}\)</span> for all <span class="math notranslate nohighlight">\(i\)</span> and applying <a class="reference internal" href="linear_algebra.html#la-neumann"><span class="std std-ref">Neumann’s geometric series lemma</span></a>, we are led to</p>
<div class="math notranslate nohighlight">
\[
v = \beta(I-\beta P)^{-1} {\mathbb 1}
= \beta \sum_{i=0}^{\infty} \beta^i P^i {\mathbb 1}
= \beta \frac{1}{1 - \beta} {\mathbb 1}
\]</div>
<p>Thus, with log preferences, the price-dividend ratio for a Lucas tree is constant.</p>
<p>Alternatively, if <span class="math notranslate nohighlight">\(\gamma = 0\)</span>, then <span class="math notranslate nohighlight">\(J = K\)</span> and we recover the
risk-neutral solution <a class="reference internal" href="#equation-rned">(81.10)</a>.</p>
<p>This is as expected, since <span class="math notranslate nohighlight">\(\gamma = 0\)</span> implies <span class="math notranslate nohighlight">\(u(c) = c\)</span> (and hence agents are risk-neutral).</p>
</section>
</section>
<section id="a-risk-free-consol">
<h3><span class="section-number">81.4.2. </span>A Risk-Free Consol<a class="headerlink" href="#a-risk-free-consol" title="Link to this heading">#</a></h3>
<p>Consider the same pure exchange representative agent economy.</p>
<p>A risk-free consol promises to pay a constant amount  <span class="math notranslate nohighlight">\(\zeta&gt; 0\)</span> each period.</p>
<p>Recycling notation, let <span class="math notranslate nohighlight">\(p_t\)</span> now be the price of an  ex-coupon claim to the consol.</p>
<p>An ex-coupon claim to the consol entitles an owner at the end of period <span class="math notranslate nohighlight">\(t\)</span> to</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\zeta\)</span> in period <span class="math notranslate nohighlight">\(t+1\)</span>, plus</p></li>
<li><p>the right to sell the claim for <span class="math notranslate nohighlight">\(p_{t+1}\)</span> next period</p></li>
</ul>
<p>The price satisfies <a class="reference internal" href="#equation-lteeqs0">(81.2)</a> with <span class="math notranslate nohighlight">\(d_t = \zeta\)</span>, or</p>
<div class="math notranslate nohighlight">
\[
p_t = {\mathbb E}_t \left[ m_{t+1}  ( \zeta + p_{t+1} ) \right]
\]</div>
<p>With the stochastic discount factor <a class="reference internal" href="#equation-lucsdf2">(81.13)</a>, this becomes</p>
<div class="math notranslate nohighlight" id="equation-consolguess1">
<span class="eqno">(81.16)<a class="headerlink" href="#equation-consolguess1" title="Link to this equation">#</a></span>\[p_t
= {\mathbb E}_t \left[ \beta g_{t+1}^{-\gamma}  ( \zeta + p_{t+1} ) \right]\]</div>
<p>Guessing a solution of the form <span class="math notranslate nohighlight">\(p_t = p(X_t)\)</span> and conditioning on
<span class="math notranslate nohighlight">\(X_t = x\)</span>, we get</p>
<div class="math notranslate nohighlight">
\[
p(x)
= \beta \sum_{y \in S}  g(y)^{-\gamma} (\zeta + p(y)) P(x, y)
\]</div>
<p>Letting <span class="math notranslate nohighlight">\(M(x, y) = P(x, y) g(y)^{-\gamma}\)</span> and rewriting in vector notation
yields the solution</p>
<div class="math notranslate nohighlight" id="equation-consol-price">
<span class="eqno">(81.17)<a class="headerlink" href="#equation-consol-price" title="Link to this equation">#</a></span>\[p = (I - \beta M)^{-1} \beta M \zeta {\mathbb 1}\]</div>
<p>The above is implemented in the function consol_price.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">consol_price</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">ζ</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes price of a consol bond with payoff ζ</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ap: AssetPriceModel</span>
<span class="sd">        An instance of AssetPriceModel containing primitives</span>

<span class="sd">    ζ : scalar(float)</span>
<span class="sd">        Coupon of the console</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    p : array_like(float)</span>
<span class="sd">        Console bond prices</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simplify names, set up matrices</span>
    <span class="n">β</span><span class="p">,</span> <span class="n">γ</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="n">ap</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span> <span class="n">γ</span><span class="p">)</span>

    <span class="c1"># Make sure that a unique solution exists</span>
    <span class="n">ap</span><span class="o">.</span><span class="n">test_stability</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

    <span class="c1"># Compute price</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">Ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">I</span> <span class="o">-</span> <span class="n">β</span> <span class="o">*</span> <span class="n">M</span><span class="p">,</span> <span class="n">β</span> <span class="o">*</span> <span class="n">ζ</span> <span class="o">*</span> <span class="n">M</span> <span class="o">@</span> <span class="n">Ones</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">p</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pricing-an-option-to-purchase-the-consol">
<h3><span class="section-number">81.4.3. </span>Pricing an Option to Purchase the Consol<a class="headerlink" href="#pricing-an-option-to-purchase-the-consol" title="Link to this heading">#</a></h3>
<p>Let’s now price options of various maturities.</p>
<p>We’ll study an option that  gives the owner the  right to purchase a consol at a price <span class="math notranslate nohighlight">\(p_S\)</span>.</p>
<section id="an-infinite-horizon-call-option">
<h4><span class="section-number">81.4.3.1. </span>An Infinite Horizon Call Option<a class="headerlink" href="#an-infinite-horizon-call-option" title="Link to this heading">#</a></h4>
<p>We want to price an <strong>infinite horizon</strong>  option to purchase a consol at a price <span class="math notranslate nohighlight">\(p_S\)</span>.</p>
<p>The option entitles the owner at the beginning of a period either</p>
<ol class="arabic simple">
<li><p>to purchase the bond at price <span class="math notranslate nohighlight">\(p_S\)</span> now, or</p></li>
<li><p>not to exercise the option to purchase the asset now but to retain the right to exercise it later</p></li>
</ol>
<p>Thus, the owner either <em>exercises</em> the option now or chooses <em>not to exercise</em> and wait until next period.</p>
<p>This is termed an infinite-horizon <strong>call option</strong> with <strong>strike price</strong> <span class="math notranslate nohighlight">\(p_S\)</span>.</p>
<p>The owner of the option is entitled to purchase the consol at  price <span class="math notranslate nohighlight">\(p_S\)</span> at the beginning of any period, after the coupon has been paid to the previous owner of the bond.</p>
<p>The fundamentals of the economy are identical with the one above, including the stochastic discount factor and the process for consumption.</p>
<p>Let <span class="math notranslate nohighlight">\(w(X_t, p_S)\)</span> be the value of the option when the time <span class="math notranslate nohighlight">\(t\)</span> growth state is known to be <span class="math notranslate nohighlight">\(X_t\)</span> but <em>before</em> the owner has decided whether to exercise the option
at time <span class="math notranslate nohighlight">\(t\)</span> (i.e., today).</p>
<p>Recalling that <span class="math notranslate nohighlight">\(p(X_t)\)</span> is the value of the consol when the initial growth state is <span class="math notranslate nohighlight">\(X_t\)</span>, the value of the option satisfies</p>
<div class="math notranslate nohighlight">
\[
w(X_t, p_S)
= \max \left\{
    \beta \, {\mathbb E}_t \frac{u'(c_{t+1})}{u'(c_t)} w(X_{t+1}, p_S), \;
         p(X_t) - p_S
\right\}
\]</div>
<p>The first term on the right is the value of waiting, while the second is the value of exercising now.</p>
<p>We can also write this as</p>
<div class="math notranslate nohighlight" id="equation-feoption0">
<span class="eqno">(81.18)<a class="headerlink" href="#equation-feoption0" title="Link to this equation">#</a></span>\[w(x, p_S)
= \max \left\{
    \beta \sum_{y \in S} P(x, y) g(y)^{-\gamma}
    w (y, p_S), \;
    p(x) - p_S
\right\}\]</div>
<p>With <span class="math notranslate nohighlight">\(M(x, y) = P(x, y) g(y)^{-\gamma}\)</span> and <span class="math notranslate nohighlight">\(w\)</span> as the vector of
values <span class="math notranslate nohighlight">\((w(x_i), p_S)_{i = 1}^n\)</span>, we can express <a class="reference internal" href="#equation-feoption0">(81.18)</a> as the nonlinear vector equation</p>
<div class="math notranslate nohighlight" id="equation-feoption">
<span class="eqno">(81.19)<a class="headerlink" href="#equation-feoption" title="Link to this equation">#</a></span>\[w = \max \{ \beta M w, \; p - p_S {\mathbb 1} \}\]</div>
<p>To solve <a class="reference internal" href="#equation-feoption">(81.19)</a>, form an operator <span class="math notranslate nohighlight">\(T\)</span> that maps vector <span class="math notranslate nohighlight">\(w\)</span>
into vector <span class="math notranslate nohighlight">\(Tw\)</span> via</p>
<div class="math notranslate nohighlight">
\[
T w
= \max \{ \beta M w,\; p - p_S {\mathbb 1} \}
\]</div>
<p>Start at some initial <span class="math notranslate nohighlight">\(w\)</span> and iterate with <span class="math notranslate nohighlight">\(T\)</span> to convergence .</p>
<p>We can find the solution with the following function call_option</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">call_option</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">ζ</span><span class="p">,</span> <span class="n">p_s</span><span class="p">,</span> <span class="n">ϵ</span><span class="o">=</span><span class="mf">1e-7</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes price of a call option on a consol bond.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ap: AssetPriceModel</span>
<span class="sd">        An instance of AssetPriceModel containing primitives</span>

<span class="sd">    ζ : scalar(float)</span>
<span class="sd">        Coupon of the console</span>

<span class="sd">    p_s : scalar(float)</span>
<span class="sd">        Strike price</span>

<span class="sd">    ϵ : scalar(float), optional(default=1e-8)</span>
<span class="sd">        Tolerance for infinite horizon problem</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : array_like(float)</span>
<span class="sd">        Infinite horizon call option prices</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simplify names, set up matrices</span>
    <span class="n">β</span><span class="p">,</span> <span class="n">γ</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="n">ap</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span> <span class="n">γ</span><span class="p">)</span>

    <span class="c1"># Make sure that a unique consol price exists</span>
    <span class="n">ap</span><span class="o">.</span><span class="n">test_stability</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

    <span class="c1"># Compute option price</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">consol_price</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">ζ</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">ϵ</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">error</span> <span class="o">&gt;</span> <span class="n">ϵ</span><span class="p">:</span>
        <span class="c1"># Maximize across columns</span>
        <span class="n">w_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">β</span> <span class="o">*</span> <span class="n">M</span> <span class="o">@</span> <span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="n">p_s</span><span class="p">)</span>
        <span class="c1"># Find maximal difference of each component and update</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">w_new</span><span class="p">))</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">w_new</span>

    <span class="k">return</span> <span class="n">w</span>
</pre></div>
</div>
</div>
</div>
<p>Here’s a plot of <span class="math notranslate nohighlight">\(w\)</span> compared to the consol price when <span class="math notranslate nohighlight">\(P_S = 40\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ap</span> <span class="o">=</span> <span class="n">AssetPriceModel</span><span class="p">(</span><span class="n">β</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">ζ</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">strike_price</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">consol_price</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">ζ</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">call_option</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">ζ</span><span class="p">,</span> <span class="n">strike_price</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;consol price&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;value of call option&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/70d3ad958efbe030806e5eedb65534919c82bf54a49de04c945f60fe55ab0035.png" src="_images/70d3ad958efbe030806e5eedb65534919c82bf54a49de04c945f60fe55ab0035.png" />
</div>
</div>
<p>In high values of the Markov growth state, the value of the option is close to zero.</p>
<p>This is despite the facts that the Markov chain is irreducible and that low states —
where the consol prices are high — will be visited recurrently.</p>
<p>The reason for low valuations in high Markov growth states is that <span class="math notranslate nohighlight">\(\beta=0.9\)</span>, so  future payoffs are  discounted substantially.</p>
</section>
</section>
<section id="risk-free-rates">
<h3><span class="section-number">81.4.4. </span>Risk-Free Rates<a class="headerlink" href="#risk-free-rates" title="Link to this heading">#</a></h3>
<p>Let’s look at risk-free interest rates over different periods.</p>
<section id="the-one-period-risk-free-interest-rate">
<h4><span class="section-number">81.4.4.1. </span>The One-period Risk-free Interest Rate<a class="headerlink" href="#the-one-period-risk-free-interest-rate" title="Link to this heading">#</a></h4>
<p>As before, the stochastic discount factor is <span class="math notranslate nohighlight">\(m_{t+1} = \beta g_{t+1}^{-\gamma}\)</span>.</p>
<p>It follows that the reciprocal <span class="math notranslate nohighlight">\(R_t^{-1}\)</span> of the gross risk-free interest rate <span class="math notranslate nohighlight">\(R_t\)</span> in state <span class="math notranslate nohighlight">\(x\)</span> is</p>
<div class="math notranslate nohighlight">
\[
{\mathbb E}_t m_{t+1} = \beta \sum_{y \in S} P(x, y) g(y)^{-\gamma}
\]</div>
<p>We can write this as</p>
<div class="math notranslate nohighlight">
\[
m_1 = \beta M {\mathbb 1}
\]</div>
<p>where the <span class="math notranslate nohighlight">\(i\)</span>-th  element of <span class="math notranslate nohighlight">\(m_1\)</span> is the reciprocal of the one-period gross risk-free interest rate in state <span class="math notranslate nohighlight">\(x_i\)</span>.</p>
</section>
<section id="other-terms">
<h4><span class="section-number">81.4.4.2. </span>Other Terms<a class="headerlink" href="#other-terms" title="Link to this heading">#</a></h4>
<p>Let <span class="math notranslate nohighlight">\(m_j\)</span> be an <span class="math notranslate nohighlight">\(n \times 1\)</span> vector whose <span class="math notranslate nohighlight">\(i\)</span> th component is the reciprocal of the <span class="math notranslate nohighlight">\(j\)</span> -period gross risk-free interest rate in state <span class="math notranslate nohighlight">\(x_i\)</span>.</p>
<p>Then <span class="math notranslate nohighlight">\(m_1 = \beta M\)</span>, and <span class="math notranslate nohighlight">\(m_{j+1} = M m_j\)</span> for <span class="math notranslate nohighlight">\(j \geq 1\)</span>.</p>
</section>
</section>
</section>
<section id="exercises">
<h2><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">81.5. </span>Exercises</a><a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<div class="exercise admonition" id="ma_ex1">

<p class="admonition-title"><span class="caption-number">Exercise 81.1 </span></p>
<section id="exercise-content">
<p>In the lecture, we considered <strong>ex-dividend assets</strong>.</p>
<p>A <strong>cum-dividend</strong> asset is a claim to the stream <span class="math notranslate nohighlight">\(d_t, d_{t+1}, \ldots\)</span>.</p>
<p>Following <a class="reference internal" href="#equation-rnapex">(81.1)</a>, find the risk-neutral asset pricing equation for
one unit of a cum-dividend asset.</p>
<p>With a constant, non-random dividend stream <span class="math notranslate nohighlight">\(d_t = d &gt; 0\)</span>, what is the equilibrium
price of a cum-dividend asset?</p>
<p>With a growing, non-random dividend process <span class="math notranslate nohighlight">\(d_t = g d_t\)</span> where <span class="math notranslate nohighlight">\(0 &lt; g \beta &lt; 1\)</span>,
what is the equilibrium price of a cum-dividend asset?</p>
</section>
</div>
<div class="solution dropdown admonition" id="markov_asset-solution-1">

<p class="admonition-title">Solution</p>
<section id="solution-content">
<p>For a cum-dividend asset, the basic risk-neutral asset pricing equation is</p>
<div class="math notranslate nohighlight">
\[
p_t = d_t + \beta {\mathbb E}_t [ p_{t+1} ]
\]</div>
<p id="mass-ex1">With constant dividends, the equilibrium price is</p>
<div class="math notranslate nohighlight">
\[
p_t = \frac{1}{1-\beta} d_t
\]</div>
<p>With a growing, non-random dividend process, the equilibrium price is</p>
<div class="math notranslate nohighlight">
\[
p_t = \frac{1}{1 - \beta g} d_t
\]</div>
</section>
</div>
<div class="exercise admonition" id="ma_ex2">

<p class="admonition-title"><span class="caption-number">Exercise 81.2 </span></p>
<section id="exercise-content">
<p>Consider the following primitives</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Size of State Space</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mf">0.0125</span><span class="p">)</span>
<span class="n">P</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">P</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># State values of the Markov chain</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.025</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">γ</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">β</span> <span class="o">=</span> <span class="mf">0.94</span>
</pre></div>
</div>
</div>
</div>
<p>Let <span class="math notranslate nohighlight">\(g\)</span> be defined by <span class="math notranslate nohighlight">\(g(x) = x\)</span>  (that is, <span class="math notranslate nohighlight">\(g\)</span> is the identity map).</p>
<p>Compute the price of the Lucas tree.</p>
<p>Do the same for</p>
<ul class="simple">
<li><p>the price of the risk-free consol when <span class="math notranslate nohighlight">\(\zeta = 1\)</span></p></li>
<li><p>the call option on the consol when <span class="math notranslate nohighlight">\(\zeta = 1\)</span> and <span class="math notranslate nohighlight">\(p_S = 150.0\)</span></p></li>
</ul>
</section>
</div>
<div class="solution dropdown admonition" id="markov_asset-solution-3">

<p class="admonition-title">Solution</p>
<section id="solution-content">
<p>First, let’s enter the parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mf">0.0125</span><span class="p">)</span>
<span class="n">P</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">P</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.025</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>  <span class="c1"># State values</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">MarkovChain</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">state_values</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

<span class="n">γ</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">β</span> <span class="o">=</span> <span class="mf">0.94</span>
<span class="n">ζ</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">p_s</span> <span class="o">=</span> <span class="mf">150.0</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we’ll create an instance of <code class="docutils literal notranslate"><span class="pre">AssetPriceModel</span></code> to feed into the
functions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">apm</span> <span class="o">=</span> <span class="n">AssetPriceModel</span><span class="p">(</span><span class="n">β</span><span class="o">=</span><span class="n">β</span><span class="p">,</span> <span class="n">mc</span><span class="o">=</span><span class="n">mc</span><span class="p">,</span> <span class="n">γ</span><span class="o">=</span><span class="n">γ</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we just need to call the relevant functions on the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree_price</span><span class="p">(</span><span class="n">apm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([29.47401578, 21.93570661, 17.57142236, 14.72515002, 12.72221763])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">consol_price</span><span class="p">(</span><span class="n">apm</span><span class="p">,</span> <span class="n">ζ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([753.87100476, 242.55144082, 148.67554548, 109.25108965,
        87.56860139])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">call_option</span><span class="p">(</span><span class="n">apm</span><span class="p">,</span> <span class="n">ζ</span><span class="p">,</span> <span class="n">p_s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([603.87100476, 176.8393343 , 108.67734499,  80.05179254,
        64.30843748])
</pre></div>
</div>
</div>
</div>
<p>Let’s show the last two functions as a plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">consol_price</span><span class="p">(</span><span class="n">apm</span><span class="p">,</span> <span class="n">ζ</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;consol&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">call_option</span><span class="p">(</span><span class="n">apm</span><span class="p">,</span> <span class="n">ζ</span><span class="p">,</span> <span class="n">p_s</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;call option&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a7a5f8ff0c6b9f4f47c35b88386b0fbbbe5d7739348431ea22cbc2e83a5d8162.png" src="_images/a7a5f8ff0c6b9f4f47c35b88386b0fbbbe5d7739348431ea22cbc2e83a5d8162.png" />
</div>
</div>
</section>
</div>
<div class="exercise admonition" id="ma_ex3">

<p class="admonition-title"><span class="caption-number">Exercise 81.3 </span></p>
<section id="exercise-content">
<p>Let’s consider finite horizon call options, which are more common than
infinite horizon ones.</p>
<p>Finite horizon options obey functional equations closely related to <a class="reference internal" href="#equation-feoption0">(81.18)</a>.</p>
<p>A <span class="math notranslate nohighlight">\(k\)</span> period option expires after <span class="math notranslate nohighlight">\(k\)</span> periods.</p>
<p>If we view today as date zero, a <span class="math notranslate nohighlight">\(k\)</span> period option gives the owner the right to exercise the option to purchase the risk-free consol at the strike price <span class="math notranslate nohighlight">\(p_S\)</span> at dates <span class="math notranslate nohighlight">\(0, 1, \ldots , k-1\)</span>.</p>
<p>The option expires at time <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>Thus, for <span class="math notranslate nohighlight">\(k=1, 2, \ldots\)</span>, let <span class="math notranslate nohighlight">\(w(x, k)\)</span> be the value of a <span class="math notranslate nohighlight">\(k\)</span>-period option.</p>
<p>It obeys</p>
<div class="math notranslate nohighlight">
\[
w(x, k)
= \max \left\{
    \beta \sum_{y \in S} P(x, y) g(y)^{-\gamma}
    w (y, k-1), \;
    p(x) - p_S
\right\}
\]</div>
<p>where <span class="math notranslate nohighlight">\(w(x, 0) = 0\)</span> for all <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>We can express this  as a sequence of nonlinear vector equations</p>
<div class="math notranslate nohighlight">
\[
w_k = \max \{ \beta M w_{k-1}, \; p - p_S {\mathbb 1} \}
  \quad k =1, 2, \ldots
  \quad \text{with } w_0 = 0
\]</div>
<p>Write a function that computes <span class="math notranslate nohighlight">\(w_k\)</span> for any given <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>Compute the value of the option with <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">=</span> <span class="pre">5</span></code> and <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">=</span> <span class="pre">25</span></code> using parameter values as in <a class="reference internal" href="#ma_ex1"><span class="std std-numref">Exercise 81.1</span></a>.</p>
<p>Is one higher than the other?  Can you give intuition?</p>
</section>
</div>
<div class="solution dropdown admonition" id="markov_asset-solution-5">

<p class="admonition-title">Solution</p>
<section id="solution-content">
<p>Here’s a suitable function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">finite_horizon_call_option</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">ζ</span><span class="p">,</span> <span class="n">p_s</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes k period option value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simplify names, set up matrices</span>
    <span class="n">β</span><span class="p">,</span> <span class="n">γ</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ap</span><span class="o">.</span><span class="n">β</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">γ</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">ap</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">state_values</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="n">ap</span><span class="o">.</span><span class="n">g</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span> <span class="n">γ</span><span class="p">)</span>

    <span class="c1"># Make sure that a unique solution exists</span>
    <span class="n">ap</span><span class="o">.</span><span class="n">test_stability</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>


    <span class="c1"># Compute option price</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">consol_price</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">ζ</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ap</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="c1"># Maximize across columns</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">β</span> <span class="o">*</span> <span class="n">M</span> <span class="o">@</span> <span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">-</span> <span class="n">p_s</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">w</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s compute the option values at <code class="docutils literal notranslate"><span class="pre">k=5</span></code> and <code class="docutils literal notranslate"><span class="pre">k=25</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">]:</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">finite_horizon_call_option</span><span class="p">(</span><span class="n">apm</span><span class="p">,</span> <span class="n">ζ</span><span class="p">,</span> <span class="n">p_s</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$k = </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/598b8bc179a9a9d4fee794555dc4a7446828cf747e951fb1e67a8d9a504f5268.png" src="_images/598b8bc179a9a9d4fee794555dc4a7446828cf747e951fb1e67a8d9a504f5268.png" />
</div>
</div>
<p>Not surprisingly,  options with larger <span class="math notranslate nohighlight">\(k\)</span> are worth more.</p>
<p>This is because an owner has a longer  horizon over which
the option can be exercised.</p>
</section>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                    <p>A theme by <a href="https://quantecon.org">QuantEcon</a></p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   1. Modeling COVID 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   2. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   3. QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   4. Circulant Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   5. Singular Value Decomposition (SVD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   6. VARs and DMDs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   7. Using Newton’s Method to Solve Economic Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementary Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   8. Elementary Probability with Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stats_examples.html">
   9. Some Probability Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   10. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   11. Two Meanings of Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   12. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   13. Multivariate Normal Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   14. Fault Tree Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   15. Introduction to Artificial Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   16. Randomized Response Surveys
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   17. Expected Utilities of Random Responses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bayes Law
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   18. Non-Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   19. Posterior Distributions for  AR(1) Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   20. Forecasting  an AR(1) Process
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Statistics and Information
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="divergence_measures.html">
   21. Statistical Divergence Measures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   22. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process_2.html">
   23. Heterogeneous Beliefs and Financial Markets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_var.html">
   24. Likelihood Processes For VAR Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   25. Mean of a Likelihood Ratio Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   26. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman_2.html">
   27. A Bayesian Formulation of Friedman and Wald’s Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   28. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   29. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   30. Incorrect Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   31. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   32. Optimal Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   33. Von Neumann Growth Model (and a Generalization)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   34. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   35. Inventory Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   36. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   37. Samuelson Multiplier-Accelerator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   38. Kesten Processes and Firm Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   39. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   40. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   41. Another Look at the Kalman Filter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Search
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   42. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   43. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_sep_markov.html">
   44. Job Search III: Search with Separation and Markov Wages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   45. Job Search IV: Fitted Value Function Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_persist_trans.html">
   46. Job Search V: Persistent and Transitory Wage Shocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   47. Job Search VI: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   48. Job Search VII: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   49. Job Search VIII: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   50. Job Search IX: Search with Q-Learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Optimal Savings
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="os.html">
   51. Optimal Savings I: Cake Eating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_numerical.html">
   52. Optimal Savings II: Numerical Cake Eating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_stochastic.html">
   53. Optimal Savings III: Stochastic Returns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_time_iter.html">
   54. Optimal Savings IV: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_egm.html">
   55. Optimal Savings V: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="os_egm_jax.html">
   56. Optimal Savings VI: EGM with JAX
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Household Problems
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_discrete.html">
   57. The Income Fluctuation Problem I: Discretization and VFI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_opi.html">
   58. The Income Fluctuation Problem II: Optimistic Policy Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_egm.html">
   59. The Income Fluctuation Problem III: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_egm_transient_shocks.html">
   60. The Income Fluctuation Problem IV: Transient Income Shocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   61. The Income Fluctuation Problem V: Stochastic Returns on Assets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   62. LQ Control: Foundations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   63. Lagrangian for LQ Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   64. Eliminating Cross Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   65. The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   66. Permanent Income II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   67. Production Smoothing via Inventories
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Optimal Growth
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   68. Cass-Koopmans Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   69. Cass-Koopmans Competitive Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal.html">
   70. Cass-Koopmans Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_fiscal_2.html">
   71. Two-Country Model with Distorting Taxes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak2.html">
   72. Transitions in an Overlapping Generations Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   73. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="endogenous_lake.html">
   74. Lake Model with an Endogenous Job Finding Rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   75. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   76. Stability in Linear Rational Expectations Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   77. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   78. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   79. The Aiyagari Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ak_aiyagari.html">
   80. A Long-Lived, Heterogeneous Agent, Overlapping Generations Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   81. Asset Pricing: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   82. Competitive Equilibria with Arrow Securities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   83. Heterogeneous Beliefs and Bubbles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="morris_learn.html">
   84. Speculative Behavior with Bayesian Learning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data and Empirics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   85. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   86. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   87. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Auctions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   88. First-Price and Second-Price Auctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   89. Multiple Good Allocation Mechanisms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   90. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   91. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   92. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/markov_asset.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <!--
                    # Enable if looking for link to specific document hosted on GitHub
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/blob/main/lectures/markov_asset.md" download><i data-feather="github"></i></a></li>
                    -->
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/markov_asset.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/markov_asset.ipynb" data-branch=main>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/main/markov_asset.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "markov_asset";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/markov_asset.ipynb";
                const branch = "main"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>