

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>70. Stability in Linear Rational Expectations Models &#8212; Intermediate Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/quantecon-book-theme.css?digest=b09b2da44b9015b4fa76ea072fa2d8f7faee5492" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/scripts/quantecon-book-theme.js?digest=eed9c059a3ee152aae2353ec732f0a6d12e6aa07"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-J0SMYR4SG3"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-J0SMYR4SG3');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 're_with_feedback';</script>
    <link rel="canonical" href="https://python.quantecon.org/re_with_feedback.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="71. Markov Perfect Equilibrium" href="markov_perf.html" />
    <link rel="prev" title="69. Rational Expectations Equilibrium" href="rational_expectations.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Stability in Linear Rational Expectations Models"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Stability in Linear Rational Expectations Models" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/re_with_feedback.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Intermediate Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=re_with_feedback>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">70.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-difference-equations">70.2. Linear Difference Equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#first-order">70.2.1. First Order</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order">70.2.2. Second Order</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#illustration-cagans-model">70.3. Illustration: Cagan’s Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#some-python-code">70.4. Some Python Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-code">70.5. Alternative Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#special-case">70.5.1. Special Case</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-perspective">70.6. Another Perspective</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#refining-the-formula">70.6.1. Refining the Formula</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remarks-about-feedback">70.6.2. Remarks about Feedback</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#log-money-supply-feeds-back-on-log-price-level">70.7. Log money Supply Feeds Back on Log Price Level</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#big-p-little-p-interpretation">70.8. Big <span class="math notranslate nohighlight">\(P\)</span>, Little <span class="math notranslate nohighlight">\(p\)</span> Interpretation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fun-with-sympy">70.9. Fun with SymPy</a></li>
</ul>
                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo logo-img" alt="logo"></a>
                                    
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Intermediate Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Stability in Linear Rational Expectations Models</p>

                    </div>
                    <!-- length 2, since its a string and empty dict has length 2 - {} -->
                        <p class="qe-page__header-authors" font-size="18">
                            
                                
                                    <a href="http://www.tomsargent.com/" target="_blank"><span>Thomas J. Sargent</span></a>
                                
                            
                                
                                    and <a href="https://johnstachurski.net/" target="_blank"><span>John Stachurski</span></a>
                                
                            
                        </p>


                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <div id="qe-notebook-header" align="right" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" width="250px" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><section class="tex2jax_ignore mathjax_ignore" id="stability-in-linear-rational-expectations-models">
<h1><a class="toc-backref" href="#id8"><span class="section-number">70. </span>Stability in Linear Rational Expectations Models</a><a class="headerlink" href="#stability-in-linear-rational-expectations-models" title="Permalink to this heading">#</a></h1>
<div class="contents topic" id="contents">
<span id="index-0"></span><p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#stability-in-linear-rational-expectations-models" id="id8">Stability in Linear Rational Expectations Models</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id9">Overview</a></p></li>
<li><p><a class="reference internal" href="#linear-difference-equations" id="id10">Linear Difference Equations</a></p></li>
<li><p><a class="reference internal" href="#illustration-cagans-model" id="id11">Illustration: Cagan’s Model</a></p></li>
<li><p><a class="reference internal" href="#some-python-code" id="id12">Some Python Code</a></p></li>
<li><p><a class="reference internal" href="#alternative-code" id="id13">Alternative Code</a></p></li>
<li><p><a class="reference internal" href="#another-perspective" id="id14">Another Perspective</a></p></li>
<li><p><a class="reference internal" href="#log-money-supply-feeds-back-on-log-price-level" id="id15">Log money Supply Feeds Back on Log Price Level</a></p></li>
<li><p><a class="reference internal" href="#big-p-little-p-interpretation" id="id16">Big <span class="math notranslate nohighlight">\(P\)</span>, Little <span class="math notranslate nohighlight">\(p\)</span> Interpretation</a></p></li>
<li><p><a class="reference internal" href="#fun-with-sympy" id="id17">Fun with SymPy</a></p></li>
</ul>
</li>
</ul>
</div>
<p>In addition to what’s in Anaconda, this lecture deploys the following libraries:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>quantecon
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: quantecon in /opt/conda/envs/quantecon/lib/python3.11/site-packages (0.7.1)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: numba&gt;=0.49.0 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from quantecon) (0.57.1)
Requirement already satisfied: numpy&gt;=1.17.0 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from quantecon) (1.24.3)
Requirement already satisfied: requests in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from quantecon) (2.31.0)
Requirement already satisfied: scipy&gt;=1.5.0 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from quantecon) (1.11.1)
Requirement already satisfied: sympy in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from quantecon) (1.11.1)
Requirement already satisfied: llvmlite&lt;0.41,&gt;=0.40.0dev0 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from numba&gt;=0.49.0-&gt;quantecon) (0.40.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from requests-&gt;quantecon) (2.0.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from requests-&gt;quantecon) (3.4)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from requests-&gt;quantecon) (1.26.16)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from requests-&gt;quantecon) (2023.7.22)
Requirement already satisfied: mpmath&gt;=0.19 in /opt/conda/envs/quantecon/lib/python3.11/site-packages (from sympy-&gt;quantecon) (1.3.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv</span>

</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1">#set default figure size</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">quantecon</span> <span class="k">as</span> <span class="nn">qe</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">init_printing</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Matrix</span>
<span class="n">init_printing</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id9"><span class="section-number">70.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>This lecture studies stability in the context of an elementary rational expectations model.</p>
<p>We study a rational expectations version of Philip Cagan’s model <span id="id1">[<a class="reference internal" href="zreferences.html#id92" title="Philip Cagan. The monetary dynamics of hyperinflation. In Milton Friedman, editor, Studies in the Quantity Theory of Money, pages 25–117. University of Chicago Press, Chicago, 1956.">Cag56</a>]</span> linking
the price level to the money supply.</p>
<p>Cagan did not use a rational expectations version of his model, but Sargent <span id="id2">[<a class="reference internal" href="zreferences.html#id93" title="Thomas J Sargent. The Demand for Money During Hyperinflations under Rational Expectations: I. International Economic Review, 18(1):59-82, February 1977.">Sar77</a>]</span> did.</p>
<p>We study a rational expectations version of this model because it is intrinsically interesting and  because it
has a mathematical structure that
appears in virtually all  linear rational expectations model, namely, that a key  endogenous variable equals
a mathematical expectation of a geometric sum of future values of another variable.</p>
<p>The model determines  the price level or rate of inflation as a function of  the money supply or the rate of change in the money supply.</p>
<p>In this lecture, we’ll encounter:</p>
<ul class="simple">
<li><p>a convenient formula for the expectation of geometric sum of future values of a variable</p></li>
<li><p>a way of solving an expectational difference equation by mapping it into a vector first-order difference equation and appropriately manipulating an eigen decomposition of the transition matrix in order to impose stability</p></li>
<li><p>a way to use a Big <span class="math notranslate nohighlight">\(K\)</span>, little <span class="math notranslate nohighlight">\(k\)</span> argument to allow apparent feedback from endogenous to exogenous variables within a rational expectations equilibrium</p></li>
<li><p>a use of eigenvector decompositions of matrices that allowed Blanchard and Khan (1981) <span id="id3">[<a class="reference internal" href="zreferences.html#id251" title="Olivier Jean Blanchard and Charles M Kahn. The Solution of Linear Difference Models under Rational Expectations. Econometrica, 48(5):1305-1311, July 1980.">BK80</a>]</span> and Whiteman (1983) <span id="id4">[<a class="reference internal" href="zreferences.html#id252" title="Charles Whiteman. Linear Rational Expectations Models: A User's Guide. University of Minnesota Press, Minneapolis, Minnesota, 1983.">Whi83</a>]</span> to solve a class of linear rational expectations models</p></li>
<li><p>how to use <strong>SymPy</strong> to get analytical formulas for some key objects comprising a rational expectations equilibrium</p></li>
</ul>
<p>Matrix decompositions employed here are described in more depth in this lecture <a class="reference internal" href="lagrangian_lqdp.html"><span class="doc">Lagrangian formulations</span></a>.</p>
<p>We formulate a version of  Cagan’s model under  rational expectations
as an <strong>expectational difference equation</strong> whose solution is a rational expectations equilibrium.</p>
<p>We’ll start this lecture with a quick review of deterministic (i.e., non-random)
first-order and second-order linear difference equations.</p>
</section>
<section id="linear-difference-equations">
<h2><a class="toc-backref" href="#id10"><span class="section-number">70.2. </span>Linear Difference Equations</a><a class="headerlink" href="#linear-difference-equations" title="Permalink to this heading">#</a></h2>
<p>We’ll use the <em>backward shift</em> or <em>lag</em> operator <span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>The lag operator <span class="math notranslate nohighlight">\(L\)</span>  maps a sequence <span class="math notranslate nohighlight">\(\{x_t\}_{t=0}^\infty\)</span> into the sequence <span class="math notranslate nohighlight">\(\{x_{t-1}\}_{t=0}^\infty\)</span></p>
<p>We’ll deploy  <span class="math notranslate nohighlight">\(L\)</span>  by using the equality
<span class="math notranslate nohighlight">\(L x_t \equiv x_{t-1}\)</span> in algebraic expressions.</p>
<p>Further,  the inverse <span class="math notranslate nohighlight">\(L^{-1}\)</span> of the lag operator is  the <em>forward shift</em>
operator.</p>
<p>We’ll often use the equality  <span class="math notranslate nohighlight">\(L^{-1} x_t \equiv x_{t+1}\)</span> below.</p>
<p>The algebra of lag and forward shift operators can simplify representing and solving linear difference equations.</p>
<section id="first-order">
<h3><span class="section-number">70.2.1. </span>First Order<a class="headerlink" href="#first-order" title="Permalink to this heading">#</a></h3>
<p>We want to solve a linear first-order scalar difference equation.</p>
<p>Let <span class="math notranslate nohighlight">\(|\lambda | &lt; 1\)</span> and let
<span class="math notranslate nohighlight">\(\{u_t\}_{t=-\infty}^\infty\)</span> be a bounded sequence of scalar real
numbers.</p>
<p>Let <span class="math notranslate nohighlight">\(L\)</span> be the lag operator defined by
<span class="math notranslate nohighlight">\(L x_t \equiv x_{t-1}\)</span> and let <span class="math notranslate nohighlight">\(L^{-1}\)</span> be the forward shift
operator defined by <span class="math notranslate nohighlight">\(L^{-1} x_t \equiv x_{t+1}\)</span>.</p>
<p>Then</p>
<div class="math notranslate nohighlight" id="equation-equn-1">
<span class="eqno">(70.1)<a class="headerlink" href="#equation-equn-1" title="Permalink to this equation">#</a></span>\[(1 - \lambda L) y_t = u_t, \forall t\]</div>
<p>has solutions</p>
<div class="math notranslate nohighlight" id="equation-equn-2">
<span class="eqno">(70.2)<a class="headerlink" href="#equation-equn-2" title="Permalink to this equation">#</a></span>\[y_t = (1 -\lambda L)^{-1} u_t +k \lambda^t\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
y_t =  \sum_{j=0}^\infty \lambda^j u_{t-j} +k \lambda^t
\]</div>
<p>for any real number <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>You can verify this fact by applying <span class="math notranslate nohighlight">\((1-\lambda L)\)</span> to both sides
of equation <a class="reference internal" href="#equation-equn-2">(70.2)</a> and noting that <span class="math notranslate nohighlight">\((1 - \lambda L) \lambda^t =0\)</span>.</p>
<p>To pin down <span class="math notranslate nohighlight">\(k\)</span> we need one condition imposed from outside (e.g.,
an initial or terminal condition) on the path of <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>Now let <span class="math notranslate nohighlight">\(| \lambda | &gt; 1\)</span>.</p>
<p>Rewrite equation <a class="reference internal" href="#equation-equn-1">(70.1)</a> as</p>
<div class="math notranslate nohighlight" id="equation-equn-3">
<span class="eqno">(70.3)<a class="headerlink" href="#equation-equn-3" title="Permalink to this equation">#</a></span>\[y_{t-1} = \lambda^{-1} y_t - \lambda^{-1} u_t , \forall t\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-equn-4">
<span class="eqno">(70.4)<a class="headerlink" href="#equation-equn-4" title="Permalink to this equation">#</a></span>\[(1 - \lambda^{-1} L^{-1}) y_t = - \lambda^{-1} u_{t+1}.\]</div>
<p>A solution is</p>
<div class="math notranslate nohighlight" id="equation-equn-5">
<span class="eqno">(70.5)<a class="headerlink" href="#equation-equn-5" title="Permalink to this equation">#</a></span>\[y_t = - \lambda^{-1}\left({ 1 \over  1 - \lambda^{-1} L^{-1}} \right)
         u_{t+1} + k \lambda^t\]</div>
<p>for any <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>To verify that this is a solution, check the consequences of operating
on both sides of equation <a class="reference internal" href="#equation-equn-5">(70.5)</a> by <span class="math notranslate nohighlight">\((1 -\lambda L)\)</span> and compare to
equation <a class="reference internal" href="#equation-equn-1">(70.1)</a>.</p>
<p>For any bounded <span class="math notranslate nohighlight">\(\{u_t\}\)</span> sequence, solution <a class="reference internal" href="#equation-equn-2">(70.2)</a> exists for <span class="math notranslate nohighlight">\(|\lambda | &lt; 1\)</span> because
the <strong>distributed lag</strong> in <span class="math notranslate nohighlight">\(u\)</span> converges.</p>
<p>Solution <a class="reference internal" href="#equation-equn-5">(70.5)</a> exists when <span class="math notranslate nohighlight">\(|\lambda| &gt; 1\)</span> because the <strong>distributed
lead</strong> in <span class="math notranslate nohighlight">\(u\)</span> converges.</p>
<p>When <span class="math notranslate nohighlight">\(|\lambda | &gt; 1\)</span>, the distributed lag in <span class="math notranslate nohighlight">\(u\)</span> in <a class="reference internal" href="#equation-equn-2">(70.2)</a> may
diverge, in which case a solution of this form does not exist.</p>
<p>The distributed lead in <span class="math notranslate nohighlight">\(u\)</span> in <a class="reference internal" href="#equation-equn-5">(70.5)</a> need not
converge when <span class="math notranslate nohighlight">\(|\lambda| &lt; 1\)</span>.</p>
</section>
<section id="second-order">
<h3><span class="section-number">70.2.2. </span>Second Order<a class="headerlink" href="#second-order" title="Permalink to this heading">#</a></h3>
<p>Now consider the second order difference equation</p>
<div class="math notranslate nohighlight" id="equation-equn-6">
<span class="eqno">(70.6)<a class="headerlink" href="#equation-equn-6" title="Permalink to this equation">#</a></span>\[(1-\lambda_1 L) (1 - \lambda_2 L) y_{t+1} = u_t\]</div>
<p>where <span class="math notranslate nohighlight">\(\{u_t\}\)</span> is a bounded sequence, <span class="math notranslate nohighlight">\(y_0\)</span> is an initial
condition, <span class="math notranslate nohighlight">\(| \lambda_1 | &lt; 1\)</span> and <span class="math notranslate nohighlight">\(| \lambda_2| &gt;1\)</span>.</p>
<p>We seek a bounded sequence <span class="math notranslate nohighlight">\(\{y_t\}_{t=0}^\infty\)</span> that satisfies
<a class="reference internal" href="#equation-equn-6">(70.6)</a>. Using insights from our analysis of the first-order equation,
operate on both sides of <a class="reference internal" href="#equation-equn-6">(70.6)</a> by the forward inverse of
<span class="math notranslate nohighlight">\((1-\lambda_2 L)\)</span> to rewrite equation <a class="reference internal" href="#equation-equn-6">(70.6)</a> as</p>
<div class="math notranslate nohighlight">
\[
(1-\lambda_1 L) y_{t+1} = -{\frac{\lambda_2^{-1}}{1 - \lambda_2^{-1}L^{-1}}} u_{t+1}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-equn-7">
<span class="eqno">(70.7)<a class="headerlink" href="#equation-equn-7" title="Permalink to this equation">#</a></span>\[y_{t+1} = \lambda_1 y_t - \lambda_2^{-1} \sum_{j=0}^\infty \lambda_2^{-j} u_{t+j+1} .\]</div>
<p>Thus, we obtained equation <a class="reference internal" href="#equation-equn-7">(70.7)</a> by
solving a stable root (in this case <span class="math notranslate nohighlight">\(\lambda_1\)</span>) <strong>backward</strong>, and an
unstable root (in this case <span class="math notranslate nohighlight">\(\lambda_2\)</span>) <strong>forward</strong>.</p>
<p>Equation <a class="reference internal" href="#equation-equn-7">(70.7)</a> has a form that we shall encounter often.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda_1 y_t\)</span> is called the <strong>feedback part</strong></p></li>
<li><p><span class="math notranslate nohighlight">\(-{\frac{\lambda_2^{-1}}{1 - \lambda_2^{-1}L^{-1}}} u_{t+1}\)</span> is called the <strong>feedforward part</strong></p></li>
</ul>
</section>
</section>
<section id="illustration-cagans-model">
<h2><a class="toc-backref" href="#id11"><span class="section-number">70.3. </span>Illustration: Cagan’s Model</a><a class="headerlink" href="#illustration-cagans-model" title="Permalink to this heading">#</a></h2>
<p>Now let’s use linear difference equations to represent and solve Sargent’s  <span id="id5">[<a class="reference internal" href="zreferences.html#id93" title="Thomas J Sargent. The Demand for Money During Hyperinflations under Rational Expectations: I. International Economic Review, 18(1):59-82, February 1977.">Sar77</a>]</span> rational expectations version of
Cagan’s model <span id="id6">[<a class="reference internal" href="zreferences.html#id92" title="Philip Cagan. The monetary dynamics of hyperinflation. In Milton Friedman, editor, Studies in the Quantity Theory of Money, pages 25–117. University of Chicago Press, Chicago, 1956.">Cag56</a>]</span> that connects the price level to the public’s anticipations of future money supplies.</p>
<p>Cagan did not use a rational expectations version of his model, but Sargent <span id="id7">[<a class="reference internal" href="zreferences.html#id93" title="Thomas J Sargent. The Demand for Money During Hyperinflations under Rational Expectations: I. International Economic Review, 18(1):59-82, February 1977.">Sar77</a>]</span></p>
<p>Let</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(m_t^d\)</span> be the log of the demand for money</p></li>
<li><p><span class="math notranslate nohighlight">\(m_t\)</span> be the log of the supply of money</p></li>
<li><p><span class="math notranslate nohighlight">\(p_t\)</span> be the log of the price level</p></li>
</ul>
<p>It follows that <span class="math notranslate nohighlight">\(p_{t+1} - p_t\)</span> is the rate of inflation.</p>
<p>The logarithm of the demand for real money balances <span class="math notranslate nohighlight">\(m_t^d - p_t\)</span>
is an inverse function of the expected rate of inflation
<span class="math notranslate nohighlight">\(p_{t+1} - p_t\)</span> for <span class="math notranslate nohighlight">\(t \geq 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[
m_t^d - p_t = - \beta (p_{t+1} - p_t ), \quad \beta &gt;0
\]</div>
<p>Equate the demand for log money <span class="math notranslate nohighlight">\(m_t^d\)</span> to the supply of log money
<span class="math notranslate nohighlight">\(m_t\)</span> in the above equation and rearrange to deduce that the
logarithm of the price level <span class="math notranslate nohighlight">\(p_t\)</span> is related to the logarithm of
the money supply <span class="math notranslate nohighlight">\(m_t\)</span> by</p>
<div class="math notranslate nohighlight" id="equation-equation-1">
<span class="eqno">(70.8)<a class="headerlink" href="#equation-equation-1" title="Permalink to this equation">#</a></span>\[p_t = (1 -\lambda) m_t + \lambda p_{t+1}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda \equiv \frac{\beta}{1+\beta} \in (0,1)\)</span>.</p>
<p>(We note that the characteristic polynomial if <span class="math notranslate nohighlight">\(1 - \lambda^{-1} z^{-1} = 0\)</span> so that the zero of the
characteristic polynomial in this case is <span class="math notranslate nohighlight">\(\lambda \in (0,1)\)</span> which here is <strong>inside</strong> the unit circle.)</p>
<p>Solving the first order difference equation <a class="reference internal" href="#equation-equation-1">(70.8)</a> forward gives</p>
<div class="math notranslate nohighlight" id="equation-equation-2">
<span class="eqno">(70.9)<a class="headerlink" href="#equation-equation-2" title="Permalink to this equation">#</a></span>\[p_t = (1 - \lambda) \sum_{j=0}^\infty \lambda^j m_{t+j},\]</div>
<p>which is the unique <strong>stable</strong> solution of difference equation <a class="reference internal" href="#equation-equation-1">(70.8)</a> among
a class of more general solutions</p>
<div class="math notranslate nohighlight" id="equation-equation-1a">
<span class="eqno">(70.10)<a class="headerlink" href="#equation-equation-1a" title="Permalink to this equation">#</a></span>\[p_t = (1 - \lambda) \sum_{j=0}^\infty \lambda^j m_{t+j} + c \lambda^{-t}\]</div>
<p>that is indexed by the real number <span class="math notranslate nohighlight">\(c \in {\bf R}\)</span>.</p>
<p>Because we want to focus on stable solutions, we set <span class="math notranslate nohighlight">\(c=0\)</span>.</p>
<p>Equation <a class="reference internal" href="#equation-equation-1a">(70.10)</a> attributes  <strong>perfect foresight</strong> about the money supply sequence to the holders of real balances.</p>
<p>We begin by assuming that the log of the money supply is <strong>exogenous</strong>
in the sense that it is an autonomous process that does not feed back on
the log of the price level.</p>
<p>In particular, we assume that the log of the money supply is described
by the linear state space system</p>
<div class="math notranslate nohighlight" id="equation-equation-3">
<span class="eqno">(70.11)<a class="headerlink" href="#equation-equation-3" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
  m_t &amp;  = G x_t \\ x_{t+1} &amp; = A x_t
 \end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(x_t\)</span> is an <span class="math notranslate nohighlight">\(n \times 1\)</span> vector that does not include
<span class="math notranslate nohighlight">\(p_t\)</span> or lags of <span class="math notranslate nohighlight">\(p_t\)</span>, <span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span>
matrix with eigenvalues that are less than <span class="math notranslate nohighlight">\(\lambda^{-1}\)</span> in
absolute values, and <span class="math notranslate nohighlight">\(G\)</span> is a <span class="math notranslate nohighlight">\(1 \times n\)</span> selector matrix.</p>
<p>Variables appearing in the vector <span class="math notranslate nohighlight">\(x_t\)</span> contain information that
might help predict future values of the money supply.</p>
<p>We’ll start with an example in which <span class="math notranslate nohighlight">\(x_t\)</span> includes only <span class="math notranslate nohighlight">\(m_t\)</span>,
possibly lagged values of <span class="math notranslate nohighlight">\(m\)</span>, and a constant.</p>
<p>An example of such an <span class="math notranslate nohighlight">\(\{m_t\}\)</span> process that fits info state space
system <a class="reference internal" href="#equation-equation-3">(70.11)</a> is one that satisfies the second order linear difference
equation</p>
<div class="math notranslate nohighlight">
\[
m_{t+1} = \alpha + \rho_1 m_t + \rho_2 m_{t-1}
\]</div>
<p>where the zeros of the characteristic polynomial
<span class="math notranslate nohighlight">\((1 - \rho_1 z - \rho_2 z^2)\)</span> are strictly greater than <span class="math notranslate nohighlight">\(1\)</span>
in modulus.</p>
<p>(Please see  <a class="reference internal" href="samuelson.html"><span class="doc">this</span></a> QuantEcon lecture for more about characteristic polynomials and their role in solving linear difference equations.)</p>
<p>We seek a stable or non-explosive solution of the difference equation <a class="reference internal" href="#equation-equation-1">(70.8)</a> that
obeys the system comprised of <a class="reference internal" href="#equation-equation-1">(70.8)</a>-<a class="reference internal" href="#equation-equation-3">(70.11)</a>.</p>
<p>By stable or non-explosive, we mean that neither <span class="math notranslate nohighlight">\(m_t\)</span> nor <span class="math notranslate nohighlight">\(p_t\)</span>
diverges as <span class="math notranslate nohighlight">\(t \rightarrow + \infty\)</span>.</p>
<p>This requires  that we  shut down the term <span class="math notranslate nohighlight">\(c \lambda^{-t}\)</span> in equation <a class="reference internal" href="#equation-equation-1a">(70.10)</a> above by setting <span class="math notranslate nohighlight">\(c=0\)</span></p>
<p>The solution we are after is</p>
<div class="math notranslate nohighlight" id="equation-equation-4">
<span class="eqno">(70.12)<a class="headerlink" href="#equation-equation-4" title="Permalink to this equation">#</a></span>\[p_t = F x_t\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-equation-5">
<span class="eqno">(70.13)<a class="headerlink" href="#equation-equation-5" title="Permalink to this equation">#</a></span>\[F = (1-\lambda) G (I - \lambda A)^{-1}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As mentioned above, an <em>explosive solution</em> of difference
equation <a class="reference internal" href="#equation-equation-1">(70.8)</a> can be constructed by adding to the right hand of <a class="reference internal" href="#equation-equation-4">(70.12)</a> a
sequence <span class="math notranslate nohighlight">\(c \lambda^{-t}\)</span> where <span class="math notranslate nohighlight">\(c\)</span> is an arbitrary positive
constant.</p>
</div>
</section>
<section id="some-python-code">
<h2><a class="toc-backref" href="#id12"><span class="section-number">70.4. </span>Some Python Code</a><a class="headerlink" href="#some-python-code" title="Permalink to this heading">#</a></h2>
<p>We’ll construct examples that illustrate <a class="reference internal" href="#equation-equation-3">(70.11)</a>.</p>
<p>Our first example takes as the law of motion for the log money supply
the second order difference equation</p>
<div class="math notranslate nohighlight" id="equation-equation-6">
<span class="eqno">(70.14)<a class="headerlink" href="#equation-equation-6" title="Permalink to this equation">#</a></span>\[m_{t+1} = \alpha + \rho_1 m_t + \rho_2 m_{t-1}\]</div>
<p>that is parameterized by <span class="math notranslate nohighlight">\(\rho_1, \rho_2, \alpha\)</span></p>
<p>To capture this parameterization with system <a class="reference internal" href="#equation-equation-2">(70.9)</a> we set</p>
<div class="math notranslate nohighlight">
\[
x_t = \begin{bmatrix} 1 \cr m_t \cr m_{t-1} \end{bmatrix} , \quad
  A= \begin{bmatrix} 1 &amp; 0 &amp; 0 \cr
                     \alpha &amp; \rho_1 &amp; \rho_2 \cr
                      0 &amp; 1 &amp; 0 \end{bmatrix} , \quad
  G = \begin{bmatrix} 0 &amp; 1 &amp; 0 \end{bmatrix}
\]</div>
<p>Here is Python code</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span> <span class="o">=</span> <span class="mf">.9</span>

<span class="n">α</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ρ1</span> <span class="o">=</span> <span class="mf">.9</span>
<span class="n">ρ2</span> <span class="o">=</span> <span class="mf">.05</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="n">α</span><span class="p">,</span> <span class="n">ρ1</span><span class="p">,</span> <span class="n">ρ2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">]])</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>The matrix <span class="math notranslate nohighlight">\(A\)</span> has one eigenvalue equal to unity.</p>
<p>It is associated with the <span class="math notranslate nohighlight">\(A_{11}\)</span> component that captures a
constant component of the state <span class="math notranslate nohighlight">\(x_t\)</span>.</p>
<p>We can verify that the two eigenvalues of <span class="math notranslate nohighlight">\(A\)</span> not associated with
the constant in the state <span class="math notranslate nohighlight">\(x_t\)</span> are strictly less than unity in
modulus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.05249378  0.95249378  1.        ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Now let’s compute <span class="math notranslate nohighlight">\(F\)</span> in formulas <a class="reference internal" href="#equation-equation-4">(70.12)</a> and <a class="reference internal" href="#equation-equation-5">(70.13)</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute the solution, i.e. forumula (3)</span>
<span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">λ</span><span class="p">)</span> <span class="o">*</span> <span class="n">G</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">λ</span> <span class="o">*</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;F= &quot;</span><span class="p">,</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F=  [[0.         0.66889632 0.03010033]]
</pre></div>
</div>
</div>
</div>
<p>Now let’s simulate paths of <span class="math notranslate nohighlight">\(m_t\)</span> and <span class="math notranslate nohighlight">\(p_t\)</span> starting from an
initial value <span class="math notranslate nohighlight">\(x_0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the initial state</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># length of simulation</span>

<span class="n">m_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">m_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">G</span> <span class="o">@</span> <span class="n">x0</span>
<span class="n">p_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span> <span class="o">@</span> <span class="n">x0</span>

<span class="c1"># simulate for T periods</span>
<span class="n">x_old</span> <span class="o">=</span> <span class="n">x0</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">x_old</span>

    <span class="n">m_seq</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">G</span> <span class="o">@</span> <span class="n">x</span>
    <span class="n">p_seq</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">F</span> <span class="o">@</span> <span class="n">x</span>

    <span class="n">x_old</span> <span class="o">=</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">m_seq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$m_t$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">p_seq</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$p_t$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;λ=</span><span class="si">{</span><span class="n">λ</span><span class="si">}</span><span class="s1">, α=</span><span class="si">{</span><span class="n">α</span><span class="si">}</span><span class="s1">, $ρ_1$=</span><span class="si">{</span><span class="n">ρ1</span><span class="si">}</span><span class="s1">, $ρ_2$=</span><span class="si">{</span><span class="n">ρ2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/581c8313ce2c16e1d52dc54ebeaed06e11900851a1ffd1c58a9eb81f3660e4a9.png" src="_images/581c8313ce2c16e1d52dc54ebeaed06e11900851a1ffd1c58a9eb81f3660e4a9.png" />
</div>
</div>
<p>In the above graph, why is the log of the price level always less than
the log of the money supply?</p>
<p>Because</p>
<ul class="simple">
<li><p>according to equation <a class="reference internal" href="#equation-equation-2">(70.9)</a>, <span class="math notranslate nohighlight">\(p_t\)</span> is a geometric weighted
average of current and future values of <span class="math notranslate nohighlight">\(m_t\)</span>, and</p></li>
<li><p>it happens that in this example future <span class="math notranslate nohighlight">\(m\)</span>’s are always less
than the current <span class="math notranslate nohighlight">\(m\)</span></p></li>
</ul>
</section>
<section id="alternative-code">
<h2><a class="toc-backref" href="#id13"><span class="section-number">70.5. </span>Alternative Code</a><a class="headerlink" href="#alternative-code" title="Permalink to this heading">#</a></h2>
<p>We could also have run the simulation using the quantecon
<strong>LinearStateSpace</strong> code.</p>
<p>The following code block performs the calculation with that code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct a LinearStateSpace instance</span>

<span class="c1"># stack G and F</span>
<span class="n">G_ext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">G</span><span class="p">,</span> <span class="n">F</span><span class="p">])</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">ss</span> <span class="o">=</span> <span class="n">qe</span><span class="o">.</span><span class="n">LinearStateSpace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">G_ext</span><span class="p">,</span> <span class="n">mu_0</span><span class="o">=</span><span class="n">x0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># simulate using LinearStateSpace</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">ts_length</span><span class="o">=</span><span class="n">T</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$m_t$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$p_t$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;λ=</span><span class="si">{</span><span class="n">λ</span><span class="si">}</span><span class="s1">, α=</span><span class="si">{</span><span class="n">α</span><span class="si">}</span><span class="s1">, $ρ_1$=</span><span class="si">{</span><span class="n">ρ1</span><span class="si">}</span><span class="s1">, $ρ_2$=</span><span class="si">{</span><span class="n">ρ2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e53b541dc2c92063ef0d4c3003f605e9c920f833010585ef70ee7143b6a7497d.png" src="_images/e53b541dc2c92063ef0d4c3003f605e9c920f833010585ef70ee7143b6a7497d.png" />
</div>
</div>
<section id="special-case">
<h3><span class="section-number">70.5.1. </span>Special Case<a class="headerlink" href="#special-case" title="Permalink to this heading">#</a></h3>
<p>To simplify our presentation in ways that will let focus on an important
idea, in the above second-order difference equation <a class="reference internal" href="#equation-equation-6">(70.14)</a> that governs
<span class="math notranslate nohighlight">\(m_t\)</span>, we now set <span class="math notranslate nohighlight">\(\alpha =0\)</span>,
<span class="math notranslate nohighlight">\(\rho_1 = \rho \in (-1,1)\)</span>, and <span class="math notranslate nohighlight">\(\rho_2 =0\)</span> so that the law
of motion for <span class="math notranslate nohighlight">\(m_t\)</span> becomes</p>
<div class="math notranslate nohighlight" id="equation-equation-7">
<span class="eqno">(70.15)<a class="headerlink" href="#equation-equation-7" title="Permalink to this equation">#</a></span>\[m_{t+1} =\rho m_t\]</div>
<p>and the state <span class="math notranslate nohighlight">\(x_t\)</span> becomes</p>
<div class="math notranslate nohighlight">
\[
x_t = m_t .
\]</div>
<p>Consequently,  we can set <span class="math notranslate nohighlight">\(G =1, A =\rho\)</span> making our formula <a class="reference internal" href="#equation-equation-5">(70.13)</a> for <span class="math notranslate nohighlight">\(F\)</span>
become</p>
<div class="math notranslate nohighlight">
\[
F = (1-\lambda) (1 -\lambda \rho)^{-1} .
\]</div>
<p>so that the log the log price level satisfies</p>
<div class="math notranslate nohighlight">
\[
p_t = F m_t .
\]</div>
<p>Please keep these formulas in mind as we investigate an alternative
route to and interpretation of our formula for <span class="math notranslate nohighlight">\(F\)</span>.</p>
</section>
</section>
<section id="another-perspective">
<h2><a class="toc-backref" href="#id14"><span class="section-number">70.6. </span>Another Perspective</a><a class="headerlink" href="#another-perspective" title="Permalink to this heading">#</a></h2>
<p>Above, we imposed stability or non-explosiveness on the solution of the key difference equation <a class="reference internal" href="#equation-equation-1">(70.8)</a>
in Cagan’s model by solving the  unstable root of the characteristic polynomial forward.</p>
<p>To shed light on the mechanics involved in imposing stability on a
solution of a potentially unstable system of linear difference equations
and to prepare the way for generalizations of our model in which the
money supply is allowed to feed back on the price level itself, we stack
equations <a class="reference internal" href="#equation-equation-1">(70.8)</a> and <a class="reference internal" href="#equation-equation-7">(70.15)</a> to form the system</p>
<div class="math notranslate nohighlight" id="equation-equation-8">
<span class="eqno">(70.16)<a class="headerlink" href="#equation-equation-8" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{bmatrix} m_{t+1} \cr p_{t+1} \end{bmatrix} = \begin{bmatrix} \rho &amp; 0 \\ - (1-\lambda)/\lambda &amp; \lambda^{-1}  \end{bmatrix} \begin{bmatrix} m_t \\ p_t \end{bmatrix}\end{split}\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-equation-9">
<span class="eqno">(70.17)<a class="headerlink" href="#equation-equation-9" title="Permalink to this equation">#</a></span>\[y_{t+1} = H y_t, \quad t \geq 0\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-equation-10">
<span class="eqno">(70.18)<a class="headerlink" href="#equation-equation-10" title="Permalink to this equation">#</a></span>\[\begin{split}H = \begin{bmatrix} \rho &amp; 0 \\ - (1-\lambda)/\lambda &amp; \lambda^{-1}  \end{bmatrix} .\end{split}\]</div>
<p>Transition matrix <span class="math notranslate nohighlight">\(H\)</span> has eigenvalues <span class="math notranslate nohighlight">\(\rho \in (0,1)\)</span> and
<span class="math notranslate nohighlight">\(\lambda^{-1} &gt; 1\)</span>.</p>
<p>Because an eigenvalue of <span class="math notranslate nohighlight">\(H\)</span> exceeds unity, if we iterate on
equation <a class="reference internal" href="#equation-equation-9">(70.17)</a> starting from an arbitrary initial vector
<span class="math notranslate nohighlight">\(y_0 = \begin{bmatrix} m_0 \\ p_0 \end{bmatrix}\)</span> with <span class="math notranslate nohighlight">\(m_0 &gt;0, p_0 &gt;0\)</span>, we discover that
in general absolute values of both components of <span class="math notranslate nohighlight">\(y_t\)</span> diverge
toward <span class="math notranslate nohighlight">\(+\infty\)</span> as <span class="math notranslate nohighlight">\(t \rightarrow + \infty\)</span>.</p>
<p>To substantiate this claim, we can use the eigenvector matrix
decomposition of <span class="math notranslate nohighlight">\(H\)</span> that is available to us because the
eigenvalues of <span class="math notranslate nohighlight">\(H\)</span> are distinct</p>
<div class="math notranslate nohighlight">
\[
H = Q \Lambda Q^{-1} .
\]</div>
<p>Here <span class="math notranslate nohighlight">\(\Lambda\)</span> is a diagonal matrix of eigenvalues of <span class="math notranslate nohighlight">\(H\)</span>
and <span class="math notranslate nohighlight">\(Q\)</span> is a matrix whose columns are eigenvectors associated with the
corresponding eigenvalues.</p>
<p>Note that</p>
<div class="math notranslate nohighlight">
\[
H^t = Q \Lambda^t Q^{-1}
\]</div>
<p>so that</p>
<div class="math notranslate nohighlight">
\[
y_t = Q \Lambda^t Q^{-1} y_0
\]</div>
<p>For almost all initial vectors <span class="math notranslate nohighlight">\(y_0\)</span>, the presence of the
eigenvalue <span class="math notranslate nohighlight">\(\lambda^{-1} &gt; 1\)</span> causes both components of
<span class="math notranslate nohighlight">\(y_t\)</span> to diverge in absolute value to <span class="math notranslate nohighlight">\(+\infty\)</span>.</p>
<p>To explore this outcome in more detail, we can use the following
transformation</p>
<div class="math notranslate nohighlight">
\[
y^*_t = Q^{-1} y_t
\]</div>
<p>that allows us to represent the dynamics in a way that isolates the
source of the propensity of paths to diverge:</p>
<div class="math notranslate nohighlight">
\[
y^*_{t+1} = \Lambda^t y^*_t
\]</div>
<p>Staring at this equation indicates that unless</p>
<div class="math notranslate nohighlight" id="equation-equation-11">
<span class="eqno">(70.19)<a class="headerlink" href="#equation-equation-11" title="Permalink to this equation">#</a></span>\[y^*_0 = \begin{bmatrix} y^*_{1,0} \cr 0 \end{bmatrix}\]</div>
<p>the path of <span class="math notranslate nohighlight">\(y^*_t\)</span> and therefore the paths of both components of
<span class="math notranslate nohighlight">\(y_t = Q y^*_t\)</span> will diverge in absolute value as
<span class="math notranslate nohighlight">\(t \rightarrow +\infty\)</span>. (We say that the paths <em>explode</em>)</p>
<p>Equation <a class="reference internal" href="#equation-equation-11">(70.19)</a> also leads us to conclude that there is a unique setting
for the initial vector <span class="math notranslate nohighlight">\(y_0\)</span> for which both components of
<span class="math notranslate nohighlight">\(y_t\)</span> do not diverge.</p>
<p>The required setting of <span class="math notranslate nohighlight">\(y_0\)</span> must evidently have the property
that</p>
<div class="math notranslate nohighlight">
\[
Q y_0 =  y^*_0 = \begin{bmatrix} y^*_{1,0} \cr 0 \end{bmatrix} .
\]</div>
<p>But note that since
<span class="math notranslate nohighlight">\(y_0 = \begin{bmatrix} m_0 \cr p_0 \end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(m_0\)</span>
is given to us an initial condition,  <span class="math notranslate nohighlight">\(p_0\)</span> has to do all the adjusting to satisfy this equation.</p>
<p>Sometimes this situation is described by saying that while <span class="math notranslate nohighlight">\(m_0\)</span>
is truly a <strong>state</strong> variable, <span class="math notranslate nohighlight">\(p_0\)</span> is a <strong>jump</strong> variable that
must adjust at <span class="math notranslate nohighlight">\(t=0\)</span> in order to satisfy the equation.</p>
<p>Thus, in a nutshell the unique value of the vector <span class="math notranslate nohighlight">\(y_0\)</span> for which
the paths of <span class="math notranslate nohighlight">\(y_t\)</span> do not diverge must have second component
<span class="math notranslate nohighlight">\(p_0\)</span> that verifies equality <a class="reference internal" href="#equation-equation-11">(70.19)</a> by setting the second component
of <span class="math notranslate nohighlight">\(y^*_0\)</span> equal to zero.</p>
<p>The component <span class="math notranslate nohighlight">\(p_0\)</span> of the initial vector
<span class="math notranslate nohighlight">\(y_0 = \begin{bmatrix} m_0 \cr p_0 \end{bmatrix}\)</span> must evidently
satisfy</p>
<div class="math notranslate nohighlight">
\[
Q^{\{2\}} y_0 =0
\]</div>
<p>where <span class="math notranslate nohighlight">\(Q^{\{2\}}\)</span> denotes the second row of <span class="math notranslate nohighlight">\(Q^{-1}\)</span>, a
restriction that is equivalent to</p>
<div class="math notranslate nohighlight" id="equation-equation-12">
<span class="eqno">(70.20)<a class="headerlink" href="#equation-equation-12" title="Permalink to this equation">#</a></span>\[Q^{21} m_0 + Q^{22} p_0 = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(Q^{ij}\)</span> denotes the <span class="math notranslate nohighlight">\((i,j)\)</span> component of
<span class="math notranslate nohighlight">\(Q^{-1}\)</span>.</p>
<p>Solving this equation for <span class="math notranslate nohighlight">\(p_0\)</span>, we find</p>
<div class="math notranslate nohighlight" id="equation-equation-13">
<span class="eqno">(70.21)<a class="headerlink" href="#equation-equation-13" title="Permalink to this equation">#</a></span>\[p_0 = - (Q^{22})^{-1} Q^{21} m_0.\]</div>
<p>This is the unique <strong>stabilizing value</strong> of <span class="math notranslate nohighlight">\(p_0\)</span> expressed as a function of
<span class="math notranslate nohighlight">\(m_0\)</span>.</p>
<section id="refining-the-formula">
<h3><span class="section-number">70.6.1. </span>Refining the Formula<a class="headerlink" href="#refining-the-formula" title="Permalink to this heading">#</a></h3>
<p>We can get an even more convenient formula for <span class="math notranslate nohighlight">\(p_0\)</span> that is cast
in terms of components of <span class="math notranslate nohighlight">\(Q\)</span> instead of components of
<span class="math notranslate nohighlight">\(Q^{-1}\)</span>.</p>
<p>To get this formula, first note that because <span class="math notranslate nohighlight">\((Q^{21}\ Q^{22})\)</span> is
the second row of the inverse of <span class="math notranslate nohighlight">\(Q\)</span> and because
<span class="math notranslate nohighlight">\(Q^{-1} Q = I\)</span>, it follows that</p>
<div class="math notranslate nohighlight">
\[
\begin{bmatrix} Q^{21} &amp; Q^{22} \end{bmatrix}  \begin{bmatrix} Q_{11}\cr Q_{21} \end{bmatrix} = 0
\]</div>
<p>which implies that</p>
<div class="math notranslate nohighlight">
\[
Q^{21} Q_{11} + Q^{22} Q_{21} = 0.
\]</div>
<p>Therefore,</p>
<div class="math notranslate nohighlight">
\[
-(Q^{22})^{-1} Q^{21} = Q_{21} Q^{-1}_{11}.
\]</div>
<p>So we can write</p>
<div class="math notranslate nohighlight" id="equation-equation-14">
<span class="eqno">(70.22)<a class="headerlink" href="#equation-equation-14" title="Permalink to this equation">#</a></span>\[p_0 = Q_{21} Q_{11}^{-1} m_0 .\]</div>
<p>It can be verified that this formula replicates itself over time in the sense  that</p>
<div class="math notranslate nohighlight" id="equation-equation-15">
<span class="eqno">(70.23)<a class="headerlink" href="#equation-equation-15" title="Permalink to this equation">#</a></span>\[p_t = Q_{21} Q^{-1}_{11} m_t.\]</div>
<p>To implement formula <a class="reference internal" href="#equation-equation-15">(70.23)</a>, we want to compute <span class="math notranslate nohighlight">\(Q_1\)</span> the
eigenvector of <span class="math notranslate nohighlight">\(Q\)</span> associated with the stable eigenvalue
<span class="math notranslate nohighlight">\(\rho\)</span> of <span class="math notranslate nohighlight">\(Q\)</span>.</p>
<p>By hand it can be verified that the eigenvector associated with the
stable eigenvalue <span class="math notranslate nohighlight">\(\rho\)</span> is proportional to</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Q_1  = \begin{bmatrix} 1-\lambda  \rho \\ 1 - \lambda   \end{bmatrix}.
\end{split}\]</div>
<p>Notice that if we set <span class="math notranslate nohighlight">\(A=\rho\)</span> and <span class="math notranslate nohighlight">\(G=1\)</span> in our earlier
formula for <span class="math notranslate nohighlight">\(p_t\)</span> we get</p>
<div class="math notranslate nohighlight">
\[
p_t = G (I - \lambda A)^{-1} m_t =  (1-\lambda) (1 - \lambda \rho)^{-1} m_t ,
\]</div>
<p>a formula that is equivalent with</p>
<div class="math notranslate nohighlight">
\[
p_t = Q_{21} Q_{11}^{-1}  m_t ,
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Q_1 = \begin{bmatrix} Q_{11} \\ Q_{21}  \end{bmatrix}.
\end{split}\]</div>
</section>
<section id="remarks-about-feedback">
<h3><span class="section-number">70.6.2. </span>Remarks about Feedback<a class="headerlink" href="#remarks-about-feedback" title="Permalink to this heading">#</a></h3>
<p>We have expressed <a class="reference internal" href="#equation-equation-8">(70.16)</a> in what superficially appears to be a form in
which <span class="math notranslate nohighlight">\(y_{t+1}\)</span> feeds back on <span class="math notranslate nohighlight">\(y_t\)</span>, even though what we
actually want to represent is that the component <span class="math notranslate nohighlight">\(p_t\)</span> feeds
<strong>forward</strong> on <span class="math notranslate nohighlight">\(p_{t+1}\)</span>, and through it, on future
<span class="math notranslate nohighlight">\(m_{t+j}\)</span>, <span class="math notranslate nohighlight">\(j = 0, 1, 2, \ldots\)</span>.</p>
<p>A tell-tale sign that we should look beyond its superficial “feedback”
form is that <span class="math notranslate nohighlight">\(\lambda^{-1} &gt; 1\)</span> so that the matrix <span class="math notranslate nohighlight">\(H\)</span> in
<a class="reference internal" href="#equation-equation-8">(70.16)</a> is <strong>unstable</strong></p>
<ul class="simple">
<li><p>it has one eigenvalue <span class="math notranslate nohighlight">\(\rho\)</span> that is less than one in modulus
that does not imperil stability, but <span class="math notranslate nohighlight">\(\ldots\)</span></p></li>
<li><p>it has a second eigenvalue <span class="math notranslate nohighlight">\(\lambda^{-1}\)</span> that exceeds one in
modulus and that makes <span class="math notranslate nohighlight">\(H\)</span> an unstable matrix</p></li>
</ul>
<p>We’ll keep these observations in mind as we turn now to a case in which
the log money supply actually does feed back on the log of the price
level.</p>
</section>
</section>
<section id="log-money-supply-feeds-back-on-log-price-level">
<h2><a class="toc-backref" href="#id15"><span class="section-number">70.7. </span>Log money Supply Feeds Back on Log Price Level</a><a class="headerlink" href="#log-money-supply-feeds-back-on-log-price-level" title="Permalink to this heading">#</a></h2>
<p>An arrangement of eigenvalues that split around unity, with one being
below unity and another being greater than unity, sometimes prevails when there is  <em>feedback</em> from the log price level to the log
money supply.</p>
<p>Let the feedback rule be</p>
<div class="math notranslate nohighlight" id="equation-equation-16">
<span class="eqno">(70.24)<a class="headerlink" href="#equation-equation-16" title="Permalink to this equation">#</a></span>\[m_{t+1} =  \rho m_t + \delta p_t\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho \in (0,1)\)</span>  and where we shall now allow
<span class="math notranslate nohighlight">\(\delta \neq 0\)</span>.</p>
<p><strong>Warning:</strong>  If things are to fit together as we
wish to deliver a stable system for some initial value <span class="math notranslate nohighlight">\(p_0\)</span> that we want to determine uniquely, <span class="math notranslate nohighlight">\(\delta\)</span> cannot be too large.</p>
<p>The forward-looking equation <a class="reference internal" href="#equation-equation-1">(70.8)</a> continues to describe equality between
the demand and supply of money.</p>
<p>We assume that equations <a class="reference internal" href="#equation-equation-1">(70.8)</a> and <a class="reference internal" href="#equation-equation-16">(70.24)</a> govern
<span class="math notranslate nohighlight">\(y_t \equiv \begin{bmatrix} m_t \cr p_t \end{bmatrix}\)</span> for
<span class="math notranslate nohighlight">\(t \geq 0\)</span>.</p>
<p>The transition matrix <span class="math notranslate nohighlight">\(H\)</span> in the law of motion</p>
<div class="math notranslate nohighlight">
\[
y_{t+1} = H y_t
\]</div>
<p>now becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}
H = \begin{bmatrix} \rho &amp; \delta \\ - (1-\lambda)/\lambda &amp; \lambda^{-1}  \end{bmatrix} .
\end{split}\]</div>
<p>We take <span class="math notranslate nohighlight">\(m_0\)</span> as a given initial condition and as before seek an
initial value <span class="math notranslate nohighlight">\(p_0\)</span> that stabilizes the system in the sense that
<span class="math notranslate nohighlight">\(y_t\)</span> converges as <span class="math notranslate nohighlight">\(t \rightarrow + \infty\)</span>.</p>
<p>Our approach is identical with the one  followed above and is based on an
eigenvalue decomposition in which, cross our fingers, one eigenvalue
exceeds unity and the other is less than unity in absolute value.</p>
<p>When <span class="math notranslate nohighlight">\(\delta \neq 0\)</span> as we now assume, the eigenvalues of
<span class="math notranslate nohighlight">\(H\)</span> will no longer be <span class="math notranslate nohighlight">\(\rho \in (0,1)\)</span> and
<span class="math notranslate nohighlight">\(\lambda^{-1} &gt; 1\)</span></p>
<p>We’ll just calculate them and apply the same algorithm that we used
above.</p>
<p>That algorithm remains valid so long as the eigenvalues split around
unity as before.</p>
<p>Again we assume that <span class="math notranslate nohighlight">\(m_0\)</span> is  an initial condition, but that
<span class="math notranslate nohighlight">\(p_0\)</span> is not given but to be solved for.</p>
<p>Let’s write and execute some Python code that will let us explore how outcomes depend on
<span class="math notranslate nohighlight">\(\delta\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">construct_H</span><span class="p">(</span><span class="n">ρ</span><span class="p">,</span> <span class="n">λ</span><span class="p">,</span> <span class="n">δ</span><span class="p">):</span>
    <span class="s2">&quot;contruct matrix H given parameters.&quot;</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ρ</span><span class="p">,</span><span class="n">δ</span>
    <span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">λ</span><span class="p">)</span> <span class="o">/</span> <span class="n">λ</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">λ</span>

    <span class="k">return</span> <span class="n">H</span>

<span class="k">def</span> <span class="nf">H_eigvals</span><span class="p">(</span><span class="n">ρ</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span> <span class="n">λ</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">δ</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="s2">&quot;compute the eigenvalues of matrix H given parameters.&quot;</span>

    <span class="c1"># construct H matrix</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">construct_H</span><span class="p">(</span><span class="n">ρ</span><span class="p">,</span> <span class="n">λ</span><span class="p">,</span> <span class="n">δ</span><span class="p">)</span>

    <span class="c1"># compute eigenvalues</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">eigvals</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H_eigvals</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2. , 0.9])
</pre></div>
</div>
</div>
</div>
<p>Notice that a negative <span class="math notranslate nohighlight">\(\delta\)</span> will not imperil the stability of the matrix
<span class="math notranslate nohighlight">\(H\)</span>, even if it has a big absolute value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># small negative δ</span>
<span class="n">H_eigvals</span><span class="p">(</span><span class="n">δ</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.8562829, 2.0437171])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># large negative δ</span>
<span class="n">H_eigvals</span><span class="p">(</span><span class="n">δ</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.10742784, 2.79257216])
</pre></div>
</div>
</div>
</div>
<p>A sufficiently small positive <span class="math notranslate nohighlight">\(\delta\)</span> also causes no problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sufficiently small positive δ</span>
<span class="n">H_eigvals</span><span class="p">(</span><span class="n">δ</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.94750622, 1.95249378])
</pre></div>
</div>
</div>
</div>
<p>But a large enough positive <span class="math notranslate nohighlight">\(\delta\)</span> makes both eigenvalues of <span class="math notranslate nohighlight">\(H\)</span>
strictly greater than unity in modulus.</p>
<p>For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H_eigvals</span><span class="p">(</span><span class="n">δ</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.12984379, 1.77015621])
</pre></div>
</div>
</div>
</div>
<p>We want to study systems in which one eigenvalue exceeds unity in
modulus while the other is less than unity in modulus, so we avoid
values of <span class="math notranslate nohighlight">\(\delta\)</span> that are too.</p>
<p>That is, we want to avoid too much positive feedback from <span class="math notranslate nohighlight">\(p_t\)</span> to <span class="math notranslate nohighlight">\(m_{t+1}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">magic_p0</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">ρ</span><span class="o">=</span><span class="mf">.9</span><span class="p">,</span> <span class="n">λ</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">δ</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use the magic formula (8) to compute the level of p0</span>
<span class="sd">    that makes the system stable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">construct_H</span><span class="p">(</span><span class="n">ρ</span><span class="p">,</span> <span class="n">λ</span><span class="p">,</span> <span class="n">δ</span><span class="p">)</span>
    <span class="n">eigvals</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>

    <span class="c1"># find the index of the smaller eigenvalue</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">eigvals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">eigvals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>

    <span class="c1"># verify that the eigenvalue is less than unity</span>
    <span class="k">if</span> <span class="n">eigvals</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;both eigenvalues exceed unity in modulus&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">p0</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ind</span><span class="p">]</span> <span class="o">/</span> <span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">m0</span>

    <span class="k">return</span> <span class="n">p0</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s plot how the solution <span class="math notranslate nohighlight">\(p_0\)</span> changes as <span class="math notranslate nohighlight">\(m_0\)</span>
changes for different settings of <span class="math notranslate nohighlight">\(\delta\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">δ</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">m_range</span><span class="p">,</span> <span class="p">[</span><span class="n">magic_p0</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">δ</span><span class="o">=</span><span class="n">δ</span><span class="p">)</span> <span class="k">for</span> <span class="n">m0</span> <span class="ow">in</span> <span class="n">m_range</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;δ=</span><span class="si">{</span><span class="n">δ</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$m_0$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$p_0$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/131294ba8f0290fe58bcbed20bdfe9ddbb07065f7525d13c528e596701984dd1.png" src="_images/131294ba8f0290fe58bcbed20bdfe9ddbb07065f7525d13c528e596701984dd1.png" />
</div>
</div>
<p>To look at things from a different angle, we can fix the initial value <span class="math notranslate nohighlight">\(m_0\)</span> and
see how <span class="math notranslate nohighlight">\(p_0\)</span> changes as <span class="math notranslate nohighlight">\(\delta\)</span> changes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m0</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">δ_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">δ_range</span><span class="p">,</span> <span class="p">[</span><span class="n">magic_p0</span><span class="p">(</span><span class="n">m0</span><span class="p">,</span> <span class="n">δ</span><span class="o">=</span><span class="n">δ</span><span class="p">)</span> <span class="k">for</span> <span class="n">δ</span> <span class="ow">in</span> <span class="n">δ_range</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$\delta$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$p_0$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$m_0$=</span><span class="si">{</span><span class="n">m0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fbd9e5b567cb4f17dd081d8d0be3bf8aa0efc5e857dc911fc89f443313a2bcac.png" src="_images/fbd9e5b567cb4f17dd081d8d0be3bf8aa0efc5e857dc911fc89f443313a2bcac.png" />
</div>
</div>
<p>Notice that when <span class="math notranslate nohighlight">\(\delta\)</span> is large enough, both eigenvalues exceed
unity in modulus, causing a stabilizing value of <span class="math notranslate nohighlight">\(p_0\)</span> not to
exist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">magic_p0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">δ</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>both eigenvalues exceed unity in modulus
</pre></div>
</div>
</div>
</div>
</section>
<section id="big-p-little-p-interpretation">
<h2><a class="toc-backref" href="#id16"><span class="section-number">70.8. </span>Big <span class="math notranslate nohighlight">\(P\)</span>, Little <span class="math notranslate nohighlight">\(p\)</span> Interpretation</a><a class="headerlink" href="#big-p-little-p-interpretation" title="Permalink to this heading">#</a></h2>
<p>It is helpful to view our solutions of difference equations having  feedback from the price level or inflation to money or the rate of money
creation in terms of the Big <span class="math notranslate nohighlight">\(K\)</span>, little <span class="math notranslate nohighlight">\(k\)</span> idea discussed in <a class="reference internal" href="rational_expectations.html"><span class="doc">Rational Expectations Models</span></a>.</p>
<p>This will help us sort out what is taken as given by the decision makers who use the
difference equation <a class="reference internal" href="#equation-equation-2">(70.9)</a> to determine <span class="math notranslate nohighlight">\(p_t\)</span> as a function of their forecasts of future values of
<span class="math notranslate nohighlight">\(m_t\)</span>.</p>
<p>Let’s write the stabilizing solution that we have computed using the eigenvector decomposition of <span class="math notranslate nohighlight">\(H\)</span> as
<span class="math notranslate nohighlight">\(P_t = F^* m_t\)</span>, where</p>
<div class="math notranslate nohighlight">
\[
F^* = Q_{21} Q_{11}^{-1} .
\]</div>
<p>Then from <span class="math notranslate nohighlight">\(P_{t+1} = F^* m_{t+1}\)</span> and <span class="math notranslate nohighlight">\(m_{t+1} = \rho m_t + \delta P_t\)</span> we can deduce the recursion <span class="math notranslate nohighlight">\(P_{t+1} = F^* \rho m_t + F^* \delta P_t\)</span> and create the stacked system</p>
<div class="math notranslate nohighlight">
\[
\begin{bmatrix} m_{t+1} \cr P_{t+1} \end{bmatrix}  =    \begin{bmatrix} \rho &amp; \delta \cr
                F^* \rho &amp; F^* \delta   \end{bmatrix} \begin{bmatrix} m_t \cr P_t \end{bmatrix}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
x_{t+1} = A x_t
\]</div>
<p>where <span class="math notranslate nohighlight">\(x_t = \begin{bmatrix} m_t \cr P_t \end{bmatrix}\)</span>.</p>
<p>Apply formula <a class="reference internal" href="#equation-equation-5">(70.13)</a> for <span class="math notranslate nohighlight">\(F\)</span> to deduce that</p>
<div class="math notranslate nohighlight">
\[
p_t = F \begin{bmatrix} m_t \cr P_t \end{bmatrix} = F \begin{bmatrix} m_t \cr F^* m_t \end{bmatrix}
\]</div>
<p>which implies that</p>
<div class="math notranslate nohighlight">
\[
p_t = \begin{bmatrix} F_1 &amp; F_2 \end{bmatrix}    \begin{bmatrix} m_t \cr F^* m_t \end{bmatrix} = F_1 m_t + F_2 F^* m_t
\]</div>
<p>so that we can anticipate that</p>
<div class="math notranslate nohighlight">
\[
F^* = F_1 + F_2 F^*
\]</div>
<p>We shall verify this equality in the next block of Python code that implements the following
computations.</p>
<ol class="arabic simple">
<li><p>For the system with <span class="math notranslate nohighlight">\(\delta\neq 0\)</span> so that there is feedback,
we compute the stabilizing solution for <span class="math notranslate nohighlight">\(p_t\)</span> in the form
<span class="math notranslate nohighlight">\(p_t = F^* m_t\)</span> where <span class="math notranslate nohighlight">\(F^* = Q_{21}Q_{11}^{-1}\)</span> as above.</p></li>
<li><p>Recalling the system <a class="reference internal" href="#equation-equation-3">(70.11)</a>, <a class="reference internal" href="#equation-equation-4">(70.12)</a>, and <a class="reference internal" href="#equation-equation-5">(70.13)</a> above, we define
<span class="math notranslate nohighlight">\(x_t = \begin{bmatrix} m_t \cr P_t \end{bmatrix}\)</span> and notice
that it is Big <span class="math notranslate nohighlight">\(P_t\)</span> and not little <span class="math notranslate nohighlight">\(p_t\)</span> here. Then we form <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(G\)</span> as
<span class="math notranslate nohighlight">\(A = \begin{bmatrix}\rho &amp; \delta \cr F^* \rho &amp; F^*\delta \end{bmatrix}\)</span>
and <span class="math notranslate nohighlight">\(G = \begin{bmatrix} 1 &amp; 0 \end{bmatrix}\)</span> and we compute
<span class="math notranslate nohighlight">\(\begin{bmatrix}  F_1 &amp;  F_2 \end{bmatrix} \equiv F\)</span>
from equation <a class="reference internal" href="#equation-equation-5">(70.13)</a> above.</p></li>
<li><p>We compute <span class="math notranslate nohighlight">\(F_1 +  F_2 F^*\)</span> and compare it
with <span class="math notranslate nohighlight">\(F^*\)</span> and check for the anticipated  equality.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set parameters</span>
<span class="n">ρ</span> <span class="o">=</span> <span class="mf">.9</span>
<span class="n">λ</span> <span class="o">=</span> <span class="mf">.5</span>
<span class="n">δ</span> <span class="o">=</span> <span class="mf">.05</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># solve for F_star</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">construct_H</span><span class="p">(</span><span class="n">ρ</span><span class="p">,</span> <span class="n">λ</span><span class="p">,</span> <span class="n">δ</span><span class="p">)</span>
<span class="n">eigvals</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>

<span class="n">ind</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">eigvals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">eigvals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>
<span class="n">F_star</span> <span class="o">=</span> <span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">ind</span><span class="p">]</span> <span class="o">/</span> <span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ind</span><span class="p">]</span>
<span class="n">F_star</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 0.950124378879109\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># solve for F_check</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ρ</span><span class="p">,</span> <span class="n">δ</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">F_star</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">F_check</span><span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">λ</span><span class="p">)</span> <span class="o">*</span> <span class="n">G</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">λ</span> <span class="o">*</span> <span class="n">A</span><span class="p">)</span>
<span class="n">F_check</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.92755597, 0.02375311])
</pre></div>
</div>
</div>
</div>
<p>Compare <span class="math notranslate nohighlight">\(F^*\)</span> with <span class="math notranslate nohighlight">\(F_1 + F_2 F^*\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F_check</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">F_check</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">F_star</span><span class="p">,</span> <span class="n">F_star</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left( 0.95012437887911, \  0.950124378879109\right)\]</div>
</div>
</div>
</section>
<section id="fun-with-sympy">
<h2><a class="toc-backref" href="#id17"><span class="section-number">70.9. </span>Fun with SymPy</a><a class="headerlink" href="#fun-with-sympy" title="Permalink to this heading">#</a></h2>
<p>This section is a  gift for readers who have made it this far.</p>
<p>It puts SymPy to work on our model.</p>
<p>Thus, we  use Sympy to compute some  key objects comprising the eigenvector decomposition of <span class="math notranslate nohighlight">\(H\)</span>.</p>
<p>We start by generating an <span class="math notranslate nohighlight">\(H\)</span> with nonzero <span class="math notranslate nohighlight">\(\delta\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span><span class="p">,</span> <span class="n">δ</span><span class="p">,</span> <span class="n">ρ</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;λ, δ, ρ&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H1</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">ρ</span><span class="p">,</span><span class="n">δ</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">λ</span><span class="p">)</span> <span class="o">/</span> <span class="n">λ</span><span class="p">,</span> <span class="n">λ</span> <span class="o">**</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}ρ &amp; δ\\\frac{λ - 1}{λ} &amp; \frac{1}{λ}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H1</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left\{ \frac{λ ρ + 1}{2 λ} - \frac{\sqrt{4 δ λ^{2} - 4 δ λ + λ^{2} ρ^{2} - 2 λ ρ + 1}}{2 λ} : 1, \  \frac{λ ρ + 1}{2 λ} + \frac{\sqrt{4 δ λ^{2} - 4 δ λ + λ^{2} ρ^{2} - 2 λ ρ + 1}}{2 λ} : 1\right\}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H1</span><span class="o">.</span><span class="n">eigenvects</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[ \left( \frac{λ ρ + 1}{2 λ} - \frac{\sqrt{4 δ λ^{2} - 4 δ λ + λ^{2} ρ^{2} - 2 λ ρ + 1}}{2 λ}, \  1, \  \left[ \left[\begin{matrix}\frac{λ \left(\frac{λ ρ + 1}{2 λ} - \frac{\sqrt{4 δ λ^{2} - 4 δ λ + λ^{2} ρ^{2} - 2 λ ρ + 1}}{2 λ}\right)}{λ - 1} - \frac{1}{λ - 1}\\1\end{matrix}\right]\right]\right), \  \left( \frac{λ ρ + 1}{2 λ} + \frac{\sqrt{4 δ λ^{2} - 4 δ λ + λ^{2} ρ^{2} - 2 λ ρ + 1}}{2 λ}, \  1, \  \left[ \left[\begin{matrix}\frac{λ \left(\frac{λ ρ + 1}{2 λ} + \frac{\sqrt{4 δ λ^{2} - 4 δ λ + λ^{2} ρ^{2} - 2 λ ρ + 1}}{2 λ}\right)}{λ - 1} - \frac{1}{λ - 1}\\1\end{matrix}\right]\right]\right)\right]\end{split}\]</div>
</div>
</div>
<p>Now let’s compute <span class="math notranslate nohighlight">\(H\)</span> when  <span class="math notranslate nohighlight">\(\delta\)</span> is zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H2</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">ρ</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">λ</span><span class="p">)</span> <span class="o">/</span> <span class="n">λ</span><span class="p">,</span> <span class="n">λ</span> <span class="o">**</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}ρ &amp; 0\\\frac{λ - 1}{λ} &amp; \frac{1}{λ}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H2</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \left\{ \frac{1}{λ} : 1, \  ρ : 1\right\}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H2</span><span class="o">.</span><span class="n">eigenvects</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[ \left( \frac{1}{λ}, \  1, \  \left[ \left[\begin{matrix}0\\1\end{matrix}\right]\right]\right), \  \left( ρ, \  1, \  \left[ \left[\begin{matrix}\frac{λ ρ - 1}{λ - 1}\\1\end{matrix}\right]\right]\right)\right]\end{split}\]</div>
</div>
</div>
<p>Below we do induce SymPy to do the following fun things for us analytically:</p>
<ol class="arabic simple">
<li><p>We compute the matrix <span class="math notranslate nohighlight">\(Q\)</span> whose first column is
the eigenvector associated with <span class="math notranslate nohighlight">\(\rho\)</span>. and whose second column
is the eigenvector associated with <span class="math notranslate nohighlight">\(\lambda^{-1}\)</span>.</p></li>
<li><p>We use SymPy to compute the inverse <span class="math notranslate nohighlight">\(Q^{-1}\)</span> of <span class="math notranslate nohighlight">\(Q\)</span>
(both in symbols).</p></li>
<li><p>We use SymPy to compute <span class="math notranslate nohighlight">\(Q_{21} Q_{11}^{-1}\)</span> (in symbols).</p></li>
<li><p>Where <span class="math notranslate nohighlight">\(Q^{ij}\)</span> denotes the <span class="math notranslate nohighlight">\((i,j)\)</span> component of
<span class="math notranslate nohighlight">\(Q^{-1}\)</span>, we use SymPy to compute
<span class="math notranslate nohighlight">\(- (Q^{22})^{-1} Q^{21}\)</span> (again in symbols)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct Q</span>
<span class="n">vec</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">eigval</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">eigvec</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">H2</span><span class="o">.</span><span class="n">eigenvects</span><span class="p">()):</span>

    <span class="n">vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eigvec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">eigval</span> <span class="o">==</span> <span class="n">ρ</span><span class="p">:</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">i</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">vec</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">col_insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">ind</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{λ ρ - 1}{λ - 1} &amp; 0\\1 &amp; 1\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(Q^{-1}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q_inv</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Q_inv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{λ - 1}{λ ρ - 1} &amp; 0\\\frac{1 - λ}{λ ρ - 1} &amp; 1\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(Q_{21}Q_{11}^{-1}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{λ - 1}{λ ρ - 1}\]</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(−(Q^{22})^{−1}Q^{21}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">Q_inv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">Q_inv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{1 - λ}{λ ρ - 1}\]</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="geom_series.html">
   1. Geometric Series for Elementary Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   2. Modeling COVID 19
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_algebra.html">
   3. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   4. QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complex_and_trig.html">
   5. Complex Numbers and Trigonometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   6. Circulant Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   7. Singular Value Decomposition (SVD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="var_dmd.html">
   8. VARs and DMDs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   9. Using Newton’s Method to Solve Economic Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementary Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   10. Elementary Probability with Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   11. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   12. Two Meanings of Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   13. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   14. Multivariate Normal Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="heavy_tails.html">
   15. Heavy-Tailed Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   16. Fault Tree Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   17. Introduction to Artificial Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   18. Randomized Response Surveys
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   19. Expected Utilities of Random Responses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lp_intro.html">
   20. Linear Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   21. Optimal Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   22. Von Neumann Growth Model (and a Generalization)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="scalar_dynam.html">
   23. Dynamics in One Dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   24. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   25. Inventory Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   26. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   27. Samuelson Multiplier-Accelerator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   28. Kesten Processes and Firm Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   29. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   30. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman_2.html">
   31. Another Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="short_path.html">
   32. Shortest Paths
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Search
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   33. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   34. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   35. Job Search III: Fitted Value Function Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_correlated.html">
   36. Job Search IV: Correlated Wage Offers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   37. Job Search V: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   38. Job Search VI: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   39. Job Search VII: A McCall Worker Q-Learns
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Consumption, Savings and Capital
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   40. Cass-Koopmans Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   41. Cass-Koopmans Competitive Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_problem.html">
   42. Cake Eating I: Introduction to Optimal Saving
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_numerical.html">
   43. Cake Eating II: Numerical Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   44. Optimal Growth I: The Stochastic Optimal Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth_fast.html">
   45. Optimal Growth II: Accelerating the Code with Numba
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   46. Optimal Growth III: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   47. Optimal Growth IV: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   48. The Income Fluctuation Problem I: Basic Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   49. The Income Fluctuation Problem II: Stochastic Returns on Assets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bayes Law
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   50. Non-Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   51. Posterior Distributions for  AR(1) Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   52. Forecasting  an AR(1) Process
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Information
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   53. Job Search VII: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   54. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   55. Computing Mean of a Likelihood Ratio Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   56. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   57. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   58. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   59. Incorrect Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   60. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   61. LQ Control: Foundations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   62. Lagrangian for LQ Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   63. Eliminating Cross Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   64. The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   65. Permanent Income II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   66. Production Smoothing via Inventories
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="schelling.html">
   67. Schelling’s Segregation Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   68. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   69. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   70. Stability in Linear Rational Expectations Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   71. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   72. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   73. The Aiyagari Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   74. Asset Pricing: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   75. Competitive Equilibria with Arrow Securities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   76. Heterogeneous Beliefs and Bubbles
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data and Empirics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   77. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   78. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   79. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Auctions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   80. First-Price and Second-Price Auctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   81. Multiple Good Allocation Mechanisms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   82. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   83. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   84. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                </ul>

                <ul class="qe-toolbar__links">
                    <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search..." aria-label="Search..." autocomplete="off" accesskey="k">
                            <i data-feather="search" id="search-icon"></i>
                        </form>
                    </li>
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/re_with_feedback.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/blob/main/lectures/re_with_feedback.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/master/re_with_feedback.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/re_with_feedback.ipynb" data-branch=master>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/master/re_with_feedback.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "re_with_feedback";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/re_with_feedback.ipynb";
                const branch = "master"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
  </body>
</html>