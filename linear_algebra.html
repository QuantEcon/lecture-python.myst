
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Linear Algebra &#8212; Quantitative Economics with Python</title>
    <script src="https://unpkg.com/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js@6.3.1/dist/tippy-bundle.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
        <script>
            MathJax = {
            loader: {load: ['[tex]/boldsymbol', '[tex]/textmacros']},
            tex: {
                packages: {'[+]': ['boldsymbol', 'textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true,
                macros: {
                    "argmax" : "arg\\,max",
                    "argmin" : "arg\\,min",
                    "col"    : "col",
                    "Span"   :  "span",
                    "epsilon": "\\varepsilon",
                    "EE": "\\mathbb{E}",
                    "PP": "\\mathbb{P}",
                    "RR": "\\mathbb{R}",
                    "NN": "\\mathbb{N}",
                    "ZZ": "\\mathbb{Z}",
                    "aA": "\\mathcal{A}",
                    "bB": "\\mathcal{B}",
                    "cC": "\\mathcal{C}",
                    "dD": "\\mathcal{D}",
                    "eE": "\\mathcal{E}",
                    "fF": "\\mathcal{F}",
                    "gG": "\\mathcal{G}",
                    "hH": "\\mathcal{H}",
                }
            },
            svg: {
                fontCache: 'global',
                scale: 0.92,
                displayAlign: "center",
            },
            };
        </script>
    
    
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/quantecon-book-theme.1ef59f8f4e91ec8319176e8479c6af4e.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">


    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="_static/quantecon-book-theme.15b0c36fffe88f468997fa7b698991d3.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"argmax": "arg\\,max", "argmin": "arg\\,min"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://python.quantecon.org/linear_algebra.html" />
    <link rel="shortcut icon" href="_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. QR Decomposition" href="qr_decomp.html" />
    <link rel="prev" title="2. Modeling COVID 19" href="sir_model.html" />

<!-- Normal Meta Tags -->
<meta name="author" context="Thomas J. Sargent &amp; John Stachurski" />
<meta name="keywords" content="Python, QuantEcon, Quantitative Economics, Economics, Sloan, Alfred P. Sloan Foundation, Tom J. Sargent, John Stachurski" />
<meta name="description" content=This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski. />

<!-- Twitter tags -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@quantecon" />
<meta name="twitter:title" content="Linear Algebra"/>
<meta name="twitter:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski.">
<meta name="twitter:creator" content="@quantecon">
<meta name="twitter:image" content="https://assets.quantecon.org/img/qe-twitter-logo.png">

<!-- Opengraph tags -->
<meta property="og:title" content="Linear Algebra" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://python.quantecon.org/linear_algebra.html" />
<meta property="og:image" content="https://assets.quantecon.org/img/qe-og-logo.png" />
<meta property="og:description" content="This website presents a set of lectures on quantitative economic modeling, designed and written by Thomas J. Sargent and John Stachurski." />
<meta property="og:site_name" content="Quantitative Economics with Python" />
<meta name="theme-color" content="#ffffff" />

  </head>
<body>


    <span id="top"></span>

    <div class="qe-wrapper">

        <div class="qe-main">

            <div class="qe-page" id=linear_algebra>

                <div class="qe-page__toc">

                    <div class="inner">

                        
                        <div class="qe-page__toc-header">
                            On this page
                        </div>


                        <nav id="bd-toc-nav" class="qe-page__toc-nav">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   3.1. Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectors">
   3.2. Vectors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vector-operations">
     3.2.1. Vector Operations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inner-product-and-norm">
     3.2.2. Inner Product and Norm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span">
     3.2.3. Span
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#examples">
       3.2.3.1. Examples
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-independence">
     3.2.4. Linear Independence
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unique-representations">
     3.2.5. Unique Representations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrices">
   3.3. Matrices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-operations">
     3.3.1. Matrix Operations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrices-in-numpy">
     3.3.2. Matrices in NumPy
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrices-as-maps">
     3.3.3. Matrices as Maps
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-systems-of-equations">
   3.4. Solving Systems of Equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-square-matrix-case">
     3.4.1. The Square Matrix Case
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inverse-matrices">
       3.4.1.1. Inverse Matrices
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#determinants">
       3.4.1.2. Determinants
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-rows-than-columns">
     3.4.2. More Rows than Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-columns-than-rows">
     3.4.3. More Columns than Rows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linear-equations-with-scipy">
     3.4.4. Linear Equations with SciPy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eigenvalues-and-eigenvectors">
   3.5. Eigenvalues and Eigenvectors
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generalized-eigenvalues">
     3.5.1. Generalized Eigenvalues
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#further-topics">
   3.6. Further Topics
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#series-expansions">
     3.6.1. Series Expansions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-norms">
       3.6.1.1. Matrix Norms
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#neumann-s-theorem">
       3.6.1.2. Neumann’s Theorem
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spectral-radius">
       3.6.1.3. Spectral Radius
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#positive-definite-matrices">
     3.6.2. Positive Definite Matrices
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differentiating-linear-and-quadratic-forms">
     3.6.3. Differentiating Linear and Quadratic Forms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#further-reading">
     3.6.4. Further Reading
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   3.7. Exercises
  </a>
 </li>
</ul>

                            <p class="logo">
                                
                                    
                                    <a href=https://quantecon.org><img src="_static/qe-logo-large.png" class="logo" alt="logo"></a>
                                    
                                
                            </p>

                            <p class="powered">Powered by <a href="https://jupyterbook.org/">Jupyter Book</a></p>

                        </nav>

                        <div class="qe-page__toc-footer">
                            
                            
                            <p><a href="#top"><strong>Back to top</strong></a></p>
                        </div>

                    </div>

                </div>

                <div class="qe-page__header">

                    <div class="qe-page__header-copy">

                        <p class="qe-page__header-heading"><a href="intro.html">Quantitative Economics with Python</a></p>

                        <p class="qe-page__header-subheading">Linear Algebra</p>

                    </div>

                    <p class="qe-page__header-authors">Thomas J. Sargent & John Stachurski</p>

                </div> <!-- .page__header -->



                
                <main class="qe-page__content" role="main">
                    
                    <div>
                        
  <div id="qe-notebook-header" align="right" style="text-align:right;">
        <a href="https://quantecon.org/" title="quantecon.org">
                <img style="width:250px;display:inline;" width="250px" src="https://assets.quantecon.org/img/qe-menubar-logo.svg" alt="QuantEcon">
        </a>
</div><div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1><a class="toc-backref" href="#id5"><span class="section-number">3. </span>Linear Algebra</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<span id="index-0"></span><p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id5">Linear Algebra</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id6">Overview</a></p></li>
<li><p><a class="reference internal" href="#vectors" id="id7">Vectors</a></p></li>
<li><p><a class="reference internal" href="#matrices" id="id8">Matrices</a></p></li>
<li><p><a class="reference internal" href="#solving-systems-of-equations" id="id9">Solving Systems of Equations</a></p></li>
<li><p><a class="reference internal" href="#eigenvalues-and-eigenvectors" id="id10">Eigenvalues and Eigenvectors</a></p></li>
<li><p><a class="reference internal" href="#further-topics" id="id11">Further Topics</a></p></li>
<li><p><a class="reference internal" href="#exercises" id="id12">Exercises</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id6"><span class="section-number">3.1. </span>Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Linear algebra is one of the most useful branches of applied mathematics for economists to invest in.</p>
<p>For example, many applied problems in economics and finance require the solution of a linear system of equations, such as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    y_1 = a x_1 + b x_2 \\
    y_2 = c x_1 + d x_2
\end{aligned}
\end{split}\]</div>
<p>or, more generally,</p>
<div class="math notranslate nohighlight" id="equation-la-se">
<span class="eqno">(3.1)<a class="headerlink" href="#equation-la-se" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    y_1 = a_{11} x_1 + a_{12} x_2 + \cdots + a_{1k} x_k \\
    \vdots  \\
    y_n = a_{n1} x_1 + a_{n2} x_2 + \cdots + a_{nk} x_k
\end{aligned}\end{split}\]</div>
<p>The objective here is to solve for the “unknowns” <span class="math notranslate nohighlight">\(x_1, \ldots, x_k\)</span> given <span class="math notranslate nohighlight">\(a_{11}, \ldots, a_{nk}\)</span> and <span class="math notranslate nohighlight">\(y_1, \ldots, y_n\)</span>.</p>
<p>When considering such problems, it is essential that we first consider at least some of the following questions</p>
<ul class="simple">
<li><p>Does a solution actually exist?</p></li>
<li><p>Are there in fact many solutions, and if so how should we interpret them?</p></li>
<li><p>If no solution exists, is there a best “approximate” solution?</p></li>
<li><p>If a solution exists, how should we compute it?</p></li>
</ul>
<p>These are the kinds of topics addressed by linear algebra.</p>
<p>In this lecture we will cover the basics of linear and matrix algebra, treating both theory and computation.</p>
<p>We admit some overlap with <a class="reference external" href="https://python-programming.quantecon.org/numpy.html">this lecture</a>, where operations on NumPy arrays were first explained.</p>
<p>Note that this lecture is more theoretical than most, and contains background
material that will be used in applications as we go along.</p>
<p>Let’s start with some imports:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1">#set default figure size</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp2d</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">inv</span><span class="p">,</span> <span class="n">solve</span><span class="p">,</span> <span class="n">det</span><span class="p">,</span> <span class="n">eig</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vectors">
<h2><a class="toc-backref" href="#id7"><span class="section-number">3.2. </span><span class="target" id="index-1"></span>Vectors</a><a class="headerlink" href="#vectors" title="Permalink to this headline">¶</a></h2>
<p id="index-2">A <em>vector</em> of length <span class="math notranslate nohighlight">\(n\)</span> is just a sequence (or array, or tuple) of <span class="math notranslate nohighlight">\(n\)</span> numbers, which we write as <span class="math notranslate nohighlight">\(x = (x_1, \ldots, x_n)\)</span> or  <span class="math notranslate nohighlight">\(x = [x_1, \ldots, x_n]\)</span>.</p>
<p>We will write these sequences either horizontally or vertically as we please.</p>
<p>(Later, when we wish to perform certain matrix operations, it will become necessary to distinguish between the two)</p>
<p>The set of all <span class="math notranslate nohighlight">\(n\)</span>-vectors is denoted by <span class="math notranslate nohighlight">\(\mathbb R^n\)</span>.</p>
<p>For example, <span class="math notranslate nohighlight">\(\mathbb R ^2\)</span> is the plane, and a vector in <span class="math notranslate nohighlight">\(\mathbb R^2\)</span> is just a point in the plane.</p>
<p>Traditionally, vectors are represented visually as arrows from the origin to
the point.</p>
<p>The following figure represents three vectors in this manner</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1"># Set the axes through the origin</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">vecs</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vecs</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                <span class="n">shrink</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/linear_algebra_3_0.png" src="_images/linear_algebra_3_0.png" />
</div>
</div>
<div class="section" id="vector-operations">
<h3><span class="section-number">3.2.1. </span>Vector Operations<a class="headerlink" href="#vector-operations" title="Permalink to this headline">¶</a></h3>
<p id="index-3">The two most common operators for vectors are addition and scalar multiplication, which we now describe.</p>
<p>As a matter of definition, when we add two vectors, we add them element-by-element</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x + y =
\begin{bmatrix}
    x_1 \\
    x_2 \\
    \vdots \\
    x_n
\end{bmatrix} +
\begin{bmatrix}
     y_1 \\
     y_2 \\
    \vdots \\
     y_n
\end{bmatrix} :=
\begin{bmatrix}
    x_1 + y_1 \\
    x_2 + y_2 \\
    \vdots \\
    x_n + y_n
\end{bmatrix}
\end{split}\]</div>
<p>Scalar multiplication is an operation that takes a number <span class="math notranslate nohighlight">\(\gamma\)</span> and a
vector <span class="math notranslate nohighlight">\(x\)</span> and produces</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\gamma x :=
\begin{bmatrix}
    \gamma x_1 \\
    \gamma x_2 \\
    \vdots \\
    \gamma x_n
\end{bmatrix}
\end{split}\]</div>
<p>Scalar multiplication is illustrated in the next figure</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1"># Set the axes through the origin</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">shrink</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">)</span>


<span class="n">scalars</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scalars</span><span class="p">:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">x</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                <span class="n">shrink</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;$</span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s1"> x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;16&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/linear_algebra_5_0.png" src="_images/linear_algebra_5_0.png" />
</div>
</div>
<p>In Python, a vector can be represented as a list or tuple, such as <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">(2,</span> <span class="pre">4,</span> <span class="pre">6)</span></code>, but is more commonly
represented as a <a class="reference external" href="https://python-programming.quantecon.org/numpy.html#numpy-arrays">NumPy array</a>.</p>
<p>One advantage of NumPy arrays is that scalar multiplication and addition have very natural syntax</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>            <span class="c1"># Vector of three ones</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>   <span class="c1"># Converts tuple (2, 4, 6) into array</span>
<span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3., 5., 7.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([4., 4., 4.])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="inner-product-and-norm">
<h3><span class="section-number">3.2.2. </span>Inner Product and Norm<a class="headerlink" href="#inner-product-and-norm" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-4"></span><p id="index-5">The <em>inner product</em> of vectors <span class="math notranslate nohighlight">\(x,y \in \mathbb R ^n\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[
x' y := \sum_{i=1}^n x_i y_i
\]</div>
<p>Two vectors are called <em>orthogonal</em> if their inner product is zero.</p>
<p>The <em>norm</em> of a vector <span class="math notranslate nohighlight">\(x\)</span> represents its “length” (i.e., its distance from the zero vector) and is defined as</p>
<div class="math notranslate nohighlight">
\[
\| x \| := \sqrt{x' x} := \left( \sum_{i=1}^n x_i^2 \right)^{1/2}
\]</div>
<p>The expression <span class="math notranslate nohighlight">\(\| x - y\|\)</span> is thought of as the distance between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>Continuing on from the previous example, the inner product and norm can be computed as
follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>          <span class="c1"># Inner product of x and y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># Norm of x, take one</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.7320508075688772
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>      <span class="c1"># Norm of x, take two</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.7320508075688772
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="span">
<h3><span class="section-number">3.2.3. </span>Span<a class="headerlink" href="#span" title="Permalink to this headline">¶</a></h3>
<p id="index-6">Given a set of vectors <span class="math notranslate nohighlight">\(A := \{a_1, \ldots, a_k\}\)</span> in <span class="math notranslate nohighlight">\(\mathbb R ^n\)</span>, it’s natural to think about the new vectors we can create by performing linear operations.</p>
<p>New vectors created in this manner are called <em>linear combinations</em> of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>In particular, <span class="math notranslate nohighlight">\(y \in \mathbb R ^n\)</span> is a linear combination of <span class="math notranslate nohighlight">\(A := \{a_1, \ldots, a_k\}\)</span> if</p>
<div class="math notranslate nohighlight">
\[
y = \beta_1 a_1 + \cdots + \beta_k a_k
\text{ for some scalars } \beta_1, \ldots, \beta_k
\]</div>
<p>In this context, the values <span class="math notranslate nohighlight">\(\beta_1, \ldots, \beta_k\)</span> are called the <em>coefficients</em> of the linear combination.</p>
<p>The set of linear combinations of <span class="math notranslate nohighlight">\(A\)</span> is called the <em>span</em> of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>The next figure shows the span of <span class="math notranslate nohighlight">\(A = \{a_1, a_2\}\)</span> in <span class="math notranslate nohighlight">\(\mathbb R ^3\)</span>.</p>
<p>The span is a two-dimensional plane passing through these two points and the origin.</p>
<div class="cell tag_output_scroll docutils container" id="la-3dvec">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span>
<span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span>

<span class="n">α</span><span class="p">,</span> <span class="n">β</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">),</span> <span class="n">zlim</span><span class="o">=</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">),</span>
       <span class="n">xticks</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">yticks</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">zticks</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>

<span class="n">gs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>


<span class="c1"># Fixed linear function, to generate a plane</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">α</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">β</span> <span class="o">*</span> <span class="n">y</span>

<span class="c1"># Vector locations, by coordinate</span>
<span class="n">x_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">y_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_coords</span><span class="p">,</span> <span class="n">y_coords</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;$a_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Lines to vectors</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_coords</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_coords</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_coords</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>


<span class="c1"># Draw the plane</span>
<span class="n">grid_size</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">xr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
<span class="n">yr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">)</span>
<span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xr2</span><span class="p">,</span> <span class="n">yr2</span><span class="p">)</span>
<span class="n">z2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_18000/266575435.py:2: MatplotlibDeprecationWarning: Calling gca() with keyword arguments was deprecated in Matplotlib 3.4. Starting two minor releases later, gca() will take no keyword arguments. The gca() function should only be used to get the current axes, or if no axes exist, create new axes with default keyword arguments. To create a new axes with non-default arguments, use plt.axes() or plt.subplot().
  ax = fig.gca(projection=&#39;3d&#39;)
</pre></div>
</div>
<img alt="_images/linear_algebra_14_1.png" src="_images/linear_algebra_14_1.png" />
</div>
</div>
<div class="section" id="examples">
<h4><span class="section-number">3.2.3.1. </span>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p>If <span class="math notranslate nohighlight">\(A\)</span> contains only one vector <span class="math notranslate nohighlight">\(a_1 \in \mathbb R ^2\)</span>, then its
span is just the scalar multiples of <span class="math notranslate nohighlight">\(a_1\)</span>, which is the unique line passing through both <span class="math notranslate nohighlight">\(a_1\)</span> and the origin.</p>
<p>If <span class="math notranslate nohighlight">\(A = \{e_1, e_2, e_3\}\)</span> consists  of the <em>canonical basis vectors</em> of <span class="math notranslate nohighlight">\(\mathbb R ^3\)</span>, that is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
e_1 :=
\begin{bmatrix}
     1 \\
     0 \\
     0
\end{bmatrix}
, \quad
e_2 :=
\begin{bmatrix}
     0 \\
     1 \\
     0
\end{bmatrix}
, \quad
e_3 :=
\begin{bmatrix}
     0 \\
     0 \\
     1
\end{bmatrix}
\end{split}\]</div>
<p>then the span of <span class="math notranslate nohighlight">\(A\)</span> is all of <span class="math notranslate nohighlight">\(\mathbb R ^3\)</span>, because, for any
<span class="math notranslate nohighlight">\(x = (x_1, x_2, x_3) \in \mathbb R ^3\)</span>, we can write</p>
<div class="math notranslate nohighlight">
\[
x = x_1 e_1 + x_2 e_2 + x_3 e_3
\]</div>
<p>Now consider <span class="math notranslate nohighlight">\(A_0 = \{e_1, e_2, e_1 + e_2\}\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(y = (y_1, y_2, y_3)\)</span> is any linear combination of these vectors, then <span class="math notranslate nohighlight">\(y_3 = 0\)</span> (check it).</p>
<p>Hence <span class="math notranslate nohighlight">\(A_0\)</span> fails to span all of <span class="math notranslate nohighlight">\(\mathbb R ^3\)</span>.</p>
</div>
</div>
<div class="section" id="linear-independence">
<span id="la-li"></span><h3><span class="section-number">3.2.4. </span>Linear Independence<a class="headerlink" href="#linear-independence" title="Permalink to this headline">¶</a></h3>
<p id="index-7">As we’ll see, it’s often desirable to find families of vectors with relatively large span, so that many vectors can be described by linear operators on a few vectors.</p>
<p>The condition we need for a set of vectors to have a large span is what’s called linear independence.</p>
<p>In particular, a collection of vectors <span class="math notranslate nohighlight">\(A := \{a_1, \ldots, a_k\}\)</span> in <span class="math notranslate nohighlight">\(\mathbb R ^n\)</span> is said to be</p>
<ul class="simple">
<li><p><em>linearly dependent</em> if some strict subset of <span class="math notranslate nohighlight">\(A\)</span> has the same span as <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p><em>linearly independent</em> if it is not linearly dependent.</p></li>
</ul>
<p>Put differently, a set of vectors is linearly independent if no vector is redundant to the span and linearly dependent otherwise.</p>
<p>To illustrate the idea, recall <a class="reference internal" href="#la-3dvec"><span class="std std-ref">the figure</span></a> that showed the span of vectors <span class="math notranslate nohighlight">\(\{a_1, a_2\}\)</span> in <span class="math notranslate nohighlight">\(\mathbb R ^3\)</span> as a plane through the origin.</p>
<p>If we take a third vector <span class="math notranslate nohighlight">\(a_3\)</span> and form the set <span class="math notranslate nohighlight">\(\{a_1, a_2, a_3\}\)</span>, this set will be</p>
<ul class="simple">
<li><p>linearly dependent if <span class="math notranslate nohighlight">\(a_3\)</span> lies in the plane</p></li>
<li><p>linearly independent otherwise</p></li>
</ul>
<p>As another illustration of the concept, since <span class="math notranslate nohighlight">\(\mathbb R ^n\)</span> can be spanned by <span class="math notranslate nohighlight">\(n\)</span> vectors
(see the discussion of canonical basis vectors above), any collection of
<span class="math notranslate nohighlight">\(m &gt; n\)</span> vectors in <span class="math notranslate nohighlight">\(\mathbb R ^n\)</span> must be linearly dependent.</p>
<p>The following statements are equivalent to linear independence of <span class="math notranslate nohighlight">\(A := \{a_1, \ldots, a_k\} \subset \mathbb R ^n\)</span></p>
<ol class="simple">
<li><p>No vector in <span class="math notranslate nohighlight">\(A\)</span> can be formed as a linear combination of the other elements.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\beta_1 a_1 + \cdots \beta_k a_k = 0\)</span> for scalars <span class="math notranslate nohighlight">\(\beta_1, \ldots, \beta_k\)</span>, then <span class="math notranslate nohighlight">\(\beta_1 = \cdots = \beta_k = 0\)</span>.</p></li>
</ol>
<p>(The zero in the first expression is the origin of <span class="math notranslate nohighlight">\(\mathbb R ^n\)</span>)</p>
</div>
<div class="section" id="unique-representations">
<span id="la-unique-reps"></span><h3><span class="section-number">3.2.5. </span>Unique Representations<a class="headerlink" href="#unique-representations" title="Permalink to this headline">¶</a></h3>
<p>Another nice thing about sets of linearly independent vectors is that each element in the span has a unique representation as a linear combination of these vectors.</p>
<p>In other words, if <span class="math notranslate nohighlight">\(A := \{a_1, \ldots, a_k\} \subset \mathbb R ^n\)</span> is
linearly independent and</p>
<div class="math notranslate nohighlight">
\[
y = \beta_1 a_1 + \cdots \beta_k a_k
\]</div>
<p>then no other coefficient sequence <span class="math notranslate nohighlight">\(\gamma_1, \ldots, \gamma_k\)</span> will produce
the same vector <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>Indeed, if we also have <span class="math notranslate nohighlight">\(y = \gamma_1 a_1 + \cdots \gamma_k a_k\)</span>,
then</p>
<div class="math notranslate nohighlight">
\[
(\beta_1 - \gamma_1) a_1 + \cdots + (\beta_k - \gamma_k) a_k = 0
\]</div>
<p>Linear independence now implies <span class="math notranslate nohighlight">\(\gamma_i = \beta_i\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>.</p>
</div>
</div>
<div class="section" id="matrices">
<h2><a class="toc-backref" href="#id8"><span class="section-number">3.3. </span>Matrices</a><a class="headerlink" href="#matrices" title="Permalink to this headline">¶</a></h2>
<p id="index-8">Matrices are a neat way of organizing data for use in linear operations.</p>
<p>An <span class="math notranslate nohighlight">\(n \times k\)</span> matrix is a rectangular array <span class="math notranslate nohighlight">\(A\)</span> of numbers with <span class="math notranslate nohighlight">\(n\)</span> rows and <span class="math notranslate nohighlight">\(k\)</span> columns:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A =
\begin{bmatrix}
    a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1k} \\
    a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2k} \\
    \vdots &amp; \vdots &amp;  &amp; \vdots \\
    a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nk}
\end{bmatrix}
\end{split}\]</div>
<p>Often, the numbers in the matrix represent coefficients in a system of linear equations, as discussed at the start of this lecture.</p>
<p>For obvious reasons, the matrix <span class="math notranslate nohighlight">\(A\)</span> is also called a vector if either <span class="math notranslate nohighlight">\(n = 1\)</span> or <span class="math notranslate nohighlight">\(k = 1\)</span>.</p>
<p>In the former case, <span class="math notranslate nohighlight">\(A\)</span> is called a <em>row vector</em>, while in the latter it is called a <em>column vector</em>.</p>
<p>If <span class="math notranslate nohighlight">\(n = k\)</span>, then <span class="math notranslate nohighlight">\(A\)</span> is called <em>square</em>.</p>
<p>The matrix formed by replacing <span class="math notranslate nohighlight">\(a_{ij}\)</span> by <span class="math notranslate nohighlight">\(a_{ji}\)</span> for every <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> is called the <em>transpose</em> of <span class="math notranslate nohighlight">\(A\)</span> and denoted <span class="math notranslate nohighlight">\(A'\)</span> or <span class="math notranslate nohighlight">\(A^{\top}\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(A = A'\)</span>, then <span class="math notranslate nohighlight">\(A\)</span> is called <em>symmetric</em>.</p>
<p>For a square matrix <span class="math notranslate nohighlight">\(A\)</span>, the <span class="math notranslate nohighlight">\(i\)</span> elements of the form <span class="math notranslate nohighlight">\(a_{ii}\)</span> for <span class="math notranslate nohighlight">\(i=1,\ldots,n\)</span> are called the <em>principal diagonal</em>.</p>
<p><span class="math notranslate nohighlight">\(A\)</span> is called <em>diagonal</em> if the only nonzero entries are on the principal diagonal.</p>
<p>If, in addition to being diagonal, each element along the principal diagonal is equal to 1, then <span class="math notranslate nohighlight">\(A\)</span> is called the <em>identity matrix</em> and denoted by <span class="math notranslate nohighlight">\(I\)</span>.</p>
<div class="section" id="matrix-operations">
<h3><span class="section-number">3.3.1. </span>Matrix Operations<a class="headerlink" href="#matrix-operations" title="Permalink to this headline">¶</a></h3>
<p id="index-9">Just as was the case for vectors, a number of algebraic operations are defined for matrices.</p>
<p>Scalar multiplication and addition are immediate generalizations of the vector case:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\gamma A =
\gamma
\begin{bmatrix}
    a_{11} &amp;  \cdots &amp; a_{1k} \\
    \vdots &amp; \vdots  &amp; \vdots \\
    a_{n1} &amp;  \cdots &amp; a_{nk}
\end{bmatrix} :=
\begin{bmatrix}
    \gamma a_{11} &amp; \cdots &amp; \gamma a_{1k} \\
    \vdots &amp; \vdots &amp; \vdots \\
    \gamma a_{n1} &amp; \cdots &amp; \gamma a_{nk}
\end{bmatrix}
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A + B =
\begin{bmatrix}
    a_{11} &amp; \cdots &amp; a_{1k} \\
    \vdots &amp; \vdots &amp; \vdots \\
    a_{n1} &amp; \cdots &amp; a_{nk}
\end{bmatrix} +
\begin{bmatrix}
    b_{11} &amp; \cdots &amp; b_{1k} \\
    \vdots &amp; \vdots &amp; \vdots \\
    b_{n1} &amp; \cdots &amp; b_{nk}
\end{bmatrix} :=
\begin{bmatrix}
    a_{11} + b_{11} &amp;  \cdots &amp; a_{1k} + b_{1k} \\
    \vdots &amp; \vdots &amp; \vdots \\
    a_{n1} + b_{n1} &amp;  \cdots &amp; a_{nk} + b_{nk}
\end{bmatrix}
\end{split}\]</div>
<p>In the latter case, the matrices must have the same shape in order for the definition to make sense.</p>
<p>We also have a convention for <em>multiplying</em> two matrices.</p>
<p>The rule for matrix multiplication generalizes the idea of inner products discussed above
and is designed to make multiplication play well with basic linear operations.</p>
<p>If <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are two matrices, then their product <span class="math notranslate nohighlight">\(A B\)</span> is formed by taking as its
<span class="math notranslate nohighlight">\(i,j\)</span>-th element the inner product of the <span class="math notranslate nohighlight">\(i\)</span>-th row of <span class="math notranslate nohighlight">\(A\)</span> and the
<span class="math notranslate nohighlight">\(j\)</span>-th column of <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>There are many tutorials to help you visualize this operation, such as <a class="reference external" href="https://www.mathsisfun.com/algebra/matrix-multiplying.html">this one</a>, or the discussion on the <a class="reference external" href="https://en.wikipedia.org/wiki/Matrix_multiplication">Wikipedia page</a>.</p>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(n \times k\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is <span class="math notranslate nohighlight">\(j \times m\)</span>, then
to multiply <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> we require <span class="math notranslate nohighlight">\(k = j\)</span>, and the
resulting matrix <span class="math notranslate nohighlight">\(A B\)</span> is <span class="math notranslate nohighlight">\(n \times m\)</span>.</p>
<p>As perhaps the most important special case, consider multiplying <span class="math notranslate nohighlight">\(n \times k\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(k \times 1\)</span> column vector <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>According to the preceding rule, this gives us an <span class="math notranslate nohighlight">\(n \times 1\)</span> column vector</p>
<div class="math notranslate nohighlight" id="equation-la-atx">
<span class="eqno">(3.2)<a class="headerlink" href="#equation-la-atx" title="Permalink to this equation">¶</a></span>\[\begin{split}A x =
\begin{bmatrix}
    a_{11} &amp;  \cdots &amp; a_{1k} \\
    \vdots &amp; \vdots  &amp; \vdots \\
    a_{n1} &amp;  \cdots &amp; a_{nk}
\end{bmatrix}
\begin{bmatrix}
    x_{1}  \\
    \vdots  \\
    x_{k}
\end{bmatrix} :=
\begin{bmatrix}
    a_{11} x_1 + \cdots + a_{1k} x_k \\
    \vdots \\
    a_{n1} x_1 + \cdots + a_{nk} x_k
\end{bmatrix}\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="math notranslate nohighlight">\(A B\)</span> and <span class="math notranslate nohighlight">\(B A\)</span> are not generally the same thing.</p>
</div>
<p>Another important special case is the identity matrix.</p>
<p>You should check that if <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(n \times k\)</span> and <span class="math notranslate nohighlight">\(I\)</span> is the <span class="math notranslate nohighlight">\(k \times k\)</span> identity matrix, then <span class="math notranslate nohighlight">\(AI = A\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(I\)</span> is the <span class="math notranslate nohighlight">\(n \times n\)</span> identity matrix, then <span class="math notranslate nohighlight">\(IA = A\)</span>.</p>
</div>
<div class="section" id="matrices-in-numpy">
<h3><span class="section-number">3.3.2. </span>Matrices in NumPy<a class="headerlink" href="#matrices-in-numpy" title="Permalink to this headline">¶</a></h3>
<p id="index-10">NumPy arrays are also used as matrices, and have fast, efficient functions and methods for all the standard matrix operations <a class="footnote-reference brackets" href="#fn-mdt" id="id2">1</a>.</p>
<p>You can create them manually from tuples of tuples (or lists of lists) as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
     <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tuple
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">type</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 2)
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">shape</span></code> attribute is a tuple giving the number of rows and columns —
see <a class="reference external" href="https://python-programming.quantecon.org/numpy.html#shape-and-dimension">here</a>
for more discussion.</p>
<p>To get the transpose of <code class="docutils literal notranslate"><span class="pre">A</span></code>, use <code class="docutils literal notranslate"><span class="pre">A.transpose()</span></code> or, more simply, <code class="docutils literal notranslate"><span class="pre">A.T</span></code>.</p>
<p>There are many convenient functions for creating common matrices (matrices of zeros,
ones, etc.) — see <a class="reference external" href="https://python-programming.quantecon.org/numpy.html#creating-arrays">here</a>.</p>
<p>Since operations are performed elementwise by default, scalar multiplication and addition have very natural syntax</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="mi">2</span> <span class="o">*</span> <span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2., 0., 0.],
       [0., 2., 0.],
       [0., 0., 2.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2., 1., 1.],
       [1., 2., 1.],
       [1., 1., 2.]])
</pre></div>
</div>
</div>
</div>
<p>To multiply matrices we use the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbol.</p>
<p>In particular, <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">&#64;</span> <span class="pre">B</span></code> is matrix multiplication, whereas <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">*</span> <span class="pre">B</span></code> is element-by-element multiplication.</p>
<p>See <a class="reference external" href="https://python-programming.quantecon.org/numpy.html#matrix-multiplication">here</a> for more discussion.</p>
</div>
<div class="section" id="matrices-as-maps">
<span id="la-linear-map"></span><h3><span class="section-number">3.3.3. </span>Matrices as Maps<a class="headerlink" href="#matrices-as-maps" title="Permalink to this headline">¶</a></h3>
<p id="index-11">Each <span class="math notranslate nohighlight">\(n \times k\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> can be identified with a function <span class="math notranslate nohighlight">\(f(x) = Ax\)</span> that maps <span class="math notranslate nohighlight">\(x \in \mathbb R ^k\)</span> into <span class="math notranslate nohighlight">\(y = Ax \in \mathbb R ^n\)</span>.</p>
<p>These kinds of functions have a special property: they are <em>linear</em>.</p>
<p>A function <span class="math notranslate nohighlight">\(f \colon \mathbb R ^k \to \mathbb R ^n\)</span> is called <em>linear</em> if, for all <span class="math notranslate nohighlight">\(x, y \in \mathbb R ^k\)</span> and all scalars <span class="math notranslate nohighlight">\(\alpha, \beta\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
f(\alpha x + \beta y) = \alpha f(x) + \beta f(y)
\]</div>
<p>You can check that this holds for the function <span class="math notranslate nohighlight">\(f(x) = A x + b\)</span> when <span class="math notranslate nohighlight">\(b\)</span> is the zero vector and fails when <span class="math notranslate nohighlight">\(b\)</span> is nonzero.</p>
<p>In fact, it’s <a class="reference external" href="https://en.wikipedia.org/wiki/Linear_map#Matrices">known</a> that <span class="math notranslate nohighlight">\(f\)</span> is linear if and <em>only if</em> there exists a matrix <span class="math notranslate nohighlight">\(A\)</span> such that <span class="math notranslate nohighlight">\(f(x) = Ax\)</span> for all <span class="math notranslate nohighlight">\(x\)</span>.</p>
</div>
</div>
<div class="section" id="solving-systems-of-equations">
<h2><a class="toc-backref" href="#id9"><span class="section-number">3.4. </span>Solving Systems of Equations</a><a class="headerlink" href="#solving-systems-of-equations" title="Permalink to this headline">¶</a></h2>
<p id="index-12">Recall again the system of equations <a class="reference internal" href="#equation-la-se">(3.1)</a>.</p>
<p>If we compare <a class="reference internal" href="#equation-la-se">(3.1)</a> and <a class="reference internal" href="#equation-la-atx">(3.2)</a>, we see that <a class="reference internal" href="#equation-la-se">(3.1)</a> can now be
written more conveniently as</p>
<div class="math notranslate nohighlight" id="equation-la-se2">
<span class="eqno">(3.3)<a class="headerlink" href="#equation-la-se2" title="Permalink to this equation">¶</a></span>\[y = Ax\]</div>
<p>The problem we face is to determine a vector <span class="math notranslate nohighlight">\(x \in \mathbb R ^k\)</span> that solves <a class="reference internal" href="#equation-la-se2">(3.3)</a>, taking <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(A\)</span> as given.</p>
<p>This is a special case of a more general problem: Find an <span class="math notranslate nohighlight">\(x\)</span> such that <span class="math notranslate nohighlight">\(y = f(x)\)</span>.</p>
<p>Given an arbitrary function <span class="math notranslate nohighlight">\(f\)</span> and a <span class="math notranslate nohighlight">\(y\)</span>, is there always an <span class="math notranslate nohighlight">\(x\)</span> such that <span class="math notranslate nohighlight">\(y = f(x)\)</span>?</p>
<p>If so, is it always unique?</p>
<p>The answer to both these questions is negative, as the next figure shows</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.4</span>


<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ya</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="c1"># Set the axes through the origin</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span>
           <span class="n">yticks</span><span class="o">=</span><span class="p">(),</span> <span class="n">xticks</span><span class="o">=</span><span class="p">())</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">ya</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;range of $f$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;$0$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ybar</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">0</span> <span class="o">+</span> <span class="n">ybar</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">ybar</span><span class="p">,</span> <span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="o">-</span><span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;$x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ybar</span> <span class="o">=</span> <span class="mf">2.6</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">0</span> <span class="o">+</span> <span class="n">ybar</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.91</span> <span class="o">*</span> <span class="n">ybar</span><span class="p">,</span> <span class="s1">&#39;$y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/linear_algebra_23_0.png" src="_images/linear_algebra_23_0.png" />
</div>
</div>
<p>In the first plot, there are multiple solutions, as the function is not one-to-one, while
in the second there are no solutions, since <span class="math notranslate nohighlight">\(y\)</span> lies outside the range of <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>Can we impose conditions on <span class="math notranslate nohighlight">\(A\)</span> in <a class="reference internal" href="#equation-la-se2">(3.3)</a> that rule out these problems?</p>
<p>In this context, the most important thing to recognize about the expression
<span class="math notranslate nohighlight">\(Ax\)</span> is that it corresponds to a linear combination of the columns of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>In particular, if <span class="math notranslate nohighlight">\(a_1, \ldots, a_k\)</span> are the columns of <span class="math notranslate nohighlight">\(A\)</span>, then</p>
<div class="math notranslate nohighlight">
\[
Ax = x_1 a_1 + \cdots + x_k a_k
\]</div>
<p>Hence the range of <span class="math notranslate nohighlight">\(f(x) = Ax\)</span> is exactly the span of the columns of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>We want the range to be large so that it contains arbitrary <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>As you might recall, the condition that we want for the span to be large is <a class="reference internal" href="#la-li"><span class="std std-ref">linear independence</span></a>.</p>
<p>A happy fact is that linear independence of the columns of <span class="math notranslate nohighlight">\(A\)</span> also gives us uniqueness.</p>
<p>Indeed, it follows from our <a class="reference internal" href="#la-unique-reps"><span class="std std-ref">earlier discussion</span></a> that if <span class="math notranslate nohighlight">\(\{a_1, \ldots, a_k\}\)</span> are linearly independent and <span class="math notranslate nohighlight">\(y = Ax = x_1 a_1 + \cdots + x_k a_k\)</span>, then no <span class="math notranslate nohighlight">\(z \not= x\)</span> satisfies <span class="math notranslate nohighlight">\(y = Az\)</span>.</p>
<div class="section" id="the-square-matrix-case">
<h3><span class="section-number">3.4.1. </span>The Square Matrix Case<a class="headerlink" href="#the-square-matrix-case" title="Permalink to this headline">¶</a></h3>
<p>Let’s discuss some more details, starting with the case where <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(n \times n\)</span>.</p>
<p>This is the familiar case where the number of unknowns equals the number of equations.</p>
<p>For arbitrary <span class="math notranslate nohighlight">\(y \in \mathbb R ^n\)</span>, we hope to find a unique <span class="math notranslate nohighlight">\(x \in \mathbb R ^n\)</span> such that <span class="math notranslate nohighlight">\(y = Ax\)</span>.</p>
<p>In view of the observations immediately above, if the columns of <span class="math notranslate nohighlight">\(A\)</span> are
linearly independent, then their span, and hence the range of <span class="math notranslate nohighlight">\(f(x) =
Ax\)</span>, is all of <span class="math notranslate nohighlight">\(\mathbb R ^n\)</span>.</p>
<p>Hence there always exists an <span class="math notranslate nohighlight">\(x\)</span> such that <span class="math notranslate nohighlight">\(y = Ax\)</span>.</p>
<p>Moreover, the solution is unique.</p>
<p>In particular, the following are equivalent</p>
<ol class="simple">
<li><p>The columns of <span class="math notranslate nohighlight">\(A\)</span> are linearly independent.</p></li>
<li><p>For any <span class="math notranslate nohighlight">\(y \in \mathbb R ^n\)</span>, the equation <span class="math notranslate nohighlight">\(y = Ax\)</span> has a unique solution.</p></li>
</ol>
<p>The property of having linearly independent columns is sometimes expressed as having <em>full column rank</em>.</p>
<div class="section" id="inverse-matrices">
<h4><span class="section-number">3.4.1.1. </span>Inverse Matrices<a class="headerlink" href="#inverse-matrices" title="Permalink to this headline">¶</a></h4>
<p id="index-13">Can we give some sort of expression for the solution?</p>
<p>If <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(A\)</span> are scalar with <span class="math notranslate nohighlight">\(A \not= 0\)</span>, then the
solution is <span class="math notranslate nohighlight">\(x = A^{-1} y\)</span>.</p>
<p>A similar expression is available in the matrix case.</p>
<p>In particular, if square matrix <span class="math notranslate nohighlight">\(A\)</span> has full column rank, then it possesses a multiplicative
<em>inverse matrix</em> <span class="math notranslate nohighlight">\(A^{-1}\)</span>, with the property that <span class="math notranslate nohighlight">\(A A^{-1} = A^{-1} A = I\)</span>.</p>
<p>As a consequence, if we pre-multiply both sides of <span class="math notranslate nohighlight">\(y = Ax\)</span> by <span class="math notranslate nohighlight">\(A^{-1}\)</span>, we get <span class="math notranslate nohighlight">\(x = A^{-1} y\)</span>.</p>
<p>This is the solution that we’re looking for.</p>
</div>
<div class="section" id="determinants">
<h4><span class="section-number">3.4.1.2. </span>Determinants<a class="headerlink" href="#determinants" title="Permalink to this headline">¶</a></h4>
<p id="index-14">Another quick comment about square matrices is that to every such matrix we
assign a unique number called the <em>determinant</em> of the matrix — you can find
the expression for it <a class="reference external" href="https://en.wikipedia.org/wiki/Determinant">here</a>.</p>
<p>If the determinant of <span class="math notranslate nohighlight">\(A\)</span> is not zero, then we say that <span class="math notranslate nohighlight">\(A\)</span> is
<em>nonsingular</em>.</p>
<p>Perhaps the most important fact about determinants is that <span class="math notranslate nohighlight">\(A\)</span> is nonsingular if and only if <span class="math notranslate nohighlight">\(A\)</span> is of full column rank.</p>
<p>This gives us a useful one-number summary of whether or not a square matrix can be
inverted.</p>
</div>
</div>
<div class="section" id="more-rows-than-columns">
<h3><span class="section-number">3.4.2. </span>More Rows than Columns<a class="headerlink" href="#more-rows-than-columns" title="Permalink to this headline">¶</a></h3>
<p>This is the <span class="math notranslate nohighlight">\(n \times k\)</span> case with <span class="math notranslate nohighlight">\(n &gt; k\)</span>.</p>
<p>This case is very important in many settings, not least in the setting of linear regression (where <span class="math notranslate nohighlight">\(n\)</span> is the number of observations, and <span class="math notranslate nohighlight">\(k\)</span> is the number of explanatory variables).</p>
<p>Given arbitrary <span class="math notranslate nohighlight">\(y \in \mathbb R ^n\)</span>, we seek an <span class="math notranslate nohighlight">\(x \in \mathbb R ^k\)</span> such that <span class="math notranslate nohighlight">\(y = Ax\)</span>.</p>
<p>In this setting, the existence of a solution is highly unlikely.</p>
<p>Without much loss of generality, let’s go over the intuition focusing on the case where the columns of
<span class="math notranslate nohighlight">\(A\)</span> are linearly independent.</p>
<p>It follows that the span of the columns of <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(k\)</span>-dimensional subspace of <span class="math notranslate nohighlight">\(\mathbb R ^n\)</span>.</p>
<p>This span is very “unlikely” to contain arbitrary <span class="math notranslate nohighlight">\(y \in \mathbb R ^n\)</span>.</p>
<p>To see why, recall the <a class="reference internal" href="#la-3dvec"><span class="std std-ref">figure above</span></a>, where <span class="math notranslate nohighlight">\(k=2\)</span> and <span class="math notranslate nohighlight">\(n=3\)</span>.</p>
<p>Imagine an arbitrarily chosen <span class="math notranslate nohighlight">\(y \in \mathbb R ^3\)</span>, located somewhere in that three-dimensional space.</p>
<p>What’s the likelihood that <span class="math notranslate nohighlight">\(y\)</span> lies in the span of <span class="math notranslate nohighlight">\(\{a_1, a_2\}\)</span> (i.e., the two dimensional plane through these points)?</p>
<p>In a sense, it must be very small, since this plane has zero “thickness”.</p>
<p>As a result, in the <span class="math notranslate nohighlight">\(n &gt; k\)</span> case we usually give up on existence.</p>
<p>However, we can still seek the best approximation, for example, an
<span class="math notranslate nohighlight">\(x\)</span> that makes the distance <span class="math notranslate nohighlight">\(\| y - Ax\|\)</span> as small as possible.</p>
<p>To solve this problem, one can use either calculus or the theory of orthogonal
projections.</p>
<p>The solution is known to be <span class="math notranslate nohighlight">\(\hat x = (A'A)^{-1}A'y\)</span> — see for example chapter 3 of <a class="reference external" href="https://python.quantecon.org/_static/lecture_specific/linear_algebra/course_notes.pdf">these notes</a>.</p>
</div>
<div class="section" id="more-columns-than-rows">
<h3><span class="section-number">3.4.3. </span>More Columns than Rows<a class="headerlink" href="#more-columns-than-rows" title="Permalink to this headline">¶</a></h3>
<p>This is the <span class="math notranslate nohighlight">\(n \times k\)</span> case with <span class="math notranslate nohighlight">\(n &lt; k\)</span>, so there are fewer
equations than unknowns.</p>
<p>In this case there are either no solutions or infinitely many — in other words, uniqueness never holds.</p>
<p>For example, consider the case where <span class="math notranslate nohighlight">\(k=3\)</span> and <span class="math notranslate nohighlight">\(n=2\)</span>.</p>
<p>Thus, the columns of <span class="math notranslate nohighlight">\(A\)</span> consists of 3 vectors in <span class="math notranslate nohighlight">\(\mathbb R ^2\)</span>.</p>
<p>This set can never be linearly independent, since it is possible to find two vectors that span
<span class="math notranslate nohighlight">\(\mathbb R ^2\)</span>.</p>
<p>(For example, use the canonical basis vectors)</p>
<p>It follows that one column is a linear combination of the other two.</p>
<p>For example, let’s say that <span class="math notranslate nohighlight">\(a_1 = \alpha a_2 + \beta a_3\)</span>.</p>
<p>Then if <span class="math notranslate nohighlight">\(y = Ax = x_1 a_1 + x_2 a_2 + x_3 a_3\)</span>, we can also write</p>
<div class="math notranslate nohighlight">
\[
y
= x_1 (\alpha a_2 + \beta a_3) + x_2 a_2 + x_3 a_3
= (x_1 \alpha + x_2) a_2 + (x_1 \beta + x_3) a_3
\]</div>
<p>In other words, uniqueness fails.</p>
</div>
<div class="section" id="linear-equations-with-scipy">
<h3><span class="section-number">3.4.4. </span>Linear Equations with SciPy<a class="headerlink" href="#linear-equations-with-scipy" title="Permalink to this headline">¶</a></h3>
<p id="index-15">Here’s an illustration of how to solve linear equations with SciPy’s <code class="docutils literal notranslate"><span class="pre">linalg</span></code> submodule.</p>
<p>All of these routines are Python front ends to time-tested and highly optimized FORTRAN code</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Column vector</span>
<span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># Check that A is nonsingular, and hence invertible</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_inv</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># Compute the inverse</span>
<span class="n">A_inv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-2. ,  1. ],
       [ 1.5, -0.5]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">A_inv</span> <span class="o">@</span> <span class="n">y</span>  <span class="c1"># Solution</span>
<span class="n">A</span> <span class="o">@</span> <span class="n">x</span>          <span class="c1"># Should equal y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.],
       [1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Produces the same solution</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.],
       [ 1.]])
</pre></div>
</div>
</div>
</div>
<p>Observe how we can solve for <span class="math notranslate nohighlight">\(x = A^{-1} y\)</span> by either via <code class="docutils literal notranslate"><span class="pre">inv(A)</span> <span class="pre">&#64;</span> <span class="pre">y</span></code>, or using <code class="docutils literal notranslate"><span class="pre">solve(A,</span> <span class="pre">y)</span></code>.</p>
<p>The latter method uses a different algorithm (LU decomposition) that is numerically more stable, and hence should almost always be preferred.</p>
<p>To obtain the least-squares solution <span class="math notranslate nohighlight">\(\hat x = (A'A)^{-1}A'y\)</span>, use <code class="docutils literal notranslate"><span class="pre">scipy.linalg.lstsq(A,</span> <span class="pre">y)</span></code>.</p>
</div>
</div>
<div class="section" id="eigenvalues-and-eigenvectors">
<span id="la-eigen"></span><h2><a class="toc-backref" href="#id10"><span class="section-number">3.5. </span><span class="target" id="index-16"></span>Eigenvalues and <span class="target" id="index-17"></span>Eigenvectors</a><a class="headerlink" href="#eigenvalues-and-eigenvectors" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-18"></span><p id="index-19">Let <span class="math notranslate nohighlight">\(A\)</span> be an <span class="math notranslate nohighlight">\(n \times n\)</span> square matrix.</p>
<p>If <span class="math notranslate nohighlight">\(\lambda\)</span> is scalar and <span class="math notranslate nohighlight">\(v\)</span> is a non-zero vector in <span class="math notranslate nohighlight">\(\mathbb R ^n\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
A v = \lambda v
\]</div>
<p>then we say that <span class="math notranslate nohighlight">\(\lambda\)</span> is an <em>eigenvalue</em> of <span class="math notranslate nohighlight">\(A\)</span>, and
<span class="math notranslate nohighlight">\(v\)</span> is an <em>eigenvector</em>.</p>
<p>Thus, an eigenvector of <span class="math notranslate nohighlight">\(A\)</span> is a vector such that when the map <span class="math notranslate nohighlight">\(f(x) = Ax\)</span> is applied, <span class="math notranslate nohighlight">\(v\)</span> is merely scaled.</p>
<p>The next figure shows two eigenvectors (blue arrows) and their images under <span class="math notranslate nohighlight">\(A\)</span> (red arrows).</p>
<p>As expected, the image <span class="math notranslate nohighlight">\(Av\)</span> of each <span class="math notranslate nohighlight">\(v\)</span> is just a scaled version of the original</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
     <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">evecs</span> <span class="o">=</span> <span class="n">evecs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">evecs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1"># Set the axes through the origin</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">))</span>

<span class="c1"># Plot each eigenvector</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">evecs</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                <span class="n">shrink</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="c1"># Plot the image of each eigenvector</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">evecs</span><span class="p">:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">v</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                <span class="n">shrink</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="c1"># Plot the lines they run through</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">evecs</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/linear_algebra_30_0.png" src="_images/linear_algebra_30_0.png" />
</div>
</div>
<p>The eigenvalue equation is equivalent to <span class="math notranslate nohighlight">\((A - \lambda I) v = 0\)</span>, and
this has a nonzero solution <span class="math notranslate nohighlight">\(v\)</span> only when the columns of <span class="math notranslate nohighlight">\(A -
\lambda I\)</span> are linearly dependent.</p>
<p>This in turn is equivalent to stating that the determinant is zero.</p>
<p>Hence to find all eigenvalues, we can look for <span class="math notranslate nohighlight">\(\lambda\)</span> such that the
determinant of <span class="math notranslate nohighlight">\(A - \lambda I\)</span> is zero.</p>
<p>This problem can be expressed as one of solving for the roots of a polynomial
in <span class="math notranslate nohighlight">\(\lambda\)</span> of degree <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>This in turn implies the existence of <span class="math notranslate nohighlight">\(n\)</span> solutions in the complex
plane, although some might be repeated.</p>
<p>Some nice facts about the eigenvalues of a square matrix <span class="math notranslate nohighlight">\(A\)</span> are as follows</p>
<ol class="simple">
<li><p>The determinant of <span class="math notranslate nohighlight">\(A\)</span> equals  the product of the eigenvalues.</p></li>
<li><p>The trace of <span class="math notranslate nohighlight">\(A\)</span> (the sum of the elements on the principal diagonal) equals the sum of the eigenvalues.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(A\)</span> is symmetric, then all of its eigenvalues are real.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(A\)</span> is invertible and <span class="math notranslate nohighlight">\(\lambda_1, \ldots, \lambda_n\)</span> are its eigenvalues, then the eigenvalues of <span class="math notranslate nohighlight">\(A^{-1}\)</span> are <span class="math notranslate nohighlight">\(1/\lambda_1, \ldots, 1/\lambda_n\)</span>.</p></li>
</ol>
<p>A corollary of the first statement is that a matrix is invertible if and only if all its eigenvalues are nonzero.</p>
<p>Using SciPy, we can solve for the eigenvalues and eigenvectors of a matrix as
follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
     <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">evals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 3.+0.j, -1.+0.j])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">evecs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.70710678, -0.70710678],
       [ 0.70710678,  0.70710678]])
</pre></div>
</div>
</div>
</div>
<p>Note that the <em>columns</em> of <code class="docutils literal notranslate"><span class="pre">evecs</span></code> are the eigenvectors.</p>
<p>Since any scalar multiple of an eigenvector is an eigenvector with the same
eigenvalue (check it), the eig routine normalizes the length of each eigenvector
to one.</p>
<div class="section" id="generalized-eigenvalues">
<h3><span class="section-number">3.5.1. </span>Generalized Eigenvalues<a class="headerlink" href="#generalized-eigenvalues" title="Permalink to this headline">¶</a></h3>
<p>It is sometimes useful to consider the <em>generalized eigenvalue problem</em>, which, for given
matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, seeks generalized eigenvalues
<span class="math notranslate nohighlight">\(\lambda\)</span> and eigenvectors <span class="math notranslate nohighlight">\(v\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
A v = \lambda B v
\]</div>
<p>This can be solved in SciPy via <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eig(A,</span> <span class="pre">B)</span></code>.</p>
<p>Of course, if <span class="math notranslate nohighlight">\(B\)</span> is square and invertible, then we can treat the
generalized eigenvalue problem as an ordinary eigenvalue problem <span class="math notranslate nohighlight">\(B^{-1}
A v = \lambda v\)</span>, but this is not always the case.</p>
</div>
</div>
<div class="section" id="further-topics">
<h2><a class="toc-backref" href="#id11"><span class="section-number">3.6. </span>Further Topics</a><a class="headerlink" href="#further-topics" title="Permalink to this headline">¶</a></h2>
<p>We round out our discussion by briefly mentioning several other important
topics.</p>
<div class="section" id="series-expansions">
<h3><span class="section-number">3.6.1. </span>Series Expansions<a class="headerlink" href="#series-expansions" title="Permalink to this headline">¶</a></h3>
<p id="index-20">Recall the usual summation formula for a geometric progression, which states
that if <span class="math notranslate nohighlight">\(|a| &lt; 1\)</span>, then <span class="math notranslate nohighlight">\(\sum_{k=0}^{\infty} a^k = (1 - a)^{-1}\)</span>.</p>
<p>A generalization of this idea exists in the matrix setting.</p>
<div class="section" id="matrix-norms">
<span id="la-mn"></span><h4><span class="section-number">3.6.1.1. </span>Matrix Norms<a class="headerlink" href="#matrix-norms" title="Permalink to this headline">¶</a></h4>
<p id="index-21">Let <span class="math notranslate nohighlight">\(A\)</span> be a square matrix, and let</p>
<div class="math notranslate nohighlight">
\[
\| A \| := \max_{\| x \| = 1} \| A x \|
\]</div>
<p>The norms on the right-hand side are ordinary vector norms, while the norm on
the left-hand side is a <em>matrix norm</em> — in this case, the so-called
<em>spectral norm</em>.</p>
<p>For example, for a square matrix <span class="math notranslate nohighlight">\(S\)</span>, the condition <span class="math notranslate nohighlight">\(\| S \| &lt; 1\)</span> means that <span class="math notranslate nohighlight">\(S\)</span> is <em>contractive</em>, in the sense that it pulls all vectors towards the origin <a class="footnote-reference brackets" href="#cfn" id="id3">2</a>.</p>
</div>
<div class="section" id="neumann-s-theorem">
<span id="la-neumann"></span><h4><span class="section-number">3.6.1.2. </span><span class="target" id="index-22"></span>Neumann’s Theorem<a class="headerlink" href="#neumann-s-theorem" title="Permalink to this headline">¶</a></h4>
<p id="index-23">Let <span class="math notranslate nohighlight">\(A\)</span> be a square matrix and let <span class="math notranslate nohighlight">\(A^k := A A^{k-1}\)</span> with <span class="math notranslate nohighlight">\(A^1 := A\)</span>.</p>
<p>In other words, <span class="math notranslate nohighlight">\(A^k\)</span> is the <span class="math notranslate nohighlight">\(k\)</span>-th power of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Neumann’s theorem states the following: If <span class="math notranslate nohighlight">\(\| A^k \| &lt; 1\)</span> for some
<span class="math notranslate nohighlight">\(k \in \mathbb{N}\)</span>, then <span class="math notranslate nohighlight">\(I - A\)</span> is invertible, and</p>
<div class="math notranslate nohighlight" id="equation-la-neumann">
<span class="eqno">(3.4)<a class="headerlink" href="#equation-la-neumann" title="Permalink to this equation">¶</a></span>\[(I - A)^{-1} = \sum_{k=0}^{\infty} A^k\]</div>
</div>
<div class="section" id="spectral-radius">
<span id="la-neumann-remarks"></span><h4><span class="section-number">3.6.1.3. </span><span class="target" id="index-24"></span>Spectral Radius<a class="headerlink" href="#spectral-radius" title="Permalink to this headline">¶</a></h4>
<p id="index-25">A result known as Gelfand’s formula tells us that, for any square matrix <span class="math notranslate nohighlight">\(A\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\rho(A) = \lim_{k \to \infty} \| A^k \|^{1/k}
\]</div>
<p>Here <span class="math notranslate nohighlight">\(\rho(A)\)</span> is the <em>spectral radius</em>, defined as <span class="math notranslate nohighlight">\(\max_i |\lambda_i|\)</span>, where <span class="math notranslate nohighlight">\(\{\lambda_i\}_i\)</span> is the set of eigenvalues of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>As a consequence of Gelfand’s formula, if all eigenvalues are strictly less than one in modulus,
there exists a <span class="math notranslate nohighlight">\(k\)</span> with <span class="math notranslate nohighlight">\(\| A^k \| &lt; 1\)</span>.</p>
<p>In which case <a class="reference internal" href="#equation-la-neumann">(3.4)</a> is valid.</p>
</div>
</div>
<div class="section" id="positive-definite-matrices">
<h3><span class="section-number">3.6.2. </span><span class="target" id="index-26"></span>Positive Definite Matrices<a class="headerlink" href="#positive-definite-matrices" title="Permalink to this headline">¶</a></h3>
<p id="index-27">Let <span class="math notranslate nohighlight">\(A\)</span> be a symmetric <span class="math notranslate nohighlight">\(n \times n\)</span> matrix.</p>
<p>We say that <span class="math notranslate nohighlight">\(A\)</span> is</p>
<ol class="simple">
<li><p><em>positive definite</em> if <span class="math notranslate nohighlight">\(x' A x &gt; 0\)</span> for every <span class="math notranslate nohighlight">\(x \in \mathbb R ^n \setminus \{0\}\)</span></p></li>
<li><p><em>positive semi-definite</em> or <em>nonnegative definite</em> if <span class="math notranslate nohighlight">\(x' A x \geq 0\)</span> for every <span class="math notranslate nohighlight">\(x \in \mathbb R ^n\)</span></p></li>
</ol>
<p>Analogous definitions exist for negative definite and negative semi-definite matrices.</p>
<p>It is notable that if <span class="math notranslate nohighlight">\(A\)</span> is positive definite, then all of its eigenvalues
are strictly positive, and hence <span class="math notranslate nohighlight">\(A\)</span> is invertible (with positive
definite inverse).</p>
</div>
<div class="section" id="differentiating-linear-and-quadratic-forms">
<span id="la-mcalc"></span><h3><span class="section-number">3.6.3. </span>Differentiating Linear and Quadratic Forms<a class="headerlink" href="#differentiating-linear-and-quadratic-forms" title="Permalink to this headline">¶</a></h3>
<p id="index-28">The following formulas are useful in many economic contexts.  Let</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z, x\)</span> and <span class="math notranslate nohighlight">\(a\)</span> all be <span class="math notranslate nohighlight">\(n \times 1\)</span> vectors</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> be an <span class="math notranslate nohighlight">\(n  \times n\)</span> matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(B\)</span> be an <span class="math notranslate nohighlight">\(m \times n\)</span> matrix and <span class="math notranslate nohighlight">\(y\)</span> be an <span class="math notranslate nohighlight">\(m  \times 1\)</span> vector</p></li>
</ul>
<p>Then</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{\partial a' x}{\partial x} = a\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial A x}{\partial x} = A'\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial x'A x}{\partial x} = (A + A') x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial y'B z}{\partial y} = B z\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{\partial y'B z}{\partial B} = y z'\)</span></p></li>
</ol>
<p><a class="reference internal" href="#la_ex1"><span class="std std-numref">Exercise 3.1</span></a> below asks you to apply these formulas.</p>
</div>
<div class="section" id="further-reading">
<h3><span class="section-number">3.6.4. </span>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h3>
<p>The documentation of the <code class="docutils literal notranslate"><span class="pre">scipy.linalg</span></code> submodule can be found <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/linalg.html">here</a>.</p>
<p>Chapters 2 and 3 of the <a class="reference external" href="https://johnstachurski.net/emet.html">Econometric Theory</a> contains
a discussion of linear algebra along the same lines as above, with solved exercises.</p>
<p>If you don’t mind a slightly abstract approach, a nice intermediate-level text on linear algebra
is <span id="id4">[<a class="reference internal" href="zreferences.html#id175" title="K Jänich. Linear Algebra. Springer Undergraduate Texts in Mathematics and Technology. Springer, 1994.">Janich94</a>]</span>.</p>
</div>
</div>
<div class="section" id="exercises">
<h2><a class="toc-backref" href="#id12"><span class="section-number">3.7. </span>Exercises</a><a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="exercise admonition" id="la_ex1">

<p class="admonition-title"><span class="caption-number">Exercise 3.1 </span></p>
<div class="section" id="exercise-content">
<p>Let <span class="math notranslate nohighlight">\(x\)</span> be a given <span class="math notranslate nohighlight">\(n \times 1\)</span> vector and consider the problem</p>
<div class="math notranslate nohighlight">
\[
v(x) =  \max_{y,u} \left\{ - y'P y - u' Q u \right\}
\]</div>
<p>subject to the linear constraint</p>
<div class="math notranslate nohighlight">
\[
y = A x + B u
\]</div>
<p>Here</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix and <span class="math notranslate nohighlight">\(Q\)</span> is an <span class="math notranslate nohighlight">\(m \times m\)</span> matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix and <span class="math notranslate nohighlight">\(B\)</span> is an <span class="math notranslate nohighlight">\(n \times m\)</span> matrix</p></li>
<li><p>both <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> are symmetric and positive semidefinite</p></li>
</ul>
<p>(What must the dimensions of <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(u\)</span> be to make this a well-posed problem?)</p>
<p>One way to solve the problem is to form the Lagrangian</p>
<div class="math notranslate nohighlight">
\[
\mathcal L = - y' P y - u' Q u + \lambda' \left[A x + B u - y\right]
\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is an <span class="math notranslate nohighlight">\(n \times 1\)</span> vector of Lagrange multipliers.</p>
<p>Try applying the formulas given above for differentiating quadratic and linear forms to obtain the first-order conditions for maximizing <span class="math notranslate nohighlight">\(\mathcal L\)</span> with respect to <span class="math notranslate nohighlight">\(y, u\)</span> and minimizing it with respect to <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p>Show that these conditions imply that</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda = - 2 P y\)</span>.</p></li>
<li><p>The optimizing choice of <span class="math notranslate nohighlight">\(u\)</span> satisfies <span class="math notranslate nohighlight">\(u = - (Q + B' P B)^{-1} B' P A x\)</span>.</p></li>
<li><p>The function <span class="math notranslate nohighlight">\(v\)</span> satisfies <span class="math notranslate nohighlight">\(v(x) = - x' \tilde P x\)</span> where <span class="math notranslate nohighlight">\(\tilde P = A' P A - A'P B (Q + B'P B)^{-1} B' P A\)</span>.</p></li>
</ol>
<p>As we will see, in economic contexts Lagrange multipliers often are shadow prices.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If we don’t care about the Lagrange multipliers, we can substitute the constraint into the objective function, and then just maximize <span class="math notranslate nohighlight">\(-(Ax + Bu)'P (Ax + Bu) - u' Q u\)</span> with respect to <span class="math notranslate nohighlight">\(u\)</span>.  You can verify that this leads to the same maximizer.</p>
</div>
</div>
</div>
<div class="solution dropdown admonition" id="linear_algebra-solution-1">

<p class="admonition-title">Solution to<a class="reference internal" href="#la_ex1"> Exercise 3.1</a></p>
<div class="section" id="s">
<span id="o"></span><span id="l"></span><span id="u"></span><span id="t"></span><span id="i"></span><span id="o"></span><span id="n"></span><span id="-"></span><span id="c"></span><span id="o"></span><span id="n"></span><span id="t"></span><span id="e"></span><span id="n"></span><span id="t"></span><p>We have an optimization problem:</p>
<div class="math notranslate nohighlight">
\[
v(x) = \max_{y,u} \{ -y'Py - u'Qu \}
\]</div>
<p>s.t.</p>
<div class="math notranslate nohighlight">
\[
y = Ax + Bu
\]</div>
<p>with primitives</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P\)</span> be a symmetric and positive semidefinite <span class="math notranslate nohighlight">\(n \times n\)</span>
matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(Q\)</span> be a symmetric and positive semidefinite <span class="math notranslate nohighlight">\(m \times m\)</span>
matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span> an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(B\)</span> an <span class="math notranslate nohighlight">\(n \times m\)</span> matrix</p></li>
</ul>
<p>The associated Lagrangian is:</p>
<div class="math notranslate nohighlight">
\[
L = -y'Py - u'Qu + \lambda' \lbrack Ax + Bu - y \rbrack
\]</div>
<p><strong>Step 1.</strong></p>
<p>Differentiating Lagrangian equation w.r.t y and setting its derivative
equal to zero yields</p>
<div class="math notranslate nohighlight">
\[
\frac{ \partial L}{\partial y} = - (P + P') y - \lambda = - 2 P y - \lambda = 0 \:,
\]</div>
<p>since P is symmetric.</p>
<p>Accordingly, the first-order condition for maximizing L w.r.t. y implies</p>
<div class="math notranslate nohighlight">
\[
\lambda = -2 Py \:
\]</div>
<p><strong>Step 2.</strong></p>
<p>Differentiating Lagrangian equation w.r.t. u and setting its derivative
equal to zero yields</p>
<div class="math notranslate nohighlight">
\[
\frac{ \partial L}{\partial u} = - (Q + Q') u - B'\lambda = - 2Qu + B'\lambda = 0 \:
\]</div>
<p>Substituting <span class="math notranslate nohighlight">\(\lambda = -2 P y\)</span> gives</p>
<div class="math notranslate nohighlight">
\[
Qu + B'Py = 0 \:
\]</div>
<p>Substituting the linear constraint <span class="math notranslate nohighlight">\(y = Ax + Bu\)</span> into above
equation gives</p>
<div class="math notranslate nohighlight">
\[
Qu + B'P(Ax + Bu) = 0
\]</div>
<div class="math notranslate nohighlight">
\[
(Q + B'PB)u + B'PAx = 0
\]</div>
<p>which is the first-order condition for maximizing <span class="math notranslate nohighlight">\(L\)</span> w.r.t. <span class="math notranslate nohighlight">\(u\)</span>.</p>
<p>Thus, the optimal choice of u must satisfy</p>
<div class="math notranslate nohighlight">
\[
u = -(Q + B'PB)^{-1}B'PAx \:,
\]</div>
<p>which follows from the definition of the first-order conditions for
Lagrangian equation.</p>
<p><strong>Step 3.</strong></p>
<p>Rewriting our problem by substituting the constraint into the objective
function, we get</p>
<div class="math notranslate nohighlight">
\[
v(x) = \max_{u} \{ -(Ax+ Bu)'P(Ax+Bu) - u'Qu \} \:
\]</div>
<p>Since we know the optimal choice of u satisfies <span class="math notranslate nohighlight">\(u = -(Q +
B'PB)^{-1}B'PAx\)</span>, then</p>
<div class="math notranslate nohighlight">
\[
v(x) =  -(Ax+ B u)'P(Ax+B u) - u'Q u  \,\,\,\, with \,\,\,\, u = -(Q + B'PB)^{-1}B'PAx
\]</div>
<p>To evaluate the function</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
v(x) &amp;=  -(Ax+ B u)'P(Ax+Bu) - u'Q u \\
&amp;= -(x'A' + u'B')P(Ax+Bu) - u'Q u \\
&amp;= - x'A'PAx - u'B'PAx - x'A'PBu - u'B'PBu - u'Qu \\
&amp;= - x'A'PAx - 2u'B'PAx - u'(Q + B'PB) u
\end{aligned}
\end{split}\]</div>
<p>For simplicity, denote by <span class="math notranslate nohighlight">\(S := (Q + B'PB)^{-1} B'PA\)</span>, then <span class="math notranslate nohighlight">\(u = -Sx\)</span>.</p>
<p>Regarding the second term <span class="math notranslate nohighlight">\(- 2u'B'PAx\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
-2u'B'PAx &amp;= -2 x'S'B'PAx  \\
&amp; = 2 x'A'PB( Q + B'PB)^{-1} B'PAx
\end{aligned}
\end{split}\]</div>
<p>Notice that the term <span class="math notranslate nohighlight">\((Q + B'PB)^{-1}\)</span> is symmetric as both P and Q
are symmetric.</p>
<p>Regarding the third term <span class="math notranslate nohighlight">\(- u'(Q + B'PB) u\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
-u'(Q + B'PB) u &amp;= - x'S' (Q + B'PB)Sx \\
&amp;= -x'A'PB(Q + B'PB)^{-1}B'PAx
\end{aligned}
\end{split}\]</div>
<p>Hence, the summation of second and third terms is
<span class="math notranslate nohighlight">\(x'A'PB(Q + B'PB)^{-1}B'PAx\)</span>.</p>
<p>This implies that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
 v(x) &amp;= - x'A'PAx - 2u'B'PAx - u'(Q + B'PB) u\\
 &amp;= - x'A'PAx + x'A'PB(Q + B'PB)^{-1}B'PAx \\
 &amp;= -x'[A'PA - A'PB(Q + B'PB)^{-1}B'PA] x
\end{aligned}
\end{split}\]</div>
<p>Therefore, the solution to the optimization problem
<span class="math notranslate nohighlight">\(v(x) = -x' \tilde{P}x\)</span> follows the above result by denoting
<span class="math notranslate nohighlight">\(\tilde{P} := A'PA - A'PB(Q + B'PB)^{-1}B'PA\)</span></p>
</div>
</div>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="fn-mdt"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Although there is a specialized matrix data type defined in NumPy, it’s more standard to work with ordinary NumPy arrays.
See <a class="reference external" href="https://python-programming.quantecon.org/numpy.html#matrix-multiplication">this discussion</a>.</p>
</dd>
<dt class="label" id="cfn"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>Suppose that <span class="math notranslate nohighlight">\(\|S \| &lt; 1\)</span>. Take any nonzero vector <span class="math notranslate nohighlight">\(x\)</span>, and let <span class="math notranslate nohighlight">\(r := \|x\|\)</span>. We have <span class="math notranslate nohighlight">\(\| Sx \| = r \| S (x/r) \| \leq r \| S \| &lt; r = \| x\|\)</span>. Hence every point is pulled towards the origin.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                    </div>
                    
                </main> <!-- .page__content -->
                


                <footer class="qe-page__footer">

                    <p><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="https://licensebuttons.net/l/by-sa/4.0/80x15.png"></a></p>

                    <p>Creative Commons License &ndash; This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International.</p>

                </footer> <!-- .page__footer -->

            </div> <!-- .page -->

            

            
            <div class="qe-sidebar bd-sidebar inactive" id="site-navigation">

                <div class="qe-sidebar__header">


                    Contents

                </div>

                <nav class="qe-sidebar__nav" id="qe-sidebar-nav" aria-label="Main navigation">
                    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Techniques
 </span>
</p>
<ul class="current nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="geom_series.html">
   1. Geometric Series for Elementary Economics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sir_model.html">
   2. Modeling COVID 19
  </a>
 </li>
 <li class="toctree-l1 current active active">
  <a class="current reference internal" href="#">
   3. Linear Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomp.html">
   4. QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complex_and_trig.html">
   5. Complex Numbers and Trigonometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eig_circulant.html">
   6. Circulant Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="svd_intro.html">
   7. Singular Value Decomposition (SVD)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newton_method.html">
   8. Using Newton’s Method to Solve Economic Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elementary Statistics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="prob_matrix.html">
   9. Elementary Probability with Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="time_series_with_matrices.html">
   10. Univariate Time Series with Matrix Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lln_clt.html">
   11. LLN and CLT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="prob_meaning.html">
   12. Two Meanings of Probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_hyper.html">
   13. Multivariate Hypergeometric Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multivariate_normal.html">
   14. Multivariate Normal Distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="heavy_tails.html">
   15. Heavy-Tailed Distributions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hoist_failure.html">
   16. Fault Tree Uncertainties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="back_prop.html">
   17. Introduction to Artificial Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rand_resp.html">
   18. Randomized Response Surveys
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="util_rand_resp.html">
   19. Expected Utilities of Random Responses
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Linear Programming
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lp_intro.html">
   20. Linear Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="opt_transport.html">
   21. Optimal Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="von_neumann_model.html">
   22. Von Neumann Growth Model (and a Generalization)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction to Dynamics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="scalar_dynam.html">
   23. Dynamics in One Dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_processes.html">
   24. AR1 Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="finite_markov.html">
   25. Finite Markov Chains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inventory_dynamics.html">
   26. Inventory Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_models.html">
   27. Linear State Space Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="samuelson.html">
   28. Samuelson Multiplier-Accelerator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kesten_processes.html">
   29. Kesten Processes and Firm Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wealth_dynamics.html">
   30. Wealth Distribution Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="kalman.html">
   31. A First Look at the Kalman Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="short_path.html">
   32. Shortest Paths
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Search
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model.html">
   33. Job Search I: The McCall Search Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_model_with_separation.html">
   34. Job Search II: Search and Separation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_fitted_vfi.html">
   35. Job Search III: Fitted Value Function Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_correlated.html">
   36. Job Search IV: Correlated Wage Offers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="career.html">
   37. Job Search V: Modeling Career Choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jv.html">
   38. Job Search VI: On-the-Job Search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mccall_q.html">
   39. Job Search VII: A McCall Worker Q-Learns
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Consumption, Savings and Capital
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_1.html">
   40. Cass-Koopmans Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cass_koopmans_2.html">
   41. Cass-Koopmans Competitive Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_problem.html">
   42. Cake Eating I: Introduction to Optimal Saving
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cake_eating_numerical.html">
   43. Cake Eating II: Numerical Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth.html">
   44. Optimal Growth I: The Stochastic Optimal Growth Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="optgrowth_fast.html">
   45. Optimal Growth II: Accelerating the Code with Numba
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coleman_policy_iter.html">
   46. Optimal Growth III: Time Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="egm_policy_iter.html">
   47. Optimal Growth IV: The Endogenous Grid Method
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp.html">
   48. The Income Fluctuation Problem I: Basic Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ifp_advanced.html">
   49. The Income Fluctuation Problem II: Stochastic Returns on Assets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bayes Law
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="bayes_nonconj.html">
   50. Non-Conjugate Priors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_bayes.html">
   51. Posterior Distributions for  AR(1) Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ar1_turningpts.html">
   52. Forecasting  an AR(1) process
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Information
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="odu.html">
   53. Job Search VII: Search with Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_ratio_process.html">
   54. Likelihood Ratio Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="imp_sample.html">
   55. Computing Mean of a Likelihood Ratio Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wald_friedman.html">
   56. A Problem that Stumped Milton Friedman
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exchangeable.html">
   57. Exchangeability and Bayesian Updating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="likelihood_bayes.html">
   58. Likelihood Ratio Processes and Bayesian Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mix_model.html">
   59. Incorrect Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="navy_captain.html">
   60. Bayesian versus Frequentist Decision Rules
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LQ Control
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lqcontrol.html">
   61. LQ Control: Foundations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lagrangian_lqdp.html">
   62. Lagrangian for LQ Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_product_trick.html">
   63. Eliminating Cross Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income.html">
   64. The Permanent Income Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="perm_income_cons.html">
   65. Permanent Income II: LQ Techniques
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lq_inventories.html">
   66. Production Smoothing via Inventories
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Multiple Agent Models
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="schelling.html">
   67. Schelling’s Segregation Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lake_model.html">
   68. A Lake Model of Employment and Unemployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rational_expectations.html">
   69. Rational Expectations Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="re_with_feedback.html">
   70. Stability in Linear Rational Expectations Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="markov_perf.html">
   71. Markov Perfect Equilibrium
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="uncertainty_traps.html">
   72. Uncertainty Traps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aiyagari.html">
   73. The Aiyagari Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Asset Pricing and Finance
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="markov_asset.html">
   74. Asset Pricing: Finite State Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ge_arrow.html">
   75. Competitive Equilibria with Arrow Securities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harrison_kreps.html">
   76. Heterogeneous Beliefs and Bubbles
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data and Empirics
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_panel.html">
   77. Pandas for Panel Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ols.html">
   78. Linear Regression in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mle.html">
   79. Maximum Likelihood Estimation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Auctions
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="two_auctions.html">
   80. First-Price and Second-Price Auctions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="house_auction.html">
   81. Multiple Good Allocation Mechanisms
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Other
 </span>
</p>
<ul class="nav bd-sidenav nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="troubleshooting.html">
   82. Troubleshooting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   83. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="status.html">
   84. Execution Statistics
  </a>
 </li>
</ul>

                </nav>

                <div class="qe-sidebar__footer">

                </div>

            </div> <!-- .sidebar -->
            
        </div> <!-- .main -->

        <div class="qe-toolbar">

            <div class="qe-toolbar__inner">

                <ul class="qe-toolbar__main">
                    <li data-tippy-content="Table of Contents" class="btn__sidebar"><i data-feather="menu"></i></li>
                    <li data-tippy-content="Home"><a href="intro.html"><i data-feather="home"></i></a></li>
                    <li class="btn__qelogo"><a href="https://quantecon.org" title=""><span class="show-for-sr">QuantEcon</span></a></li>
                    <!-- <li class="btn__search">
                        <form action="search.html" method="get">
                            <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
                            <i data-feather="search"></i>
                        </form>
                    </li> -->
                </ul>

                <ul class="qe-toolbar__links">
                    <li data-tippy-content="Fullscreen" class="btn__fullscreen"><i data-feather="maximize"></i></li>
                    <li data-tippy-content="Increase font size" class="btn__plus"><i data-feather="plus-circle"></i></li>
                    <li data-tippy-content="Decrease font size" class="btn__minus"><i data-feather="minus-circle"></i></li>
                    <li data-tippy-content="Change contrast" class="btn__contrast"><i data-feather="sunset"></i></li>
                    <li data-tippy-content="Download Notebook"><a href="/_notebooks/linear_algebra.ipynb" download><i data-feather="download-cloud"></i></a></li>
                    <li class="settings-button" id="settingsButton"><div data-tippy-content="Launch Notebook"><i data-feather="play-circle"></i></div></li>
                        <li class="download-pdf" id="downloadButton"><i data-feather="file"></i></li>
                    <li data-tippy-content="View Source"><a target="_blank" href="https://github.com/QuantEcon/lecture-python.myst/tree/master/lectures/linear_algebra.md" download><i data-feather="github"></i></a></li>
                </ul>

            </div>

        </div> <!-- .toolbar -->
        <div id="downloadPDFModal" style="display: none;">
            <ul class="pdf-options" style="display: block;">
                <li class="download-pdf-book" onClick="window.print()">
                    <p>Lecture (PDF)</p>
                </li>
                <li class="download-pdf-file">
                    <a href="/_pdf/quantecon-python.pdf" download><p>Book (PDF)</p></a>
                </li>
            </ul>
        </div>
        <div id="settingsModal" style="display: none;">
            <p class="modal-title"> Notebook Launcher </p>
            <div class="modal-desc">
            <p>
                Choose public or private cloud service for "Launch" button.
            </p>
            </div>
            <p class="modal-subtitle">Select a server</p>
            <ul class="modal-servers">
            <li class="active launcher-public">
                <span class="label">Public</span>
                <select id="launcher-public-input">
                
                    <option value="https://mybinder.org/v2/gh/QuantEcon/lecture-python.notebooks/master?urlpath=tree/linear_algebra.ipynb">BinderHub</option>
                
                    <option value="https://colab.research.google.com/github/QuantEcon/lecture-python.notebooks/blob/master/linear_algebra.ipynb">Colab</option>
                
                </select>
                <i class="fas fa-check-circle"></i>
            </li>
            <li class="launcher-private">
                <span class="label">Private</span>
                <input type="text" id="launcher-private-input" data-repourl="https://github.com/QuantEcon/lecture-python.notebooks" data-urlpath="tree/lecture-python.notebooks/linear_algebra.ipynb" data-branch=master>
                <i class="fas fa-check-circle"></i>
            </li>
            </ul>
            <p class="launch"><a href="https://mybinder.org/v2/gh/QuantEcon/lecture-python.notebooks/master?urlpath=tree/linear_algebra.ipynb" id="advancedLaunchButton" target="_blank">Launch Notebook</a></p>
            <script>
                // QuantEcon Notebook Launcher
                const launcherTypeElements = document.querySelectorAll('#settingsModal .modal-servers li');
                // Highlight the server type if previous selection exists
                if (typeof localStorage.launcherType !== 'undefined') {
                  for (var i = 0; i < launcherTypeElements.length; i++) {
                    launcherTypeElements[i].classList.remove('active');
                    if ( launcherTypeElements[i].classList.contains(localStorage.launcherType) ) {
                      launcherTypeElements[i].classList.add('active');
                    }
                  }
                }
                // Highlight server type on click and set local storage value
                for (var i = 0; i < launcherTypeElements.length; i++) {
                  launcherTypeElements[i].addEventListener('click', function() {
                    for (var j = 0; j < launcherTypeElements.length; j++) {
                      launcherTypeElements[j].classList.remove('active');
                    }
                    this.classList.add('active');
                    if ( this.classList.contains('launcher-private') ) {
                      localStorage.launcherType = 'launcher-private';
                    } else if ( this.classList.contains('launcher-public') ) {
                      localStorage.launcherType = 'launcher-public';
                    }
                    setLaunchServer();
                  })
                }
                const launcherPublic = document.getElementById('launcher-public-input');
                const launcherPrivate = document.getElementById('launcher-private-input');
                const pageName = "linear_algebra";
                const repoURL = "https://github.com/QuantEcon/lecture-python.notebooks";
                const urlPath = "tree/lecture-python.notebooks/linear_algebra.ipynb";
                const branch = "master"
                const launchNotebookLink = document.getElementById('advancedLaunchButton');

                // Highlight public server option if previous selection exists
                if (typeof localStorage.launcherPublic !== 'undefined') {
                  launcherPublic.value = localStorage.launcherPublic;
                }
                // Update local storage upon public server selection
                launcherPublic.addEventListener('change', (event) => {
                  setLaunchServer();
                });
                // Populate private server input if previous entry exists
                if (typeof localStorage.launcherPrivate !== 'undefined') {
                  launcherPrivate.value = localStorage.launcherPrivate;
                }
                // Update local storage when a private server is entered
                launcherPrivate.addEventListener('input', (event) => {
                  setLaunchServer();
                });

                // Function to update the "Launch Notebook" link href
                function setLaunchServer() {
                  launchNotebookLink.removeAttribute("style")
                  if ( localStorage.launcherType == 'launcher-private' ) {
                    let repoPrefix = "/jupyter/hub/user-redirect/git-pull?repo=" + repoURL + "&branch=" + branch + "&urlpath=" + urlPath;
                    launcherPrivateValue = launcherPrivate.value
                    if (!launcherPrivateValue) {
                        launchNotebookLink.removeAttribute("href")
                        launchNotebookLink.style.background = "grey"
                        return
                    }
                    localStorage.launcherPrivate = launcherPrivateValue;
                    privateServer = localStorage.launcherPrivate.replace(/\/$/, "")
                    if (!privateServer.includes("http")) {
                        privateServer = "http://" + privateServer
                    }
                    launchNotebookLinkURL = privateServer + repoPrefix;
                  } else if ( localStorage.launcherType == 'launcher-public' ) {
                    launcherPublicValue = launcherPublic.options[launcherPublic.selectedIndex].value;
                    localStorage.launcherPublic = launcherPublicValue;
                    launchNotebookLinkURL = localStorage.launcherPublic;
                  }
                  if (launchNotebookLinkURL) launchNotebookLink.href = launchNotebookLinkURL;
                }
                // Check if user has previously selected a server
                if ( (typeof localStorage.launcherPrivate !== 'undefined') || (typeof localStorage.launcherPublic !== 'undefined') ) {
                  setLaunchServer();
                }
                </script>

        </div>

    </div> <!-- .wrapper-->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-54984338-10', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>